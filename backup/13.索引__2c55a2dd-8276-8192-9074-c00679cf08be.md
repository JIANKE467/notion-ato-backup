
作用：索引是加速查询的


没有索引查询需要全表扫描（慢）


有索引只需要查询索引即可（快）


| 优点    | 缺点                          |
| ----- | --------------------------- |
| 降低io  | 占空间                         |
| 降低cpu | 降低了更新表速度（改数据还得改索引，ps：不用手动改） |


# 索引结构


    | 结构              | 描述                                 |
    | --------------- | ---------------------------------- |
    | B+Tree 索引       | 最常见索引类型，所有引擎基本都支持                  |
    | Hash 索引         | 底层使用哈希表实现，只有精确匹配索引列查询才有效，不支持范围查询   |
    | R-tree（空间索引）    | 是MyISAM引擎的一个特殊索引，主要用于地理空间数据类型，较少使用 |
    | Full-text（全文索引） | 通过建立倒排索引，快速匹配，较少使用                 |


    引擎支持情况


    | 索引          | Innodb    | myisam | memory |
    | ----------- | --------- | ------ | ------ |
    | B+Tree索引    | 支持        | 支持     | 支持     |
    | Hash索引      | 不支持       | 不支持    | 支持     |
    | R-tree索引    | 不支持       | 支持     | 不支持    |
    | Full-text索引 | 5.6版本之后支持 | 支持     | 不支持    |


    ## B+树索引


    ### 没有指定索引默认是B+树索引


    度数：一个节点下的子节点个数


    ![1000000784.jpg](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/74d74bd1-5c0c-49dc-b951-a27e191fcc97/1000000784.jpg?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB4667GLCZP2F%2F20260131%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260131T044320Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEOT%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIDfAxJ%2BTs0f2Z4Pagb7uJbby8MYGJskhYCdvaPDapjF%2FAiEA3P7dTaaffT%2Fgx%2BGtkx7MHQUkRqkYM7soopuxFJSfbQ4qiAQIrf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAAGgw2Mzc0MjMxODM4MDUiDFpaZ3dqvmgu0i5nVCrcA2Dz1ud0vIQ8MNl1r3nslPKFCFgNbSx7M%2FTSYcRIxYHDdDvEWBfT2YPzKNEX%2BGvG0ebbb4n8%2BUDVCjb5GO380aEROj5NgyrzsisEDan7fACdPDd%2Fy7pa8a%2B%2BIkMgF0exrzqdKsuDduqq3z6J2xAJrLz%2FSiJ9b3HfCp6kdeEX8IORyOHLvYtlfi4%2Bsgs1tDbW%2FcTnERbdj6VUSSONBMrkY%2Fn0N6Ieusi0BZRCsQ1xtMIP2DbshSKDFv0cvuCgVYYERVQt4VHdYFRbyIbzeHp%2BqD0OnxLRmGRNO967Qz4BehfnM3Aw67H0dPRfSKzgNK1cLw0AvO%2F%2BJwO8Jha7B1K43De2g%2Fm7cMP%2FzKktihq6ULT6FXScxYveqkML%2F%2B7tAUpUwGQtkP3mSgD%2F%2Bk7HJp7KczlVRMzVLZxP3pgABwwcxeiG%2FC0hkdZ2j%2BIhenz%2FoTliMOWJUoDQe%2FxrZrC%2BqLVE%2BcakiFIHSCx3PFqBrhvxrkYFz7ibgRFh0g7GvbJ4F%2FUjkWXwhDjfl8aAIUScS2yYXR8IbPzqWePE0SPrjQSxURJ%2FM8vdaEDvNyjIcBuSr3%2BjwU1Bbia90zj8tDz6Pu%2FMrzK%2F9vf9ajKX4CZgw49MggN8p2SJtcrM2Lcc%2FVU6MK%2BD9ssGOqUBo0L6rdlaFX9riGZLcwzq1ZAWxNifI%2BPjCsVjobbeHrBD11KOfOnX66qDV5umWfCI6eBW3JAr6T5UE3ObfCZg510yR%2FrJuhzr2y2%2Fkf%2B2VLaDYhkZR0JqvFszL%2FJHCziw0nKo3G1SXUVYxBWAOULazFHOlVqdjWICVm%2FCYY0H8YRjXlU7AFXWxNp6ddTezOM8CsC%2FZ%2FITK5v%2FzE2yr0r%2F7ih8i0Bv&X-Amz-Signature=2749c32f73bbd83fbaf4ec720886057be06bba99fdc080cb9b3b7957d5cb99d7&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


    优点：


    相比于二叉树，B+树的层级更少，查询效率更高


    所有数据都存储在叶子节点，非叶子节点只存储索引，叶子节点形成有序链表


    支持范围查询和排序操作


    缺点：


    索引的更新和维护成本较高


    对于频繁插入、删除操作的表，B+树需要频繁调整结构


    不适合存储大量重复值的列作为索引


    ## Hash 索引


    优点：


    查询速度非常快，时间复杂度为O(1)


    只需要一次计算就能定位数据位置


    适合等值查询场景


    缺点：


    不支持范围查询


    不支持排序操作


    存在哈希冲突问题

    > InnoDB不支持哈希索引，但有自适应hash功能

# 索引分类


    | 分类   | 含义                         | 特点           | 关键字      |
    | ---- | -------------------------- | ------------ | -------- |
    | 主键索引 | 针对表中主键创建的索引                | 默认自动创建，只能有一个 | PRIMARY  |
    | 唯一索引 | 避免同一个表中某数据列中的值重复           | 可以有多个        | UNIQUE   |
    | 常规索引 | 快速定位特定数据                   | 可以有多个        |          |
    | 全文索引 | 全文索引查找的是文本中的关键词，而不是比较索引中的值 | 可以有多个        | FULLTEXT |


    ## InnoDB引擎中索引存储形式


    | 分类                    | 含义                            | 特点         |
    | --------------------- | ----------------------------- | ---------- |
    | 聚集索引（Clustered Index） | 将数据存储与索引放到了一块，索引结构的叶子节点保存了行数据 | 必须有，而且只有一个 |
    | 二级索引（Secondary Index） | 将数据与索引分开存储，索引结构的叶子节点关联的是对应的主键 | 可以存在多个     |


    ### 聚集索引


    **聚集索引选取规则：**

    1. 如果存在主键，主键索引就是聚集索引。
    2. 如果不存在主键，将使用第一个唯一（UNIQUE）索引作为聚集索引。
    3. 如果表没有主键，或没有合适的唯一索引，则InnoDB会自动生成一个rowid作为隐藏的聚集索引。

    聚集索引数据存储情况：（以有主键的情况为例）


    ![1000022833.jpg](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/bc5a4107-2f7f-46b3-957a-39b3289ce57d/1000022833.jpg?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB466UFLCYP6T%2F20260131%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260131T044322Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEOT%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICQKG%2BN%2B1scFf1HUsxWMgaJNQwA5FXXfROX1JQlhyf%2FkAiEApHeiREPZ8cE2d4TxjGTcrIEZZ%2BfM5F89ccu%2B9KbKDV4qiAQIrf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAAGgw2Mzc0MjMxODM4MDUiDLMoDpIYQIWkR16i4ircAziqHtp709Oc8bWfth0%2BTIYbbE3eAxlRq3%2BEp3JQJvQ5%2F4KPqXBEO5CFF%2BldBUzmHNEqW53oRCIIyXJ%2Fo8%2BFSgEbsRPC8kuUPULNncR49SYQbI2xklXpX37Vabv2xJReetPZokcl5ekkZePerWF9ehhUoRu4c%2Bs1NRy2gjJsHVB%2Bj7j%2F35H266KjBNohsA3lDTWCjQWUIbbq6qSr9yMvjNrJQznc6YPTV8Xen%2B96r%2BHC4gTqjlnOqjj94VmcsIy3h9HuKm7NlBXV%2BnzcjlP0RNKtx6caAJFxKm26EKIcJXrfgYtR0nK56NYthEQV9Xb%2B7z9sQkYUo%2F1tvzHQv5xP6ataUA3Knf53Z7aj7uonyNVzQu2epaDtOqGUos1vAoEj8jdkEQ1m9w2XFsV1yyqwb7R%2FsVhRDcHj3cSBIHBhaY4VlKfX36JcqyThTxutE%2FzRVCcC1Q9DCs6gquS716uGAWBkLlEEAif88SxjvP3L75djgvcvB1duJcBqHKMmgp2ygsNH%2FBsiR2Ym69LO%2BFjE08gxBldYHU3cjsexIQLM7PxVDhnyaivBltVaGrrVx1aPGLk9yI32enFImpdq3kNvpUuoljRR1q8YYRm8LWj%2FjEaUIuCQQXxz7o%2FWT2bZMK2D9ssGOqUBnQ5tjuRD9bSIheVt6zpTKXUTbZcIukXBe15URxZYcxMVBdjYNWL0q438QRwCmgpzGrTq%2FBDjscZ1P3QmOK2WQMBowo9hUfaZ341rbD5LXU7zwmzQpRlVvJQe7YYJBxf6GuHYH4Z8%2B9c2tGR2Ay4hZm4DmSxJr%2BM%2BgDRjXmKbN5e%2BkN6j01jG317Z62mNdI%2FzM%2BPfkHBibHeY9gwbQYrxQQSNduYX&X-Amz-Signature=ed9fb62ad78393a3a61b98319eeee84396b4feae64c0452808154a51ba68c00b&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


    如图：叶子节点5中的数据，就是表中主键为5这一行的数据


    **聚集索引叶子节点下挂的是该行的行数据**


    ## 二级索引


    **二级索引下挂的是该值的主键/第一个唯一字段/rowid**


# 语法


    **创建索引（建表后创建）**


    ```sql
    create [unique/fulltext] index 索引名 on 表名 (字段名，...)；
    ```


    可选项：（不指定则创建常规索引）


    unique：唯一索引


    fulltext：全文索引


    PS：


    一个索引关联一个字段叫单列索引


    一个索引关联多个字段叫联合索引


    **查看索引**


    ```sql
    show index from 表名；
    ```


    查看表中所有索引


    **删除索引**


    ```sql
    drop index 索引名 on 表名；
    ```


### 回表查询


**一个查询，先查询了其他索引找到主键，再查询主键索引找到其他数据**


这种查询过程叫回表查询

