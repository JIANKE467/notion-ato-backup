
系统调用是提供内核服务的接口


（要想执行特权指令需要使用系统调用，而非使用越权的指令）


### 系统调用与库函数的区别


一个程序可以用汇编直接使用系统调用


也可以使用库函数间接使用系统调用（库函数直接使用系统调用）


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/a0f71c13-988a-4aca-bbc8-7fe8a14f2dfa/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB466VRUDNUMN%2F20260126%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260126T043120Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEGwaCXVzLXdlc3QtMiJGMEQCIGomefxWLRpRCtsbkO6xURP5hKXYaBvt0uwXDyAkQjnpAiBD10lTBgw0Drow%2FHIOyk0l5aJz%2Fg08rv8MMMJBeJx15Sr%2FAwg1EAAaDDYzNzQyMzE4MzgwNSIMyk7VQHqmgHMi3ewpKtwD4qWkzwaq2HK7sKFfVgCEIwH%2BtIKqDmcTqIBDR9MxBr3%2F4o4bHVThHNFgiD31AEb17QfXOA%2BuY7J4JYD8c3xe0yx5Re4RFqSMmlOGSIDFIaXtk%2BDsVmtXm6GmOidhTThoxoy7I12EXmzIjO6dYpVyF0ngKPjBj3QIyWZfSLVNPobnBom1XFM4KFJ6UPUO5iyMjzVu9HuCz3dUPNcICN%2FOu9q09hFhFBmbR3jPYOcL5Rv%2BF2oxbXjWVAhAj3u2ZLgoxJ%2FQuit%2BUYF%2BQ1nSc%2Bre%2BWTUygCcyP8oI7yOJuc9qiq0GYKM46UUHdt3Lf3%2BGGSicUEmEjjr1MNPKFTiP9P67eonpC5gkoqSabWOXoNlTIT4t6ctRUVG1G4%2FQetIYb7k6v%2F%2Fyf36Qnh%2BCqeRxSyEzWNq4RTO3aIhB3S9jdBDnQbG8LJbl5n8v4HvB3JIwuw1NBOGlVTg6u9FdstaujbBN6sqpNixpUY1SkE27vUw05WnXH2z7cH3nODqx%2B1RrXEAsiEvSWZCFWztQPLYj9iPjGQIsHLzVw3PUD2Bm3PLzUhbSPeY7Aiweo4MnyLsZ%2BbHdTfsNsm8XawPgXDTcY4UoHaZAr4qy7%2BJ4vD5R0BDl8gF3hFYNjjdfkyEXMwwqMbbywY6pgG9B%2BJA%2FN65bY7fKz9VTnnIaKVIgt1%2FnovOgDgitXTqR3Zx1AHJPb5zfRZnIlQu2K%2FQO9xIOD%2FK7fmRe02lUMsrOzkjVBXiuTwXofu1elaZV8m28GvwSKj3Y9yoG9EZ69eMfoPYrbnIOtU0PxJzfKZeCUC7UZjmWeY4sMhnWxHaUL9LLF0J7Cedf%2FNNoPYDFBfuRhchEH%2FswSsUgaPY0rwek3gO3XSn&X-Amz-Signature=da8ab1bc168f5f6350fa44c8fafb292644837b09e4d1537097191c96437812db&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


### 为什么要系统调用


例：当多个进程同时使用一种设备资源（如摄像头）需要内核决定使用顺序，否则会出现争抢摄像头的情况


### 什么功能要系统调用


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/5c6a2eff-5468-4340-8c3e-2646dc3700e6/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB466VRUDNUMN%2F20260126%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260126T043120Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEGwaCXVzLXdlc3QtMiJGMEQCIGomefxWLRpRCtsbkO6xURP5hKXYaBvt0uwXDyAkQjnpAiBD10lTBgw0Drow%2FHIOyk0l5aJz%2Fg08rv8MMMJBeJx15Sr%2FAwg1EAAaDDYzNzQyMzE4MzgwNSIMyk7VQHqmgHMi3ewpKtwD4qWkzwaq2HK7sKFfVgCEIwH%2BtIKqDmcTqIBDR9MxBr3%2F4o4bHVThHNFgiD31AEb17QfXOA%2BuY7J4JYD8c3xe0yx5Re4RFqSMmlOGSIDFIaXtk%2BDsVmtXm6GmOidhTThoxoy7I12EXmzIjO6dYpVyF0ngKPjBj3QIyWZfSLVNPobnBom1XFM4KFJ6UPUO5iyMjzVu9HuCz3dUPNcICN%2FOu9q09hFhFBmbR3jPYOcL5Rv%2BF2oxbXjWVAhAj3u2ZLgoxJ%2FQuit%2BUYF%2BQ1nSc%2Bre%2BWTUygCcyP8oI7yOJuc9qiq0GYKM46UUHdt3Lf3%2BGGSicUEmEjjr1MNPKFTiP9P67eonpC5gkoqSabWOXoNlTIT4t6ctRUVG1G4%2FQetIYb7k6v%2F%2Fyf36Qnh%2BCqeRxSyEzWNq4RTO3aIhB3S9jdBDnQbG8LJbl5n8v4HvB3JIwuw1NBOGlVTg6u9FdstaujbBN6sqpNixpUY1SkE27vUw05WnXH2z7cH3nODqx%2B1RrXEAsiEvSWZCFWztQPLYj9iPjGQIsHLzVw3PUD2Bm3PLzUhbSPeY7Aiweo4MnyLsZ%2BbHdTfsNsm8XawPgXDTcY4UoHaZAr4qy7%2BJ4vD5R0BDl8gF3hFYNjjdfkyEXMwwqMbbywY6pgG9B%2BJA%2FN65bY7fKz9VTnnIaKVIgt1%2FnovOgDgitXTqR3Zx1AHJPb5zfRZnIlQu2K%2FQO9xIOD%2FK7fmRe02lUMsrOzkjVBXiuTwXofu1elaZV8m28GvwSKj3Y9yoG9EZ69eMfoPYrbnIOtU0PxJzfKZeCUC7UZjmWeY4sMhnWxHaUL9LLF0J7Cedf%2FNNoPYDFBfuRhchEH%2FswSsUgaPY0rwek3gO3XSn&X-Amz-Signature=480a996c64815dd315f60ce74c5ee383a0adb4ff34164223fb3eedbfd1065185&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


### 系统调用过程


传参指令……（用户态）→陷入指令（用户态）[引发中断]→中断处理程序（内核态）[选择相应的系统调用处理程序]→相应系统调用处理程序（由传入的参数决定）


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/81119b28-7bd7-4ca6-85ed-8a132fcab89d/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB466VRUDNUMN%2F20260126%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260126T043120Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEGwaCXVzLXdlc3QtMiJGMEQCIGomefxWLRpRCtsbkO6xURP5hKXYaBvt0uwXDyAkQjnpAiBD10lTBgw0Drow%2FHIOyk0l5aJz%2Fg08rv8MMMJBeJx15Sr%2FAwg1EAAaDDYzNzQyMzE4MzgwNSIMyk7VQHqmgHMi3ewpKtwD4qWkzwaq2HK7sKFfVgCEIwH%2BtIKqDmcTqIBDR9MxBr3%2F4o4bHVThHNFgiD31AEb17QfXOA%2BuY7J4JYD8c3xe0yx5Re4RFqSMmlOGSIDFIaXtk%2BDsVmtXm6GmOidhTThoxoy7I12EXmzIjO6dYpVyF0ngKPjBj3QIyWZfSLVNPobnBom1XFM4KFJ6UPUO5iyMjzVu9HuCz3dUPNcICN%2FOu9q09hFhFBmbR3jPYOcL5Rv%2BF2oxbXjWVAhAj3u2ZLgoxJ%2FQuit%2BUYF%2BQ1nSc%2Bre%2BWTUygCcyP8oI7yOJuc9qiq0GYKM46UUHdt3Lf3%2BGGSicUEmEjjr1MNPKFTiP9P67eonpC5gkoqSabWOXoNlTIT4t6ctRUVG1G4%2FQetIYb7k6v%2F%2Fyf36Qnh%2BCqeRxSyEzWNq4RTO3aIhB3S9jdBDnQbG8LJbl5n8v4HvB3JIwuw1NBOGlVTg6u9FdstaujbBN6sqpNixpUY1SkE27vUw05WnXH2z7cH3nODqx%2B1RrXEAsiEvSWZCFWztQPLYj9iPjGQIsHLzVw3PUD2Bm3PLzUhbSPeY7Aiweo4MnyLsZ%2BbHdTfsNsm8XawPgXDTcY4UoHaZAr4qy7%2BJ4vD5R0BDl8gF3hFYNjjdfkyEXMwwqMbbywY6pgG9B%2BJA%2FN65bY7fKz9VTnnIaKVIgt1%2FnovOgDgitXTqR3Zx1AHJPb5zfRZnIlQu2K%2FQO9xIOD%2FK7fmRe02lUMsrOzkjVBXiuTwXofu1elaZV8m28GvwSKj3Y9yoG9EZ69eMfoPYrbnIOtU0PxJzfKZeCUC7UZjmWeY4sMhnWxHaUL9LLF0J7Cedf%2FNNoPYDFBfuRhchEH%2FswSsUgaPY0rwek3gO3XSn&X-Amz-Signature=7c60291e6dd79d3dbc00c80fe69ca29539515dfcb00de90a8fc29b33f2ba51f9&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


ps：陷入指令=访管指令=trap指令


### 总结


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/d00274b7-ffbf-42d2-9255-534022d080b6/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB466VRUDNUMN%2F20260126%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260126T043120Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEGwaCXVzLXdlc3QtMiJGMEQCIGomefxWLRpRCtsbkO6xURP5hKXYaBvt0uwXDyAkQjnpAiBD10lTBgw0Drow%2FHIOyk0l5aJz%2Fg08rv8MMMJBeJx15Sr%2FAwg1EAAaDDYzNzQyMzE4MzgwNSIMyk7VQHqmgHMi3ewpKtwD4qWkzwaq2HK7sKFfVgCEIwH%2BtIKqDmcTqIBDR9MxBr3%2F4o4bHVThHNFgiD31AEb17QfXOA%2BuY7J4JYD8c3xe0yx5Re4RFqSMmlOGSIDFIaXtk%2BDsVmtXm6GmOidhTThoxoy7I12EXmzIjO6dYpVyF0ngKPjBj3QIyWZfSLVNPobnBom1XFM4KFJ6UPUO5iyMjzVu9HuCz3dUPNcICN%2FOu9q09hFhFBmbR3jPYOcL5Rv%2BF2oxbXjWVAhAj3u2ZLgoxJ%2FQuit%2BUYF%2BQ1nSc%2Bre%2BWTUygCcyP8oI7yOJuc9qiq0GYKM46UUHdt3Lf3%2BGGSicUEmEjjr1MNPKFTiP9P67eonpC5gkoqSabWOXoNlTIT4t6ctRUVG1G4%2FQetIYb7k6v%2F%2Fyf36Qnh%2BCqeRxSyEzWNq4RTO3aIhB3S9jdBDnQbG8LJbl5n8v4HvB3JIwuw1NBOGlVTg6u9FdstaujbBN6sqpNixpUY1SkE27vUw05WnXH2z7cH3nODqx%2B1RrXEAsiEvSWZCFWztQPLYj9iPjGQIsHLzVw3PUD2Bm3PLzUhbSPeY7Aiweo4MnyLsZ%2BbHdTfsNsm8XawPgXDTcY4UoHaZAr4qy7%2BJ4vD5R0BDl8gF3hFYNjjdfkyEXMwwqMbbywY6pgG9B%2BJA%2FN65bY7fKz9VTnnIaKVIgt1%2FnovOgDgitXTqR3Zx1AHJPb5zfRZnIlQu2K%2FQO9xIOD%2FK7fmRe02lUMsrOzkjVBXiuTwXofu1elaZV8m28GvwSKj3Y9yoG9EZ69eMfoPYrbnIOtU0PxJzfKZeCUC7UZjmWeY4sMhnWxHaUL9LLF0J7Cedf%2FNNoPYDFBfuRhchEH%2FswSsUgaPY0rwek3gO3XSn&X-Amz-Signature=4749f2a5eda190aa7e589dd33bc88cae555ab3a5e20d7f91f5570b51d5f04699&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)

