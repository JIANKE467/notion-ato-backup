
系统调用是提供内核服务的接口


（要想执行特权指令需要使用系统调用，而非使用越权的指令）


### 系统调用与库函数的区别


一个程序可以用汇编直接使用系统调用


也可以使用库函数间接使用系统调用（库函数直接使用系统调用）


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/a0f71c13-988a-4aca-bbc8-7fe8a14f2dfa/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB466Q55KP5WZ%2F20260129%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260129T045449Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjELX%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCiun6IZi9G9Udt%2B2iDx7U9i%2BpJueopAYyNqF6Nfj5FtgIgL0HGqC5BftCVCs8w62%2BBGTyPaNZneD%2BXMaFO1i9hzxAq%2FwMIfhAAGgw2Mzc0MjMxODM4MDUiDC5IPRFUPu%2FHATumBircA4suov2f3G9hsbjrKMfJEsUvVPhXx23dB7mClOPIJuukdJv%2BGrx1T3jLG%2BlWh1%2BY8d3mycn7dpYN4RsRTjzPlTfxX1XKz3%2BK5ZDewmwJDR0dEtxNNFpBW%2FSkztRnZWEzpub1XjKheN%2FBV4e0lBptPyKE1DEzhtON%2F1etJj1B6GpBzpXSPtFc0Vq6RF247DFXfwD427Prr9Ufi7xGeKjORth%2F6lfvexQd4dts5bYTJCjPD9XmaTyXLtxI5LIn0A4ntd%2FTfdgpmnJNB3V2qlqfZ%2FoSUegvrVfIRCRIFyaO8wz7mjIbE64QsGQd61MdNhEVAexz1RcYe9Jyeut%2FHfK7sq32DIys7zXtrmPF809HVFQoxFCfX0FJpTkzCADk2b%2FjHDSs8%2BjFEML%2FYGSL%2FzPhwk912VqlwnCuMZlCn48OqzmWDepikPU1IM82rDivQgC5OGzyDiFEuAIjRMQ6FZ%2B4TnDGI9ZNoTrNlmo3OrtksmLI5pW0SDCVIMI175gLPlHHGV5sCMX1IBHkhr9ezubyJ8d1OjO5ZbAIuWCQE4RfmwSGAwJATmcBCqZbLu58s%2BoQCSMIIAVA3DaZMTcLNQWcHGsaOKSupGS2wfog6reinlDKT6hUB3l4cLIjzO7RMOfM68sGOqUBp1%2F7BVtfcZMHPX6FJpH327%2BgMe6ovz6WCbqoyGSPzeQij3VjWXAryxpjYrL%2BSF6tFXB5BDvCn%2F56cboo667SgSEPLGuhCaNvE%2B4jFL8wnW%2Ft1ReInOdJNaXTiCUcxccuQ1Z83qWixDiiJWQTkraQnj7BFvLS2gin5BmivbonCNT6NmhFHoTSkjolrUO5QmDLdQTmtxmepC89XsvLe0zY8MH0x%2BEP&X-Amz-Signature=28daea93c45d3bd50e88e1aea838f15a4f58918ab8a6dbee6d7a7c6906a01232&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


### 为什么要系统调用


例：当多个进程同时使用一种设备资源（如摄像头）需要内核决定使用顺序，否则会出现争抢摄像头的情况


### 什么功能要系统调用


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/5c6a2eff-5468-4340-8c3e-2646dc3700e6/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB466Q55KP5WZ%2F20260129%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260129T045449Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjELX%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCiun6IZi9G9Udt%2B2iDx7U9i%2BpJueopAYyNqF6Nfj5FtgIgL0HGqC5BftCVCs8w62%2BBGTyPaNZneD%2BXMaFO1i9hzxAq%2FwMIfhAAGgw2Mzc0MjMxODM4MDUiDC5IPRFUPu%2FHATumBircA4suov2f3G9hsbjrKMfJEsUvVPhXx23dB7mClOPIJuukdJv%2BGrx1T3jLG%2BlWh1%2BY8d3mycn7dpYN4RsRTjzPlTfxX1XKz3%2BK5ZDewmwJDR0dEtxNNFpBW%2FSkztRnZWEzpub1XjKheN%2FBV4e0lBptPyKE1DEzhtON%2F1etJj1B6GpBzpXSPtFc0Vq6RF247DFXfwD427Prr9Ufi7xGeKjORth%2F6lfvexQd4dts5bYTJCjPD9XmaTyXLtxI5LIn0A4ntd%2FTfdgpmnJNB3V2qlqfZ%2FoSUegvrVfIRCRIFyaO8wz7mjIbE64QsGQd61MdNhEVAexz1RcYe9Jyeut%2FHfK7sq32DIys7zXtrmPF809HVFQoxFCfX0FJpTkzCADk2b%2FjHDSs8%2BjFEML%2FYGSL%2FzPhwk912VqlwnCuMZlCn48OqzmWDepikPU1IM82rDivQgC5OGzyDiFEuAIjRMQ6FZ%2B4TnDGI9ZNoTrNlmo3OrtksmLI5pW0SDCVIMI175gLPlHHGV5sCMX1IBHkhr9ezubyJ8d1OjO5ZbAIuWCQE4RfmwSGAwJATmcBCqZbLu58s%2BoQCSMIIAVA3DaZMTcLNQWcHGsaOKSupGS2wfog6reinlDKT6hUB3l4cLIjzO7RMOfM68sGOqUBp1%2F7BVtfcZMHPX6FJpH327%2BgMe6ovz6WCbqoyGSPzeQij3VjWXAryxpjYrL%2BSF6tFXB5BDvCn%2F56cboo667SgSEPLGuhCaNvE%2B4jFL8wnW%2Ft1ReInOdJNaXTiCUcxccuQ1Z83qWixDiiJWQTkraQnj7BFvLS2gin5BmivbonCNT6NmhFHoTSkjolrUO5QmDLdQTmtxmepC89XsvLe0zY8MH0x%2BEP&X-Amz-Signature=b72bad72c0beb5c07c026267829d926fd190c4a24d804d61906a01531da976b6&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


### 系统调用过程


传参指令……（用户态）→陷入指令（用户态）[引发中断]→中断处理程序（内核态）[选择相应的系统调用处理程序]→相应系统调用处理程序（由传入的参数决定）


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/81119b28-7bd7-4ca6-85ed-8a132fcab89d/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB466Q55KP5WZ%2F20260129%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260129T045449Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjELX%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCiun6IZi9G9Udt%2B2iDx7U9i%2BpJueopAYyNqF6Nfj5FtgIgL0HGqC5BftCVCs8w62%2BBGTyPaNZneD%2BXMaFO1i9hzxAq%2FwMIfhAAGgw2Mzc0MjMxODM4MDUiDC5IPRFUPu%2FHATumBircA4suov2f3G9hsbjrKMfJEsUvVPhXx23dB7mClOPIJuukdJv%2BGrx1T3jLG%2BlWh1%2BY8d3mycn7dpYN4RsRTjzPlTfxX1XKz3%2BK5ZDewmwJDR0dEtxNNFpBW%2FSkztRnZWEzpub1XjKheN%2FBV4e0lBptPyKE1DEzhtON%2F1etJj1B6GpBzpXSPtFc0Vq6RF247DFXfwD427Prr9Ufi7xGeKjORth%2F6lfvexQd4dts5bYTJCjPD9XmaTyXLtxI5LIn0A4ntd%2FTfdgpmnJNB3V2qlqfZ%2FoSUegvrVfIRCRIFyaO8wz7mjIbE64QsGQd61MdNhEVAexz1RcYe9Jyeut%2FHfK7sq32DIys7zXtrmPF809HVFQoxFCfX0FJpTkzCADk2b%2FjHDSs8%2BjFEML%2FYGSL%2FzPhwk912VqlwnCuMZlCn48OqzmWDepikPU1IM82rDivQgC5OGzyDiFEuAIjRMQ6FZ%2B4TnDGI9ZNoTrNlmo3OrtksmLI5pW0SDCVIMI175gLPlHHGV5sCMX1IBHkhr9ezubyJ8d1OjO5ZbAIuWCQE4RfmwSGAwJATmcBCqZbLu58s%2BoQCSMIIAVA3DaZMTcLNQWcHGsaOKSupGS2wfog6reinlDKT6hUB3l4cLIjzO7RMOfM68sGOqUBp1%2F7BVtfcZMHPX6FJpH327%2BgMe6ovz6WCbqoyGSPzeQij3VjWXAryxpjYrL%2BSF6tFXB5BDvCn%2F56cboo667SgSEPLGuhCaNvE%2B4jFL8wnW%2Ft1ReInOdJNaXTiCUcxccuQ1Z83qWixDiiJWQTkraQnj7BFvLS2gin5BmivbonCNT6NmhFHoTSkjolrUO5QmDLdQTmtxmepC89XsvLe0zY8MH0x%2BEP&X-Amz-Signature=ecb820e041cb7ced7602a0b861762ddaabea4830756824c321ff4f79243241d6&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


ps：陷入指令=访管指令=trap指令


### 总结


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/d00274b7-ffbf-42d2-9255-534022d080b6/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB466Q55KP5WZ%2F20260129%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260129T045449Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjELX%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCiun6IZi9G9Udt%2B2iDx7U9i%2BpJueopAYyNqF6Nfj5FtgIgL0HGqC5BftCVCs8w62%2BBGTyPaNZneD%2BXMaFO1i9hzxAq%2FwMIfhAAGgw2Mzc0MjMxODM4MDUiDC5IPRFUPu%2FHATumBircA4suov2f3G9hsbjrKMfJEsUvVPhXx23dB7mClOPIJuukdJv%2BGrx1T3jLG%2BlWh1%2BY8d3mycn7dpYN4RsRTjzPlTfxX1XKz3%2BK5ZDewmwJDR0dEtxNNFpBW%2FSkztRnZWEzpub1XjKheN%2FBV4e0lBptPyKE1DEzhtON%2F1etJj1B6GpBzpXSPtFc0Vq6RF247DFXfwD427Prr9Ufi7xGeKjORth%2F6lfvexQd4dts5bYTJCjPD9XmaTyXLtxI5LIn0A4ntd%2FTfdgpmnJNB3V2qlqfZ%2FoSUegvrVfIRCRIFyaO8wz7mjIbE64QsGQd61MdNhEVAexz1RcYe9Jyeut%2FHfK7sq32DIys7zXtrmPF809HVFQoxFCfX0FJpTkzCADk2b%2FjHDSs8%2BjFEML%2FYGSL%2FzPhwk912VqlwnCuMZlCn48OqzmWDepikPU1IM82rDivQgC5OGzyDiFEuAIjRMQ6FZ%2B4TnDGI9ZNoTrNlmo3OrtksmLI5pW0SDCVIMI175gLPlHHGV5sCMX1IBHkhr9ezubyJ8d1OjO5ZbAIuWCQE4RfmwSGAwJATmcBCqZbLu58s%2BoQCSMIIAVA3DaZMTcLNQWcHGsaOKSupGS2wfog6reinlDKT6hUB3l4cLIjzO7RMOfM68sGOqUBp1%2F7BVtfcZMHPX6FJpH327%2BgMe6ovz6WCbqoyGSPzeQij3VjWXAryxpjYrL%2BSF6tFXB5BDvCn%2F56cboo667SgSEPLGuhCaNvE%2B4jFL8wnW%2Ft1ReInOdJNaXTiCUcxccuQ1Z83qWixDiiJWQTkraQnj7BFvLS2gin5BmivbonCNT6NmhFHoTSkjolrUO5QmDLdQTmtxmepC89XsvLe0zY8MH0x%2BEP&X-Amz-Signature=7a9daec862c6d6bfcbe33a939fb02a01d5188fe14664a56b3ad8c696288eefa6&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)

