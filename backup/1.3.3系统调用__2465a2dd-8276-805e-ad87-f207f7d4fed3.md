
系统调用是提供内核服务的接口


（要想执行特权指令需要使用系统调用，而非使用越权的指令）


### 系统调用与库函数的区别


一个程序可以用汇编直接使用系统调用


也可以使用库函数间接使用系统调用（库函数直接使用系统调用）


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/a0f71c13-988a-4aca-bbc8-7fe8a14f2dfa/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB46664WQK3UH%2F20260123%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260123T041724Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECQaCXVzLXdlc3QtMiJHMEUCIQDiAmWSlsCKkF64RVAJdXL82AovMnIOLk3Wb8dS141q%2FgIgA4a%2B1O5CrerF3C0hrXfhObqafWpWcwftNNRCuAa8GmkqiAQI7f%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAAGgw2Mzc0MjMxODM4MDUiDDEQubKmO0bRZMK%2BdircA7JUd%2BWAD503kC3VjpipPQ0kEan6mZNKk%2FIiiSOPow7g27hkzLb6sy2co1JVyQPPut%2ByoHKEF9gFWkpZLqoSzDqBt0xRhyvjDbN%2Fkr7wEglXrR%2BWqRmF0Fs9mHtY8wIGe6ndnO1qVtmqCsHUf0NO7NIdiKVQnPtv7zgTFaMIA7UMU7p55YiM9NsZ%2FdJTGwBQHMjc0e%2BdI5fsKWC94k%2FHZl5J0xhwEppjEakgE3Sg2Ts%2FarV0bjyocC54h94sySBqqyksv923Hv2hLx7khpLQJS7LsBgO%2FWBn4aqD%2BrCSgX7YnVTC%2B66clSBhlt0Y3aoDgYLtxXRQp70H%2BO0avKXYoD8SjlRFI5AZGpU3edG94iKFUnp21f7Eh3BO5vFGHbHAfjCgt2AYiku5h7opovN9Bkcd%2BaUJZvtI3DSAEePBeNLML1TlXKLeLweiqhrcFr3VAfGeWbNSQZ1E%2Bo4nNJtwB5q1lO3tmRc95T1TXLHPZVd%2FcbnZ%2FJb6T4Q9F1ly2dLaFFTSd2xW%2BGeF25tJ8K58yjnAfF6x8zW%2FPugqJEp%2FvJpGKoX7cJtwMVa%2Fpb5kkn1oY8wSD%2Bhj196C2GFcq2e%2FNog63Z6Pjm9O5RgIUFXOjrmbhqGTTBAwu2oB6NwqMPbby8sGOqUBPxy95PSrGgJ4B%2BQpPQELHJaXJitxCdZYIBXIcHlZHsrzAsA7vkhJcihGwnCZmxuCDFrWOdxV8lfslji4dWPbVWIF4tsjPXX%2F%2BNcQALgHK%2FI%2Fw6mfgdqCJoJvETUdmoT8tP4rJIThfvBXVmEvEgbDyZZTqpoHlrBd8H%2FSlVcEe713PTKgQN5Zn4CF3nn05Ba82hYc5cFN1NlNu50zG3AYDkubXm%2BC&X-Amz-Signature=32aed17d1459666e4f0a9245baa7d804b7457d67559d08cdc8eabff52be93cc7&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


### 为什么要系统调用


例：当多个进程同时使用一种设备资源（如摄像头）需要内核决定使用顺序，否则会出现争抢摄像头的情况


### 什么功能要系统调用


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/5c6a2eff-5468-4340-8c3e-2646dc3700e6/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB46664WQK3UH%2F20260123%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260123T041724Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECQaCXVzLXdlc3QtMiJHMEUCIQDiAmWSlsCKkF64RVAJdXL82AovMnIOLk3Wb8dS141q%2FgIgA4a%2B1O5CrerF3C0hrXfhObqafWpWcwftNNRCuAa8GmkqiAQI7f%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAAGgw2Mzc0MjMxODM4MDUiDDEQubKmO0bRZMK%2BdircA7JUd%2BWAD503kC3VjpipPQ0kEan6mZNKk%2FIiiSOPow7g27hkzLb6sy2co1JVyQPPut%2ByoHKEF9gFWkpZLqoSzDqBt0xRhyvjDbN%2Fkr7wEglXrR%2BWqRmF0Fs9mHtY8wIGe6ndnO1qVtmqCsHUf0NO7NIdiKVQnPtv7zgTFaMIA7UMU7p55YiM9NsZ%2FdJTGwBQHMjc0e%2BdI5fsKWC94k%2FHZl5J0xhwEppjEakgE3Sg2Ts%2FarV0bjyocC54h94sySBqqyksv923Hv2hLx7khpLQJS7LsBgO%2FWBn4aqD%2BrCSgX7YnVTC%2B66clSBhlt0Y3aoDgYLtxXRQp70H%2BO0avKXYoD8SjlRFI5AZGpU3edG94iKFUnp21f7Eh3BO5vFGHbHAfjCgt2AYiku5h7opovN9Bkcd%2BaUJZvtI3DSAEePBeNLML1TlXKLeLweiqhrcFr3VAfGeWbNSQZ1E%2Bo4nNJtwB5q1lO3tmRc95T1TXLHPZVd%2FcbnZ%2FJb6T4Q9F1ly2dLaFFTSd2xW%2BGeF25tJ8K58yjnAfF6x8zW%2FPugqJEp%2FvJpGKoX7cJtwMVa%2Fpb5kkn1oY8wSD%2Bhj196C2GFcq2e%2FNog63Z6Pjm9O5RgIUFXOjrmbhqGTTBAwu2oB6NwqMPbby8sGOqUBPxy95PSrGgJ4B%2BQpPQELHJaXJitxCdZYIBXIcHlZHsrzAsA7vkhJcihGwnCZmxuCDFrWOdxV8lfslji4dWPbVWIF4tsjPXX%2F%2BNcQALgHK%2FI%2Fw6mfgdqCJoJvETUdmoT8tP4rJIThfvBXVmEvEgbDyZZTqpoHlrBd8H%2FSlVcEe713PTKgQN5Zn4CF3nn05Ba82hYc5cFN1NlNu50zG3AYDkubXm%2BC&X-Amz-Signature=63fabf46f24f34aa48c3f970a6ce7113fd1ec6cdc31357b40dcc1e507bc7eba6&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


### 系统调用过程


传参指令……（用户态）→陷入指令（用户态）[引发中断]→中断处理程序（内核态）[选择相应的系统调用处理程序]→相应系统调用处理程序（由传入的参数决定）


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/81119b28-7bd7-4ca6-85ed-8a132fcab89d/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB46664WQK3UH%2F20260123%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260123T041724Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECQaCXVzLXdlc3QtMiJHMEUCIQDiAmWSlsCKkF64RVAJdXL82AovMnIOLk3Wb8dS141q%2FgIgA4a%2B1O5CrerF3C0hrXfhObqafWpWcwftNNRCuAa8GmkqiAQI7f%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAAGgw2Mzc0MjMxODM4MDUiDDEQubKmO0bRZMK%2BdircA7JUd%2BWAD503kC3VjpipPQ0kEan6mZNKk%2FIiiSOPow7g27hkzLb6sy2co1JVyQPPut%2ByoHKEF9gFWkpZLqoSzDqBt0xRhyvjDbN%2Fkr7wEglXrR%2BWqRmF0Fs9mHtY8wIGe6ndnO1qVtmqCsHUf0NO7NIdiKVQnPtv7zgTFaMIA7UMU7p55YiM9NsZ%2FdJTGwBQHMjc0e%2BdI5fsKWC94k%2FHZl5J0xhwEppjEakgE3Sg2Ts%2FarV0bjyocC54h94sySBqqyksv923Hv2hLx7khpLQJS7LsBgO%2FWBn4aqD%2BrCSgX7YnVTC%2B66clSBhlt0Y3aoDgYLtxXRQp70H%2BO0avKXYoD8SjlRFI5AZGpU3edG94iKFUnp21f7Eh3BO5vFGHbHAfjCgt2AYiku5h7opovN9Bkcd%2BaUJZvtI3DSAEePBeNLML1TlXKLeLweiqhrcFr3VAfGeWbNSQZ1E%2Bo4nNJtwB5q1lO3tmRc95T1TXLHPZVd%2FcbnZ%2FJb6T4Q9F1ly2dLaFFTSd2xW%2BGeF25tJ8K58yjnAfF6x8zW%2FPugqJEp%2FvJpGKoX7cJtwMVa%2Fpb5kkn1oY8wSD%2Bhj196C2GFcq2e%2FNog63Z6Pjm9O5RgIUFXOjrmbhqGTTBAwu2oB6NwqMPbby8sGOqUBPxy95PSrGgJ4B%2BQpPQELHJaXJitxCdZYIBXIcHlZHsrzAsA7vkhJcihGwnCZmxuCDFrWOdxV8lfslji4dWPbVWIF4tsjPXX%2F%2BNcQALgHK%2FI%2Fw6mfgdqCJoJvETUdmoT8tP4rJIThfvBXVmEvEgbDyZZTqpoHlrBd8H%2FSlVcEe713PTKgQN5Zn4CF3nn05Ba82hYc5cFN1NlNu50zG3AYDkubXm%2BC&X-Amz-Signature=2fcab56af03fb490c18cf45b76ba3f225f6fd65979c453b6b1049931b396bbc0&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


ps：陷入指令=访管指令=trap指令


### 总结


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/d00274b7-ffbf-42d2-9255-534022d080b6/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB46664WQK3UH%2F20260123%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260123T041724Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjECQaCXVzLXdlc3QtMiJHMEUCIQDiAmWSlsCKkF64RVAJdXL82AovMnIOLk3Wb8dS141q%2FgIgA4a%2B1O5CrerF3C0hrXfhObqafWpWcwftNNRCuAa8GmkqiAQI7f%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAAGgw2Mzc0MjMxODM4MDUiDDEQubKmO0bRZMK%2BdircA7JUd%2BWAD503kC3VjpipPQ0kEan6mZNKk%2FIiiSOPow7g27hkzLb6sy2co1JVyQPPut%2ByoHKEF9gFWkpZLqoSzDqBt0xRhyvjDbN%2Fkr7wEglXrR%2BWqRmF0Fs9mHtY8wIGe6ndnO1qVtmqCsHUf0NO7NIdiKVQnPtv7zgTFaMIA7UMU7p55YiM9NsZ%2FdJTGwBQHMjc0e%2BdI5fsKWC94k%2FHZl5J0xhwEppjEakgE3Sg2Ts%2FarV0bjyocC54h94sySBqqyksv923Hv2hLx7khpLQJS7LsBgO%2FWBn4aqD%2BrCSgX7YnVTC%2B66clSBhlt0Y3aoDgYLtxXRQp70H%2BO0avKXYoD8SjlRFI5AZGpU3edG94iKFUnp21f7Eh3BO5vFGHbHAfjCgt2AYiku5h7opovN9Bkcd%2BaUJZvtI3DSAEePBeNLML1TlXKLeLweiqhrcFr3VAfGeWbNSQZ1E%2Bo4nNJtwB5q1lO3tmRc95T1TXLHPZVd%2FcbnZ%2FJb6T4Q9F1ly2dLaFFTSd2xW%2BGeF25tJ8K58yjnAfF6x8zW%2FPugqJEp%2FvJpGKoX7cJtwMVa%2Fpb5kkn1oY8wSD%2Bhj196C2GFcq2e%2FNog63Z6Pjm9O5RgIUFXOjrmbhqGTTBAwu2oB6NwqMPbby8sGOqUBPxy95PSrGgJ4B%2BQpPQELHJaXJitxCdZYIBXIcHlZHsrzAsA7vkhJcihGwnCZmxuCDFrWOdxV8lfslji4dWPbVWIF4tsjPXX%2F%2BNcQALgHK%2FI%2Fw6mfgdqCJoJvETUdmoT8tP4rJIThfvBXVmEvEgbDyZZTqpoHlrBd8H%2FSlVcEe713PTKgQN5Zn4CF3nn05Ba82hYc5cFN1NlNu50zG3AYDkubXm%2BC&X-Amz-Signature=f55c7414811583a3d422ba2f6eed8de45b0cf2dbad6ebf7ce761fac1822395df&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)

