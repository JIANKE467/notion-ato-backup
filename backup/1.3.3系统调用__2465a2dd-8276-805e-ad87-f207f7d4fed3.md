
系统调用是提供内核服务的接口


（要想执行特权指令需要使用系统调用，而非使用越权的指令）


### 系统调用与库函数的区别


一个程序可以用汇编直接使用系统调用


也可以使用库函数间接使用系统调用（库函数直接使用系统调用）


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/a0f71c13-988a-4aca-bbc8-7fe8a14f2dfa/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB466QBBEMJKY%2F20260101%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260101T042000Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEBEaCXVzLXdlc3QtMiJHMEUCIEVP5eqAHDgktPV5cocwiGv2lYylSgUvXaiv2byCKmNmAiEAhtLlEScoYJjJFsAS7VwtSuuj%2BSHip6YQZ5rO%2FJL%2B2yMqiAQI2v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAAGgw2Mzc0MjMxODM4MDUiDKWexA2m8CAFZx98ryrcA%2FhVEmTeMtPFYLeAa2BJIp7RDXPWw3cEbpDpS2m4j%2F%2B%2FHnJKwZQ9PGupmuZ%2BhdBGmXyVog42jceu7WKigQzbJpvDm7XSui1FcWKJn8%2FxACXO20MlwVWSgjJ1zJJZznIJpv7v3KvIaVEicn%2F4R6y%2B1xiC08wf3OCoR30UEFsS3NxDTI8VgvmAwKYz1E0%2Bzwno3SQX63s8Bm4yd%2BnuMPFm%2FDutLT9gSb6ztbqUs1EBIzjqTpKE41vlLTmb1GpNu8iVfDJazW90OAOXb%2FAkaNlEp%2FPv2koI3N1jjwsKV0QXlKa8buHPxXLRN5F2JBWB5djIDQNJoKgKEFgNy1HbzPwkMIWWa9WFaCLaeCrEyJd10kQWEecFGop3ef92wV9cp37LzaxtuW0RMocjwXgI7UPRPSm5F4%2BO76iNHfiLCtvJIS1t6h6XBzSeYR78bvDY2NuW%2Bnh37l0ZknDgr1N5py2Hr766ZV8cwFfoIehOOwBdkWJxuTPS2eybQViD5ROAORndXSVzx5fJh22SoYS5akjXcxLCsrt3DiDkg3jryyx%2BrwAsVz10u0P4vyG6iU4PnSYWh%2Bg8BUHd%2FEDOh9W57rr9COX5wKZ3pAd%2FYIbUrk1UbUzJPV8WhZ1xffrLOSXRMPOK18oGOqUBmi1SGHHYVelFWJX28EvMVPTTVxhMt2%2BMK%2FZYJCQccZyVXHSf%2FSFwm2XtMmOGu4ErUGpoDx6d5hlQ5sGNXQ4dYmnIo%2FOwwIvPMq0lsM5gsS2D5uOQLumBseEd4y2Svddt972WkI6arSadYtnsh2OzTtc105crE1Dje2jpffs0D7qVi4934j%2BzG%2FloSy7pTRw4d3YIu3s0%2F%2BY645m3R1So9%2F3o%2BB51&X-Amz-Signature=ce7f518377aad0a1ab81e07730af6e734fa1762bfefce09d3b1e18959d992bf7&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


### 为什么要系统调用


例：当多个进程同时使用一种设备资源（如摄像头）需要内核决定使用顺序，否则会出现争抢摄像头的情况


### 什么功能要系统调用


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/5c6a2eff-5468-4340-8c3e-2646dc3700e6/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB466QBBEMJKY%2F20260101%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260101T042000Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEBEaCXVzLXdlc3QtMiJHMEUCIEVP5eqAHDgktPV5cocwiGv2lYylSgUvXaiv2byCKmNmAiEAhtLlEScoYJjJFsAS7VwtSuuj%2BSHip6YQZ5rO%2FJL%2B2yMqiAQI2v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAAGgw2Mzc0MjMxODM4MDUiDKWexA2m8CAFZx98ryrcA%2FhVEmTeMtPFYLeAa2BJIp7RDXPWw3cEbpDpS2m4j%2F%2B%2FHnJKwZQ9PGupmuZ%2BhdBGmXyVog42jceu7WKigQzbJpvDm7XSui1FcWKJn8%2FxACXO20MlwVWSgjJ1zJJZznIJpv7v3KvIaVEicn%2F4R6y%2B1xiC08wf3OCoR30UEFsS3NxDTI8VgvmAwKYz1E0%2Bzwno3SQX63s8Bm4yd%2BnuMPFm%2FDutLT9gSb6ztbqUs1EBIzjqTpKE41vlLTmb1GpNu8iVfDJazW90OAOXb%2FAkaNlEp%2FPv2koI3N1jjwsKV0QXlKa8buHPxXLRN5F2JBWB5djIDQNJoKgKEFgNy1HbzPwkMIWWa9WFaCLaeCrEyJd10kQWEecFGop3ef92wV9cp37LzaxtuW0RMocjwXgI7UPRPSm5F4%2BO76iNHfiLCtvJIS1t6h6XBzSeYR78bvDY2NuW%2Bnh37l0ZknDgr1N5py2Hr766ZV8cwFfoIehOOwBdkWJxuTPS2eybQViD5ROAORndXSVzx5fJh22SoYS5akjXcxLCsrt3DiDkg3jryyx%2BrwAsVz10u0P4vyG6iU4PnSYWh%2Bg8BUHd%2FEDOh9W57rr9COX5wKZ3pAd%2FYIbUrk1UbUzJPV8WhZ1xffrLOSXRMPOK18oGOqUBmi1SGHHYVelFWJX28EvMVPTTVxhMt2%2BMK%2FZYJCQccZyVXHSf%2FSFwm2XtMmOGu4ErUGpoDx6d5hlQ5sGNXQ4dYmnIo%2FOwwIvPMq0lsM5gsS2D5uOQLumBseEd4y2Svddt972WkI6arSadYtnsh2OzTtc105crE1Dje2jpffs0D7qVi4934j%2BzG%2FloSy7pTRw4d3YIu3s0%2F%2BY645m3R1So9%2F3o%2BB51&X-Amz-Signature=a3d5241301a799fa3b234b9a549922c17e98b76e6e93ced007d7d0e2e76f23d3&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


### 系统调用过程


传参指令……（用户态）→陷入指令（用户态）[引发中断]→中断处理程序（内核态）[选择相应的系统调用处理程序]→相应系统调用处理程序（由传入的参数决定）


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/81119b28-7bd7-4ca6-85ed-8a132fcab89d/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB466QBBEMJKY%2F20260101%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260101T042000Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEBEaCXVzLXdlc3QtMiJHMEUCIEVP5eqAHDgktPV5cocwiGv2lYylSgUvXaiv2byCKmNmAiEAhtLlEScoYJjJFsAS7VwtSuuj%2BSHip6YQZ5rO%2FJL%2B2yMqiAQI2v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAAGgw2Mzc0MjMxODM4MDUiDKWexA2m8CAFZx98ryrcA%2FhVEmTeMtPFYLeAa2BJIp7RDXPWw3cEbpDpS2m4j%2F%2B%2FHnJKwZQ9PGupmuZ%2BhdBGmXyVog42jceu7WKigQzbJpvDm7XSui1FcWKJn8%2FxACXO20MlwVWSgjJ1zJJZznIJpv7v3KvIaVEicn%2F4R6y%2B1xiC08wf3OCoR30UEFsS3NxDTI8VgvmAwKYz1E0%2Bzwno3SQX63s8Bm4yd%2BnuMPFm%2FDutLT9gSb6ztbqUs1EBIzjqTpKE41vlLTmb1GpNu8iVfDJazW90OAOXb%2FAkaNlEp%2FPv2koI3N1jjwsKV0QXlKa8buHPxXLRN5F2JBWB5djIDQNJoKgKEFgNy1HbzPwkMIWWa9WFaCLaeCrEyJd10kQWEecFGop3ef92wV9cp37LzaxtuW0RMocjwXgI7UPRPSm5F4%2BO76iNHfiLCtvJIS1t6h6XBzSeYR78bvDY2NuW%2Bnh37l0ZknDgr1N5py2Hr766ZV8cwFfoIehOOwBdkWJxuTPS2eybQViD5ROAORndXSVzx5fJh22SoYS5akjXcxLCsrt3DiDkg3jryyx%2BrwAsVz10u0P4vyG6iU4PnSYWh%2Bg8BUHd%2FEDOh9W57rr9COX5wKZ3pAd%2FYIbUrk1UbUzJPV8WhZ1xffrLOSXRMPOK18oGOqUBmi1SGHHYVelFWJX28EvMVPTTVxhMt2%2BMK%2FZYJCQccZyVXHSf%2FSFwm2XtMmOGu4ErUGpoDx6d5hlQ5sGNXQ4dYmnIo%2FOwwIvPMq0lsM5gsS2D5uOQLumBseEd4y2Svddt972WkI6arSadYtnsh2OzTtc105crE1Dje2jpffs0D7qVi4934j%2BzG%2FloSy7pTRw4d3YIu3s0%2F%2BY645m3R1So9%2F3o%2BB51&X-Amz-Signature=1a66963b3ac328a62abe12ce7594d02d169c31ca4c503648bc9933ea60a6a5b8&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


ps：陷入指令=访管指令=trap指令


### 总结


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/d00274b7-ffbf-42d2-9255-534022d080b6/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB466QBBEMJKY%2F20260101%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260101T042000Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEBEaCXVzLXdlc3QtMiJHMEUCIEVP5eqAHDgktPV5cocwiGv2lYylSgUvXaiv2byCKmNmAiEAhtLlEScoYJjJFsAS7VwtSuuj%2BSHip6YQZ5rO%2FJL%2B2yMqiAQI2v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAAGgw2Mzc0MjMxODM4MDUiDKWexA2m8CAFZx98ryrcA%2FhVEmTeMtPFYLeAa2BJIp7RDXPWw3cEbpDpS2m4j%2F%2B%2FHnJKwZQ9PGupmuZ%2BhdBGmXyVog42jceu7WKigQzbJpvDm7XSui1FcWKJn8%2FxACXO20MlwVWSgjJ1zJJZznIJpv7v3KvIaVEicn%2F4R6y%2B1xiC08wf3OCoR30UEFsS3NxDTI8VgvmAwKYz1E0%2Bzwno3SQX63s8Bm4yd%2BnuMPFm%2FDutLT9gSb6ztbqUs1EBIzjqTpKE41vlLTmb1GpNu8iVfDJazW90OAOXb%2FAkaNlEp%2FPv2koI3N1jjwsKV0QXlKa8buHPxXLRN5F2JBWB5djIDQNJoKgKEFgNy1HbzPwkMIWWa9WFaCLaeCrEyJd10kQWEecFGop3ef92wV9cp37LzaxtuW0RMocjwXgI7UPRPSm5F4%2BO76iNHfiLCtvJIS1t6h6XBzSeYR78bvDY2NuW%2Bnh37l0ZknDgr1N5py2Hr766ZV8cwFfoIehOOwBdkWJxuTPS2eybQViD5ROAORndXSVzx5fJh22SoYS5akjXcxLCsrt3DiDkg3jryyx%2BrwAsVz10u0P4vyG6iU4PnSYWh%2Bg8BUHd%2FEDOh9W57rr9COX5wKZ3pAd%2FYIbUrk1UbUzJPV8WhZ1xffrLOSXRMPOK18oGOqUBmi1SGHHYVelFWJX28EvMVPTTVxhMt2%2BMK%2FZYJCQccZyVXHSf%2FSFwm2XtMmOGu4ErUGpoDx6d5hlQ5sGNXQ4dYmnIo%2FOwwIvPMq0lsM5gsS2D5uOQLumBseEd4y2Svddt972WkI6arSadYtnsh2OzTtc105crE1Dje2jpffs0D7qVi4934j%2BzG%2FloSy7pTRw4d3YIu3s0%2F%2BY645m3R1So9%2F3o%2BB51&X-Amz-Signature=633c4b345c52ab73161d7e95ef81608177404a37df1b299f3071cc4df1b540d8&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)

