
系统调用是提供内核服务的接口


（要想执行特权指令需要使用系统调用，而非使用越权的指令）


### 系统调用与库函数的区别


一个程序可以用汇编直接使用系统调用


也可以使用库函数间接使用系统调用（库函数直接使用系统调用）


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/a0f71c13-988a-4aca-bbc8-7fe8a14f2dfa/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB4667H3ENLVX%2F20260103%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260103T040357Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEEQaCXVzLXdlc3QtMiJGMEQCIHb4wbXuu9p38VnUaD7LmGPP4zqXqci8mwG%2BGosVmj85AiAqlG8Z7S%2F8kXm1%2FNS0r%2BqJHHo14hJVvVSyLLipoi1bgir%2FAwgNEAAaDDYzNzQyMzE4MzgwNSIMlmx2fERbc8XsSz%2FjKtwDHgH4KnREZZF8TIf7%2BdDHR41sFM7rQro0BPJP%2Fihf5iipQkn2Nc3F%2Bb3EXNv%2B%2BDO7iNeANWvmnrfU7GzBZuBhmG%2BMu6XCDw0016UqHKJ9vTqBKE2sc7oZv%2B1qh%2BpXPafUMxsG4MEBQmS%2FHcTsmvCYis4N%2BS6RQQETFyOHkQQmd4vVMhM6F4gKGMy3gHE0Q3Xzrf9c%2BoXF%2FqPTR1bW3v7u29FMwFsKSb0Ge%2FYw%2BGNikwLzzgsQTwGr5tz4h7k3Go5EwC%2FV7la5ggmsTCsHbOaeqq%2B8mbXA24%2FyViD8hoCeKXIc7b4um3zqxhl2PtWc6hoQrPN%2BQn0d8GjA9vfsvwEd5BJEGGySKhR2TaQGZeFcz1vneTOomk7WHewOqp%2BaI4FmBUeH4OKyqwgRnG11ok%2F9l8BEr0443aZ%2BZe%2FJo1oXHly8LtLozkaM7EgEfi7nSZ%2FUFDlGVFw7zwnVMSHgzKOVlD8mHTyBPooJgsows6f3r67nW%2BMXvXeWr%2FTkJLRZtZCSBAlDQlOiYfMdQxMrykX1rUbZNz0nZmdJ%2BKCeuMEYG2U36oqP3SFOPcAZ0kMa1a5C2ue3PMG5erJdDmg8C4LO%2BzrVvyVlXtOtJTh7oM90PM%2FXGes76jvckL7hdgYww6jiygY6pgF%2FKkyP5i%2BTNVF0iy8ZWJsTd%2B3VsbwUoKILR6BbjoqIZ99HKK7sDxvXXArwcuoaeT3ybz44g8VfzBW7RWkGBNR8jVo4Jg3CkeavsSVw2KZBZY3U71UqLjvw8%2BtpXj%2Fia12Km8X5o%2BZdfsQ6XKxWYs5MMAEjNflhahVg%2FoAJO5AMajMlelG7uLa04xNJtm1FryqLD1Yd4RwDIVQLEoQk0JasMGf4ZsjB&X-Amz-Signature=1b588dca3a6735035b8c5e7570de6e1f8efff814adb77a0a6fdfcfb0ca2b6d3f&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


### 为什么要系统调用


例：当多个进程同时使用一种设备资源（如摄像头）需要内核决定使用顺序，否则会出现争抢摄像头的情况


### 什么功能要系统调用


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/5c6a2eff-5468-4340-8c3e-2646dc3700e6/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB4667H3ENLVX%2F20260103%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260103T040357Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEEQaCXVzLXdlc3QtMiJGMEQCIHb4wbXuu9p38VnUaD7LmGPP4zqXqci8mwG%2BGosVmj85AiAqlG8Z7S%2F8kXm1%2FNS0r%2BqJHHo14hJVvVSyLLipoi1bgir%2FAwgNEAAaDDYzNzQyMzE4MzgwNSIMlmx2fERbc8XsSz%2FjKtwDHgH4KnREZZF8TIf7%2BdDHR41sFM7rQro0BPJP%2Fihf5iipQkn2Nc3F%2Bb3EXNv%2B%2BDO7iNeANWvmnrfU7GzBZuBhmG%2BMu6XCDw0016UqHKJ9vTqBKE2sc7oZv%2B1qh%2BpXPafUMxsG4MEBQmS%2FHcTsmvCYis4N%2BS6RQQETFyOHkQQmd4vVMhM6F4gKGMy3gHE0Q3Xzrf9c%2BoXF%2FqPTR1bW3v7u29FMwFsKSb0Ge%2FYw%2BGNikwLzzgsQTwGr5tz4h7k3Go5EwC%2FV7la5ggmsTCsHbOaeqq%2B8mbXA24%2FyViD8hoCeKXIc7b4um3zqxhl2PtWc6hoQrPN%2BQn0d8GjA9vfsvwEd5BJEGGySKhR2TaQGZeFcz1vneTOomk7WHewOqp%2BaI4FmBUeH4OKyqwgRnG11ok%2F9l8BEr0443aZ%2BZe%2FJo1oXHly8LtLozkaM7EgEfi7nSZ%2FUFDlGVFw7zwnVMSHgzKOVlD8mHTyBPooJgsows6f3r67nW%2BMXvXeWr%2FTkJLRZtZCSBAlDQlOiYfMdQxMrykX1rUbZNz0nZmdJ%2BKCeuMEYG2U36oqP3SFOPcAZ0kMa1a5C2ue3PMG5erJdDmg8C4LO%2BzrVvyVlXtOtJTh7oM90PM%2FXGes76jvckL7hdgYww6jiygY6pgF%2FKkyP5i%2BTNVF0iy8ZWJsTd%2B3VsbwUoKILR6BbjoqIZ99HKK7sDxvXXArwcuoaeT3ybz44g8VfzBW7RWkGBNR8jVo4Jg3CkeavsSVw2KZBZY3U71UqLjvw8%2BtpXj%2Fia12Km8X5o%2BZdfsQ6XKxWYs5MMAEjNflhahVg%2FoAJO5AMajMlelG7uLa04xNJtm1FryqLD1Yd4RwDIVQLEoQk0JasMGf4ZsjB&X-Amz-Signature=ab1a4fa0ac98834ddf799762ad0475167e176d53b935b5dcda974529aa16b5eb&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


### 系统调用过程


传参指令……（用户态）→陷入指令（用户态）[引发中断]→中断处理程序（内核态）[选择相应的系统调用处理程序]→相应系统调用处理程序（由传入的参数决定）


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/81119b28-7bd7-4ca6-85ed-8a132fcab89d/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB4667H3ENLVX%2F20260103%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260103T040357Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEEQaCXVzLXdlc3QtMiJGMEQCIHb4wbXuu9p38VnUaD7LmGPP4zqXqci8mwG%2BGosVmj85AiAqlG8Z7S%2F8kXm1%2FNS0r%2BqJHHo14hJVvVSyLLipoi1bgir%2FAwgNEAAaDDYzNzQyMzE4MzgwNSIMlmx2fERbc8XsSz%2FjKtwDHgH4KnREZZF8TIf7%2BdDHR41sFM7rQro0BPJP%2Fihf5iipQkn2Nc3F%2Bb3EXNv%2B%2BDO7iNeANWvmnrfU7GzBZuBhmG%2BMu6XCDw0016UqHKJ9vTqBKE2sc7oZv%2B1qh%2BpXPafUMxsG4MEBQmS%2FHcTsmvCYis4N%2BS6RQQETFyOHkQQmd4vVMhM6F4gKGMy3gHE0Q3Xzrf9c%2BoXF%2FqPTR1bW3v7u29FMwFsKSb0Ge%2FYw%2BGNikwLzzgsQTwGr5tz4h7k3Go5EwC%2FV7la5ggmsTCsHbOaeqq%2B8mbXA24%2FyViD8hoCeKXIc7b4um3zqxhl2PtWc6hoQrPN%2BQn0d8GjA9vfsvwEd5BJEGGySKhR2TaQGZeFcz1vneTOomk7WHewOqp%2BaI4FmBUeH4OKyqwgRnG11ok%2F9l8BEr0443aZ%2BZe%2FJo1oXHly8LtLozkaM7EgEfi7nSZ%2FUFDlGVFw7zwnVMSHgzKOVlD8mHTyBPooJgsows6f3r67nW%2BMXvXeWr%2FTkJLRZtZCSBAlDQlOiYfMdQxMrykX1rUbZNz0nZmdJ%2BKCeuMEYG2U36oqP3SFOPcAZ0kMa1a5C2ue3PMG5erJdDmg8C4LO%2BzrVvyVlXtOtJTh7oM90PM%2FXGes76jvckL7hdgYww6jiygY6pgF%2FKkyP5i%2BTNVF0iy8ZWJsTd%2B3VsbwUoKILR6BbjoqIZ99HKK7sDxvXXArwcuoaeT3ybz44g8VfzBW7RWkGBNR8jVo4Jg3CkeavsSVw2KZBZY3U71UqLjvw8%2BtpXj%2Fia12Km8X5o%2BZdfsQ6XKxWYs5MMAEjNflhahVg%2FoAJO5AMajMlelG7uLa04xNJtm1FryqLD1Yd4RwDIVQLEoQk0JasMGf4ZsjB&X-Amz-Signature=033c4a97a03bfe9a47278c2743155a96e4a079b76bb69f60075cb6b3d18302e4&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


ps：陷入指令=访管指令=trap指令


### 总结


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/d00274b7-ffbf-42d2-9255-534022d080b6/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB4667H3ENLVX%2F20260103%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260103T040357Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEEQaCXVzLXdlc3QtMiJGMEQCIHb4wbXuu9p38VnUaD7LmGPP4zqXqci8mwG%2BGosVmj85AiAqlG8Z7S%2F8kXm1%2FNS0r%2BqJHHo14hJVvVSyLLipoi1bgir%2FAwgNEAAaDDYzNzQyMzE4MzgwNSIMlmx2fERbc8XsSz%2FjKtwDHgH4KnREZZF8TIf7%2BdDHR41sFM7rQro0BPJP%2Fihf5iipQkn2Nc3F%2Bb3EXNv%2B%2BDO7iNeANWvmnrfU7GzBZuBhmG%2BMu6XCDw0016UqHKJ9vTqBKE2sc7oZv%2B1qh%2BpXPafUMxsG4MEBQmS%2FHcTsmvCYis4N%2BS6RQQETFyOHkQQmd4vVMhM6F4gKGMy3gHE0Q3Xzrf9c%2BoXF%2FqPTR1bW3v7u29FMwFsKSb0Ge%2FYw%2BGNikwLzzgsQTwGr5tz4h7k3Go5EwC%2FV7la5ggmsTCsHbOaeqq%2B8mbXA24%2FyViD8hoCeKXIc7b4um3zqxhl2PtWc6hoQrPN%2BQn0d8GjA9vfsvwEd5BJEGGySKhR2TaQGZeFcz1vneTOomk7WHewOqp%2BaI4FmBUeH4OKyqwgRnG11ok%2F9l8BEr0443aZ%2BZe%2FJo1oXHly8LtLozkaM7EgEfi7nSZ%2FUFDlGVFw7zwnVMSHgzKOVlD8mHTyBPooJgsows6f3r67nW%2BMXvXeWr%2FTkJLRZtZCSBAlDQlOiYfMdQxMrykX1rUbZNz0nZmdJ%2BKCeuMEYG2U36oqP3SFOPcAZ0kMa1a5C2ue3PMG5erJdDmg8C4LO%2BzrVvyVlXtOtJTh7oM90PM%2FXGes76jvckL7hdgYww6jiygY6pgF%2FKkyP5i%2BTNVF0iy8ZWJsTd%2B3VsbwUoKILR6BbjoqIZ99HKK7sDxvXXArwcuoaeT3ybz44g8VfzBW7RWkGBNR8jVo4Jg3CkeavsSVw2KZBZY3U71UqLjvw8%2BtpXj%2Fia12Km8X5o%2BZdfsQ6XKxWYs5MMAEjNflhahVg%2FoAJO5AMajMlelG7uLa04xNJtm1FryqLD1Yd4RwDIVQLEoQk0JasMGf4ZsjB&X-Amz-Signature=2da0c493af16a63895cd241be4f0581d3d9a9dff72fc538f32118828ba2a7caf&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)

