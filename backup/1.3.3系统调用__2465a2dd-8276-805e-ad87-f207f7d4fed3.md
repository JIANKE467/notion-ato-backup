
系统调用是提供内核服务的接口


（要想执行特权指令需要使用系统调用，而非使用越权的指令）


### 系统调用与库函数的区别


一个程序可以用汇编直接使用系统调用


也可以使用库函数间接使用系统调用（库函数直接使用系统调用）


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/a0f71c13-988a-4aca-bbc8-7fe8a14f2dfa/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB4663YMM2FCE%2F20260115%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260115T041504Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEGQaCXVzLXdlc3QtMiJHMEUCIGBqqng%2BaL1XTI9YsGVcX3oMprbqs3ztOxrBKy8h7LOcAiEAmWLNTJLrNExwkUVMv4rYeJF7114NIVtJe7RbutFWQjIq%2FwMILRAAGgw2Mzc0MjMxODM4MDUiDACWmjemqtZsfn8%2F2ircA3yA3t3%2BhE74iW1JdpVrEBYfHHfDiSvlEV6uEKWlvtpc3k4%2FcuI9Q4LVkgYly%2BQ5ERNMIVZVADG7ITtlz%2BPkZvQU3gggFuvY2%2FoXgtR5e1xQp3xRCgDp7GvihoGe6HBivAzP5W9PCwwrQO4v9aRV%2FfGmDH2m3HmQii0k2hcPvgkKiH0am4GzUA1WM2hKXBSzP1SEIhTngl23Ya3E4w58rEPn9s5wqO5vfS1Vb%2FdVAjC0jGlymi6BayLkCDn1pUnN%2FrHDDE2%2BZ6QU6Tpu53BWSEIsY4b8UALYAVtK6CRRdTEMJJ5GsU61wOQ6QWGfeD0oc1E6CMGZRmVuDMMSqzkjWC3NhArhOD3q7upT3UttbHqWavKz%2F97K6cp3YyhgD2aBTyLJIGBTbxv65plowHXNGRemJvE%2FOQl9g0GHT9ACpC06%2BXj0tKFMVLx%2BBc5h7y%2FfVhPdKaWNcERMNH4DZ1sHla1B2%2FmYH65KWF9fecY0aPD3TfBnqKwyoBBwt0U4pKRzVw%2FqWQqPeescKUum4ktBL6Ez0it4HPokQogqpCZhq%2BkdBADJ0bJvcKU984RhLu0ECaw8RuLHokybmmns6JI2JNrLVtrFXmBkSqTFBAlnVe0sAlTETbnfgpRk4UPMMInIocsGOqUBqBmrWwLCPdhg9J3C2he0UMgYd36QobvQ6Rt%2BvblefDjqAKOQuZ3RKXi6juL%2FlfYplFy2FaxoGGYchG%2BdpKAvO6G1M66oIPy5Rer6T5EJRo88mzbX2t3tETobeFhM3ZFtYi8ySZCNu9z1OAcVO7JT1bApVv81CzcENo3M%2FqPsUGSB0Iwowo13VwhbhM6JFz1IgFZEnC4Z%2B%2FIdOnPbY%2BaqSLfDtz%2Fb&X-Amz-Signature=81e405d25547de2d9d41cd0d56c29a9a186a7982a4d3f170dc6022a5fb9544a9&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


### 为什么要系统调用


例：当多个进程同时使用一种设备资源（如摄像头）需要内核决定使用顺序，否则会出现争抢摄像头的情况


### 什么功能要系统调用


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/5c6a2eff-5468-4340-8c3e-2646dc3700e6/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB4663YMM2FCE%2F20260115%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260115T041504Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEGQaCXVzLXdlc3QtMiJHMEUCIGBqqng%2BaL1XTI9YsGVcX3oMprbqs3ztOxrBKy8h7LOcAiEAmWLNTJLrNExwkUVMv4rYeJF7114NIVtJe7RbutFWQjIq%2FwMILRAAGgw2Mzc0MjMxODM4MDUiDACWmjemqtZsfn8%2F2ircA3yA3t3%2BhE74iW1JdpVrEBYfHHfDiSvlEV6uEKWlvtpc3k4%2FcuI9Q4LVkgYly%2BQ5ERNMIVZVADG7ITtlz%2BPkZvQU3gggFuvY2%2FoXgtR5e1xQp3xRCgDp7GvihoGe6HBivAzP5W9PCwwrQO4v9aRV%2FfGmDH2m3HmQii0k2hcPvgkKiH0am4GzUA1WM2hKXBSzP1SEIhTngl23Ya3E4w58rEPn9s5wqO5vfS1Vb%2FdVAjC0jGlymi6BayLkCDn1pUnN%2FrHDDE2%2BZ6QU6Tpu53BWSEIsY4b8UALYAVtK6CRRdTEMJJ5GsU61wOQ6QWGfeD0oc1E6CMGZRmVuDMMSqzkjWC3NhArhOD3q7upT3UttbHqWavKz%2F97K6cp3YyhgD2aBTyLJIGBTbxv65plowHXNGRemJvE%2FOQl9g0GHT9ACpC06%2BXj0tKFMVLx%2BBc5h7y%2FfVhPdKaWNcERMNH4DZ1sHla1B2%2FmYH65KWF9fecY0aPD3TfBnqKwyoBBwt0U4pKRzVw%2FqWQqPeescKUum4ktBL6Ez0it4HPokQogqpCZhq%2BkdBADJ0bJvcKU984RhLu0ECaw8RuLHokybmmns6JI2JNrLVtrFXmBkSqTFBAlnVe0sAlTETbnfgpRk4UPMMInIocsGOqUBqBmrWwLCPdhg9J3C2he0UMgYd36QobvQ6Rt%2BvblefDjqAKOQuZ3RKXi6juL%2FlfYplFy2FaxoGGYchG%2BdpKAvO6G1M66oIPy5Rer6T5EJRo88mzbX2t3tETobeFhM3ZFtYi8ySZCNu9z1OAcVO7JT1bApVv81CzcENo3M%2FqPsUGSB0Iwowo13VwhbhM6JFz1IgFZEnC4Z%2B%2FIdOnPbY%2BaqSLfDtz%2Fb&X-Amz-Signature=cd636e24586f1764915b8b60c4d9c033bd44dda47912a99fc37f064fc2f962bc&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


### 系统调用过程


传参指令……（用户态）→陷入指令（用户态）[引发中断]→中断处理程序（内核态）[选择相应的系统调用处理程序]→相应系统调用处理程序（由传入的参数决定）


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/81119b28-7bd7-4ca6-85ed-8a132fcab89d/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB4663YMM2FCE%2F20260115%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260115T041504Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEGQaCXVzLXdlc3QtMiJHMEUCIGBqqng%2BaL1XTI9YsGVcX3oMprbqs3ztOxrBKy8h7LOcAiEAmWLNTJLrNExwkUVMv4rYeJF7114NIVtJe7RbutFWQjIq%2FwMILRAAGgw2Mzc0MjMxODM4MDUiDACWmjemqtZsfn8%2F2ircA3yA3t3%2BhE74iW1JdpVrEBYfHHfDiSvlEV6uEKWlvtpc3k4%2FcuI9Q4LVkgYly%2BQ5ERNMIVZVADG7ITtlz%2BPkZvQU3gggFuvY2%2FoXgtR5e1xQp3xRCgDp7GvihoGe6HBivAzP5W9PCwwrQO4v9aRV%2FfGmDH2m3HmQii0k2hcPvgkKiH0am4GzUA1WM2hKXBSzP1SEIhTngl23Ya3E4w58rEPn9s5wqO5vfS1Vb%2FdVAjC0jGlymi6BayLkCDn1pUnN%2FrHDDE2%2BZ6QU6Tpu53BWSEIsY4b8UALYAVtK6CRRdTEMJJ5GsU61wOQ6QWGfeD0oc1E6CMGZRmVuDMMSqzkjWC3NhArhOD3q7upT3UttbHqWavKz%2F97K6cp3YyhgD2aBTyLJIGBTbxv65plowHXNGRemJvE%2FOQl9g0GHT9ACpC06%2BXj0tKFMVLx%2BBc5h7y%2FfVhPdKaWNcERMNH4DZ1sHla1B2%2FmYH65KWF9fecY0aPD3TfBnqKwyoBBwt0U4pKRzVw%2FqWQqPeescKUum4ktBL6Ez0it4HPokQogqpCZhq%2BkdBADJ0bJvcKU984RhLu0ECaw8RuLHokybmmns6JI2JNrLVtrFXmBkSqTFBAlnVe0sAlTETbnfgpRk4UPMMInIocsGOqUBqBmrWwLCPdhg9J3C2he0UMgYd36QobvQ6Rt%2BvblefDjqAKOQuZ3RKXi6juL%2FlfYplFy2FaxoGGYchG%2BdpKAvO6G1M66oIPy5Rer6T5EJRo88mzbX2t3tETobeFhM3ZFtYi8ySZCNu9z1OAcVO7JT1bApVv81CzcENo3M%2FqPsUGSB0Iwowo13VwhbhM6JFz1IgFZEnC4Z%2B%2FIdOnPbY%2BaqSLfDtz%2Fb&X-Amz-Signature=08e8c2359e31edd909811cccad06a21cd4eac73f8a11cd988524991fcbffc2c7&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


ps：陷入指令=访管指令=trap指令


### 总结


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/d00274b7-ffbf-42d2-9255-534022d080b6/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB4663YMM2FCE%2F20260115%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260115T041504Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEGQaCXVzLXdlc3QtMiJHMEUCIGBqqng%2BaL1XTI9YsGVcX3oMprbqs3ztOxrBKy8h7LOcAiEAmWLNTJLrNExwkUVMv4rYeJF7114NIVtJe7RbutFWQjIq%2FwMILRAAGgw2Mzc0MjMxODM4MDUiDACWmjemqtZsfn8%2F2ircA3yA3t3%2BhE74iW1JdpVrEBYfHHfDiSvlEV6uEKWlvtpc3k4%2FcuI9Q4LVkgYly%2BQ5ERNMIVZVADG7ITtlz%2BPkZvQU3gggFuvY2%2FoXgtR5e1xQp3xRCgDp7GvihoGe6HBivAzP5W9PCwwrQO4v9aRV%2FfGmDH2m3HmQii0k2hcPvgkKiH0am4GzUA1WM2hKXBSzP1SEIhTngl23Ya3E4w58rEPn9s5wqO5vfS1Vb%2FdVAjC0jGlymi6BayLkCDn1pUnN%2FrHDDE2%2BZ6QU6Tpu53BWSEIsY4b8UALYAVtK6CRRdTEMJJ5GsU61wOQ6QWGfeD0oc1E6CMGZRmVuDMMSqzkjWC3NhArhOD3q7upT3UttbHqWavKz%2F97K6cp3YyhgD2aBTyLJIGBTbxv65plowHXNGRemJvE%2FOQl9g0GHT9ACpC06%2BXj0tKFMVLx%2BBc5h7y%2FfVhPdKaWNcERMNH4DZ1sHla1B2%2FmYH65KWF9fecY0aPD3TfBnqKwyoBBwt0U4pKRzVw%2FqWQqPeescKUum4ktBL6Ez0it4HPokQogqpCZhq%2BkdBADJ0bJvcKU984RhLu0ECaw8RuLHokybmmns6JI2JNrLVtrFXmBkSqTFBAlnVe0sAlTETbnfgpRk4UPMMInIocsGOqUBqBmrWwLCPdhg9J3C2he0UMgYd36QobvQ6Rt%2BvblefDjqAKOQuZ3RKXi6juL%2FlfYplFy2FaxoGGYchG%2BdpKAvO6G1M66oIPy5Rer6T5EJRo88mzbX2t3tETobeFhM3ZFtYi8ySZCNu9z1OAcVO7JT1bApVv81CzcENo3M%2FqPsUGSB0Iwowo13VwhbhM6JFz1IgFZEnC4Z%2B%2FIdOnPbY%2BaqSLfDtz%2Fb&X-Amz-Signature=52cd2877969b67887be5654dbfc3dd00f2b4efb5d6d5bba3e5594aabca8d9557&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)

