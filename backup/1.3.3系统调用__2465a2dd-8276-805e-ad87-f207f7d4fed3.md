
系统调用是提供内核服务的接口


（要想执行特权指令需要使用系统调用，而非使用越权的指令）


### 系统调用与库函数的区别


一个程序可以用汇编直接使用系统调用


也可以使用库函数间接使用系统调用（库函数直接使用系统调用）


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/a0f71c13-988a-4aca-bbc8-7fe8a14f2dfa/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB466U5X3OFHH%2F20251228%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20251228T041611Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjELH%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDTeU7Y39v74N478Cecl8k4KZkGB%2B6jxbvjJgVJYiXU%2FAIhANOXYlOEvkWTmTLQd5aOciqpIh8RG09Byr6W8EvakovCKv8DCHoQABoMNjM3NDIzMTgzODA1IgzwbF9cTV3HIzYki5cq3AOJVW7ybMNYXimfvYp%2BVVtHdb6hD15cmLCqFHCsPhMUEE%2F9w%2BfUVgupeNjOKtD%2BjCvIAoxYya%2FmJ6mGhaYEcQlARt6WPZK5uR5yQVU%2B7lG755Q7Wljx7u2dpcd1qjMRT6b1Augni%2Be41Q0rPbLRHWyVBJZ%2BnetCrvR0EBiLiasg9MicPcHws3SWw0MqUBOA1y3UOZYetE8zaev8EvneadONCudEIzpXoBOXehV%2FaI336ANvuqbgtZR6Wm2KeEHBmAcqjb3iY%2FjoHrLPcz22FQFmgtsJiosF7lPwsM08Q1ZmFH7pL0YK84cnx0rqwlC4GXYjzM2MJNsz0PFKGRBCMusOea1Mj%2FtrhfDNht64jT0G7jtyKUOQjrQL6O%2FsRprAcu4sLOexlSYdQAnSEklPZAvbl3%2FWsl5oAX4pLdn%2FhXBHRFoQ60hdFO161cM9GdtM%2FPBZDmIzrIyRGuKb03qaSpa%2B6uyYbCEBJsans7hqEy2Ph3dG6qgyAZJN0CS50FNMpyajkVPj%2BpNXintTw9QxJcdUZUWsN9DZ2D8e01k9HNIAu6E33%2BzLpIKax8Re7mqtMrhHwuHu9gbaysrXXac70gkb1X5xXNN2WoogFOtHO8Jss6SiddLVhohjMBgWtDCWisLKBjqkAYafpZUHGG2bqcAiV0rC%2Fmi8JxwLfAw1Cf01d%2FizyYObWUqIIMdjL%2FDYQC2K9xF2LH%2Bi3Bbfk9CET6Bi5pYPq8QXkZdBkDXPL8M6JV9QtQkoaCT8HzbmP%2B9CLRcsYXPgdMbK0mEqM4FPdKRAhPFJvZNcJD%2BhJkQ%2Bp89ZUm4dIZ4Gjs8Wkbqu%2FNYWDZf8%2FihdQNlqL%2FGFkmq5SzogeBQhPlo9zqlx&X-Amz-Signature=ce41b1fc22f088542a759e182613cf934d68d3f2de8bfe650e705aeaf77f60ae&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


### 为什么要系统调用


例：当多个进程同时使用一种设备资源（如摄像头）需要内核决定使用顺序，否则会出现争抢摄像头的情况


### 什么功能要系统调用


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/5c6a2eff-5468-4340-8c3e-2646dc3700e6/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB466U5X3OFHH%2F20251228%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20251228T041611Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjELH%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDTeU7Y39v74N478Cecl8k4KZkGB%2B6jxbvjJgVJYiXU%2FAIhANOXYlOEvkWTmTLQd5aOciqpIh8RG09Byr6W8EvakovCKv8DCHoQABoMNjM3NDIzMTgzODA1IgzwbF9cTV3HIzYki5cq3AOJVW7ybMNYXimfvYp%2BVVtHdb6hD15cmLCqFHCsPhMUEE%2F9w%2BfUVgupeNjOKtD%2BjCvIAoxYya%2FmJ6mGhaYEcQlARt6WPZK5uR5yQVU%2B7lG755Q7Wljx7u2dpcd1qjMRT6b1Augni%2Be41Q0rPbLRHWyVBJZ%2BnetCrvR0EBiLiasg9MicPcHws3SWw0MqUBOA1y3UOZYetE8zaev8EvneadONCudEIzpXoBOXehV%2FaI336ANvuqbgtZR6Wm2KeEHBmAcqjb3iY%2FjoHrLPcz22FQFmgtsJiosF7lPwsM08Q1ZmFH7pL0YK84cnx0rqwlC4GXYjzM2MJNsz0PFKGRBCMusOea1Mj%2FtrhfDNht64jT0G7jtyKUOQjrQL6O%2FsRprAcu4sLOexlSYdQAnSEklPZAvbl3%2FWsl5oAX4pLdn%2FhXBHRFoQ60hdFO161cM9GdtM%2FPBZDmIzrIyRGuKb03qaSpa%2B6uyYbCEBJsans7hqEy2Ph3dG6qgyAZJN0CS50FNMpyajkVPj%2BpNXintTw9QxJcdUZUWsN9DZ2D8e01k9HNIAu6E33%2BzLpIKax8Re7mqtMrhHwuHu9gbaysrXXac70gkb1X5xXNN2WoogFOtHO8Jss6SiddLVhohjMBgWtDCWisLKBjqkAYafpZUHGG2bqcAiV0rC%2Fmi8JxwLfAw1Cf01d%2FizyYObWUqIIMdjL%2FDYQC2K9xF2LH%2Bi3Bbfk9CET6Bi5pYPq8QXkZdBkDXPL8M6JV9QtQkoaCT8HzbmP%2B9CLRcsYXPgdMbK0mEqM4FPdKRAhPFJvZNcJD%2BhJkQ%2Bp89ZUm4dIZ4Gjs8Wkbqu%2FNYWDZf8%2FihdQNlqL%2FGFkmq5SzogeBQhPlo9zqlx&X-Amz-Signature=3cb5d0587bb5c9b7de387a7010a316021638fbd5b3400ea4969c946915319ad0&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


### 系统调用过程


传参指令……（用户态）→陷入指令（用户态）[引发中断]→中断处理程序（内核态）[选择相应的系统调用处理程序]→相应系统调用处理程序（由传入的参数决定）


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/81119b28-7bd7-4ca6-85ed-8a132fcab89d/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB466U5X3OFHH%2F20251228%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20251228T041611Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjELH%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDTeU7Y39v74N478Cecl8k4KZkGB%2B6jxbvjJgVJYiXU%2FAIhANOXYlOEvkWTmTLQd5aOciqpIh8RG09Byr6W8EvakovCKv8DCHoQABoMNjM3NDIzMTgzODA1IgzwbF9cTV3HIzYki5cq3AOJVW7ybMNYXimfvYp%2BVVtHdb6hD15cmLCqFHCsPhMUEE%2F9w%2BfUVgupeNjOKtD%2BjCvIAoxYya%2FmJ6mGhaYEcQlARt6WPZK5uR5yQVU%2B7lG755Q7Wljx7u2dpcd1qjMRT6b1Augni%2Be41Q0rPbLRHWyVBJZ%2BnetCrvR0EBiLiasg9MicPcHws3SWw0MqUBOA1y3UOZYetE8zaev8EvneadONCudEIzpXoBOXehV%2FaI336ANvuqbgtZR6Wm2KeEHBmAcqjb3iY%2FjoHrLPcz22FQFmgtsJiosF7lPwsM08Q1ZmFH7pL0YK84cnx0rqwlC4GXYjzM2MJNsz0PFKGRBCMusOea1Mj%2FtrhfDNht64jT0G7jtyKUOQjrQL6O%2FsRprAcu4sLOexlSYdQAnSEklPZAvbl3%2FWsl5oAX4pLdn%2FhXBHRFoQ60hdFO161cM9GdtM%2FPBZDmIzrIyRGuKb03qaSpa%2B6uyYbCEBJsans7hqEy2Ph3dG6qgyAZJN0CS50FNMpyajkVPj%2BpNXintTw9QxJcdUZUWsN9DZ2D8e01k9HNIAu6E33%2BzLpIKax8Re7mqtMrhHwuHu9gbaysrXXac70gkb1X5xXNN2WoogFOtHO8Jss6SiddLVhohjMBgWtDCWisLKBjqkAYafpZUHGG2bqcAiV0rC%2Fmi8JxwLfAw1Cf01d%2FizyYObWUqIIMdjL%2FDYQC2K9xF2LH%2Bi3Bbfk9CET6Bi5pYPq8QXkZdBkDXPL8M6JV9QtQkoaCT8HzbmP%2B9CLRcsYXPgdMbK0mEqM4FPdKRAhPFJvZNcJD%2BhJkQ%2Bp89ZUm4dIZ4Gjs8Wkbqu%2FNYWDZf8%2FihdQNlqL%2FGFkmq5SzogeBQhPlo9zqlx&X-Amz-Signature=d8b5d1bda84bd5db74716c45b4ba907826c9d59dba8f968aaf9d2ef2cc66acb5&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


ps：陷入指令=访管指令=trap指令


### 总结


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/d00274b7-ffbf-42d2-9255-534022d080b6/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB466U5X3OFHH%2F20251228%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20251228T041611Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjELH%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDTeU7Y39v74N478Cecl8k4KZkGB%2B6jxbvjJgVJYiXU%2FAIhANOXYlOEvkWTmTLQd5aOciqpIh8RG09Byr6W8EvakovCKv8DCHoQABoMNjM3NDIzMTgzODA1IgzwbF9cTV3HIzYki5cq3AOJVW7ybMNYXimfvYp%2BVVtHdb6hD15cmLCqFHCsPhMUEE%2F9w%2BfUVgupeNjOKtD%2BjCvIAoxYya%2FmJ6mGhaYEcQlARt6WPZK5uR5yQVU%2B7lG755Q7Wljx7u2dpcd1qjMRT6b1Augni%2Be41Q0rPbLRHWyVBJZ%2BnetCrvR0EBiLiasg9MicPcHws3SWw0MqUBOA1y3UOZYetE8zaev8EvneadONCudEIzpXoBOXehV%2FaI336ANvuqbgtZR6Wm2KeEHBmAcqjb3iY%2FjoHrLPcz22FQFmgtsJiosF7lPwsM08Q1ZmFH7pL0YK84cnx0rqwlC4GXYjzM2MJNsz0PFKGRBCMusOea1Mj%2FtrhfDNht64jT0G7jtyKUOQjrQL6O%2FsRprAcu4sLOexlSYdQAnSEklPZAvbl3%2FWsl5oAX4pLdn%2FhXBHRFoQ60hdFO161cM9GdtM%2FPBZDmIzrIyRGuKb03qaSpa%2B6uyYbCEBJsans7hqEy2Ph3dG6qgyAZJN0CS50FNMpyajkVPj%2BpNXintTw9QxJcdUZUWsN9DZ2D8e01k9HNIAu6E33%2BzLpIKax8Re7mqtMrhHwuHu9gbaysrXXac70gkb1X5xXNN2WoogFOtHO8Jss6SiddLVhohjMBgWtDCWisLKBjqkAYafpZUHGG2bqcAiV0rC%2Fmi8JxwLfAw1Cf01d%2FizyYObWUqIIMdjL%2FDYQC2K9xF2LH%2Bi3Bbfk9CET6Bi5pYPq8QXkZdBkDXPL8M6JV9QtQkoaCT8HzbmP%2B9CLRcsYXPgdMbK0mEqM4FPdKRAhPFJvZNcJD%2BhJkQ%2Bp89ZUm4dIZ4Gjs8Wkbqu%2FNYWDZf8%2FihdQNlqL%2FGFkmq5SzogeBQhPlo9zqlx&X-Amz-Signature=4f90846665d364982d6ab0ab54c8d5602e30c5cafaf68768be45b079957d0442&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)

