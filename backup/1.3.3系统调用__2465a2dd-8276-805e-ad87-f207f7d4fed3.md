
系统调用是提供内核服务的接口


（要想执行特权指令需要使用系统调用，而非使用越权的指令）


### 系统调用与库函数的区别


一个程序可以用汇编直接使用系统调用


也可以使用库函数间接使用系统调用（库函数直接使用系统调用）


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/a0f71c13-988a-4aca-bbc8-7fe8a14f2dfa/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB46623DHLYOB%2F20260113%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260113T041154Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEDQaCXVzLXdlc3QtMiJGMEQCIHijXEB9oB%2BgUNbxIOhzGKQpNps5%2BijaCJ6lm16r%2FR20AiBzSABDJWi0Ar8cX3n4q6MAubAkNW0N3gNH7YINgJweYyqIBAj9%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAAaDDYzNzQyMzE4MzgwNSIMxMGKEgOKjU3vEN7oKtwD6zI7r9b1m81SmemmUVFbvHVz6iIyXuRjZiPliGnXUVVbvrAokN5u5c4OlKN65Z76XY2tcfi7JGZJJazbSas6l5lzzkUlACU1nKLFR2fL%2B1pw3mxBEdHJ94B253a51ZlWtHuJj93w0zI02TR5%2BlXlNhR5WEOP88yAyQmGPA2eZCZigVjKgWPqLvmKp%2BZcTcIrEjbVZ%2BsukCB%2FvJjZEJywKBS%2FuqHJ%2BImdfWu1KQHEjkttllLv45huNRUb1AQ55vfK7jn8fB086rJLYLXENpwoKr0TAf4lkeLFoEZ3BuZ%2FuRk2eP%2BGO4hz7e0BnZmerMV89mKNGtSho3jGU%2ByYe97GLTAdvgBO5i4AwzxKGHKQqi9cGGVNLc4aoqhgihZLtV0DWk3SptGFMPgM9TGzK388AOnFhBqARUpassyt6Ep5wvFU0LVJr%2B7ATcVeatICt0Wq7uWMdbLFOzr51RSDqK1LALm55VjzJyGHvFdDH45vO7Or2vvV0ZCjoL%2B0wUIkgKvbwv6t1a9YB5tDb3WIrrEjE2NQDWLlCvpsAZEd89QvMR0k0haEWhWjYGe1ejbVT8Z8lzYc96DqgIw2i%2BzQ%2F5vHFx%2FpnpvBypdv9lLn4oQ81TilD1pbIBW9EnKuU%2FAw4YaXywY6pgFJoQS2FukR6yxkYN2ThGlcPaAFfWfKRvxEuznv5sN%2BKl5T9tG4r9%2BaAtLXJGf6JAQF%2FQD37aLE%2BlneSXOEfszIdJMcGzfirsMG8FaPIeMKN2F%2BFILaQc8Paf6xYfdETIGkf%2FPxPiuEWjPNCxNQlrscTECeg0ekC5Xoq7QtPVD%2FammibC7TN4YgKQa0dnt9HNse5%2B8c6C5glR5Is%2F47%2FUtnxm%2FRPREU&X-Amz-Signature=90578fe245f2840a376077227e5db53daf4385531da98e67d117574a5ac34a1c&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


### 为什么要系统调用


例：当多个进程同时使用一种设备资源（如摄像头）需要内核决定使用顺序，否则会出现争抢摄像头的情况


### 什么功能要系统调用


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/5c6a2eff-5468-4340-8c3e-2646dc3700e6/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB46623DHLYOB%2F20260113%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260113T041154Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEDQaCXVzLXdlc3QtMiJGMEQCIHijXEB9oB%2BgUNbxIOhzGKQpNps5%2BijaCJ6lm16r%2FR20AiBzSABDJWi0Ar8cX3n4q6MAubAkNW0N3gNH7YINgJweYyqIBAj9%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAAaDDYzNzQyMzE4MzgwNSIMxMGKEgOKjU3vEN7oKtwD6zI7r9b1m81SmemmUVFbvHVz6iIyXuRjZiPliGnXUVVbvrAokN5u5c4OlKN65Z76XY2tcfi7JGZJJazbSas6l5lzzkUlACU1nKLFR2fL%2B1pw3mxBEdHJ94B253a51ZlWtHuJj93w0zI02TR5%2BlXlNhR5WEOP88yAyQmGPA2eZCZigVjKgWPqLvmKp%2BZcTcIrEjbVZ%2BsukCB%2FvJjZEJywKBS%2FuqHJ%2BImdfWu1KQHEjkttllLv45huNRUb1AQ55vfK7jn8fB086rJLYLXENpwoKr0TAf4lkeLFoEZ3BuZ%2FuRk2eP%2BGO4hz7e0BnZmerMV89mKNGtSho3jGU%2ByYe97GLTAdvgBO5i4AwzxKGHKQqi9cGGVNLc4aoqhgihZLtV0DWk3SptGFMPgM9TGzK388AOnFhBqARUpassyt6Ep5wvFU0LVJr%2B7ATcVeatICt0Wq7uWMdbLFOzr51RSDqK1LALm55VjzJyGHvFdDH45vO7Or2vvV0ZCjoL%2B0wUIkgKvbwv6t1a9YB5tDb3WIrrEjE2NQDWLlCvpsAZEd89QvMR0k0haEWhWjYGe1ejbVT8Z8lzYc96DqgIw2i%2BzQ%2F5vHFx%2FpnpvBypdv9lLn4oQ81TilD1pbIBW9EnKuU%2FAw4YaXywY6pgFJoQS2FukR6yxkYN2ThGlcPaAFfWfKRvxEuznv5sN%2BKl5T9tG4r9%2BaAtLXJGf6JAQF%2FQD37aLE%2BlneSXOEfszIdJMcGzfirsMG8FaPIeMKN2F%2BFILaQc8Paf6xYfdETIGkf%2FPxPiuEWjPNCxNQlrscTECeg0ekC5Xoq7QtPVD%2FammibC7TN4YgKQa0dnt9HNse5%2B8c6C5glR5Is%2F47%2FUtnxm%2FRPREU&X-Amz-Signature=b2db4f7a473312874633b053cb7f90e3c16a0a9327fd5a312723127f388a5ed4&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


### 系统调用过程


传参指令……（用户态）→陷入指令（用户态）[引发中断]→中断处理程序（内核态）[选择相应的系统调用处理程序]→相应系统调用处理程序（由传入的参数决定）


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/81119b28-7bd7-4ca6-85ed-8a132fcab89d/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB46623DHLYOB%2F20260113%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260113T041154Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEDQaCXVzLXdlc3QtMiJGMEQCIHijXEB9oB%2BgUNbxIOhzGKQpNps5%2BijaCJ6lm16r%2FR20AiBzSABDJWi0Ar8cX3n4q6MAubAkNW0N3gNH7YINgJweYyqIBAj9%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAAaDDYzNzQyMzE4MzgwNSIMxMGKEgOKjU3vEN7oKtwD6zI7r9b1m81SmemmUVFbvHVz6iIyXuRjZiPliGnXUVVbvrAokN5u5c4OlKN65Z76XY2tcfi7JGZJJazbSas6l5lzzkUlACU1nKLFR2fL%2B1pw3mxBEdHJ94B253a51ZlWtHuJj93w0zI02TR5%2BlXlNhR5WEOP88yAyQmGPA2eZCZigVjKgWPqLvmKp%2BZcTcIrEjbVZ%2BsukCB%2FvJjZEJywKBS%2FuqHJ%2BImdfWu1KQHEjkttllLv45huNRUb1AQ55vfK7jn8fB086rJLYLXENpwoKr0TAf4lkeLFoEZ3BuZ%2FuRk2eP%2BGO4hz7e0BnZmerMV89mKNGtSho3jGU%2ByYe97GLTAdvgBO5i4AwzxKGHKQqi9cGGVNLc4aoqhgihZLtV0DWk3SptGFMPgM9TGzK388AOnFhBqARUpassyt6Ep5wvFU0LVJr%2B7ATcVeatICt0Wq7uWMdbLFOzr51RSDqK1LALm55VjzJyGHvFdDH45vO7Or2vvV0ZCjoL%2B0wUIkgKvbwv6t1a9YB5tDb3WIrrEjE2NQDWLlCvpsAZEd89QvMR0k0haEWhWjYGe1ejbVT8Z8lzYc96DqgIw2i%2BzQ%2F5vHFx%2FpnpvBypdv9lLn4oQ81TilD1pbIBW9EnKuU%2FAw4YaXywY6pgFJoQS2FukR6yxkYN2ThGlcPaAFfWfKRvxEuznv5sN%2BKl5T9tG4r9%2BaAtLXJGf6JAQF%2FQD37aLE%2BlneSXOEfszIdJMcGzfirsMG8FaPIeMKN2F%2BFILaQc8Paf6xYfdETIGkf%2FPxPiuEWjPNCxNQlrscTECeg0ekC5Xoq7QtPVD%2FammibC7TN4YgKQa0dnt9HNse5%2B8c6C5glR5Is%2F47%2FUtnxm%2FRPREU&X-Amz-Signature=762816887e0783587a686f6f8e5dd50bc4ef04d336449a65c3755126a46b6f76&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


ps：陷入指令=访管指令=trap指令


### 总结


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/d00274b7-ffbf-42d2-9255-534022d080b6/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB46623DHLYOB%2F20260113%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260113T041154Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEDQaCXVzLXdlc3QtMiJGMEQCIHijXEB9oB%2BgUNbxIOhzGKQpNps5%2BijaCJ6lm16r%2FR20AiBzSABDJWi0Ar8cX3n4q6MAubAkNW0N3gNH7YINgJweYyqIBAj9%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAAaDDYzNzQyMzE4MzgwNSIMxMGKEgOKjU3vEN7oKtwD6zI7r9b1m81SmemmUVFbvHVz6iIyXuRjZiPliGnXUVVbvrAokN5u5c4OlKN65Z76XY2tcfi7JGZJJazbSas6l5lzzkUlACU1nKLFR2fL%2B1pw3mxBEdHJ94B253a51ZlWtHuJj93w0zI02TR5%2BlXlNhR5WEOP88yAyQmGPA2eZCZigVjKgWPqLvmKp%2BZcTcIrEjbVZ%2BsukCB%2FvJjZEJywKBS%2FuqHJ%2BImdfWu1KQHEjkttllLv45huNRUb1AQ55vfK7jn8fB086rJLYLXENpwoKr0TAf4lkeLFoEZ3BuZ%2FuRk2eP%2BGO4hz7e0BnZmerMV89mKNGtSho3jGU%2ByYe97GLTAdvgBO5i4AwzxKGHKQqi9cGGVNLc4aoqhgihZLtV0DWk3SptGFMPgM9TGzK388AOnFhBqARUpassyt6Ep5wvFU0LVJr%2B7ATcVeatICt0Wq7uWMdbLFOzr51RSDqK1LALm55VjzJyGHvFdDH45vO7Or2vvV0ZCjoL%2B0wUIkgKvbwv6t1a9YB5tDb3WIrrEjE2NQDWLlCvpsAZEd89QvMR0k0haEWhWjYGe1ejbVT8Z8lzYc96DqgIw2i%2BzQ%2F5vHFx%2FpnpvBypdv9lLn4oQ81TilD1pbIBW9EnKuU%2FAw4YaXywY6pgFJoQS2FukR6yxkYN2ThGlcPaAFfWfKRvxEuznv5sN%2BKl5T9tG4r9%2BaAtLXJGf6JAQF%2FQD37aLE%2BlneSXOEfszIdJMcGzfirsMG8FaPIeMKN2F%2BFILaQc8Paf6xYfdETIGkf%2FPxPiuEWjPNCxNQlrscTECeg0ekC5Xoq7QtPVD%2FammibC7TN4YgKQa0dnt9HNse5%2B8c6C5glR5Is%2F47%2FUtnxm%2FRPREU&X-Amz-Signature=b0472eacab9ddcba47c1c711e82e6220305658032e916dc22e2bad718730c38c&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)

