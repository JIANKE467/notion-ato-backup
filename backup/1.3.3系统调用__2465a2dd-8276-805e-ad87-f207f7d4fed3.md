
系统调用是提供内核服务的接口


（要想执行特权指令需要使用系统调用，而非使用越权的指令）


### 系统调用与库函数的区别


一个程序可以用汇编直接使用系统调用


也可以使用库函数间接使用系统调用（库函数直接使用系统调用）


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/a0f71c13-988a-4aca-bbc8-7fe8a14f2dfa/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB466SLOZTL6R%2F20260201%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260201T051403Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEPv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCsNb0W3slMiJEdgnhNOTGp1OvhkYmynefU2%2F%2Fq8ERofwIgJJcUmwzFZsc9RbiFidtqWZiYaZ69caPUTNXgqGR%2BICsqiAQIxP%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAAGgw2Mzc0MjMxODM4MDUiDISMNGbihOr2V0bOMCrcAznasice%2BrvNj6cU3B4i9fC5lZNui53s28I%2FyCiyOhxP66HWFZXFnCF%2BgFkxHP3h7Qic7mZPIxNpaqduU6ZjVoT6FNJ8osdzCfZVoG3hTs3Sj7Uf3eEHDk4VVoE1X5kln1PTTd1H04oT9K8ElBd37tv2wDvm0MxhaRwhhyK%2BERmdfnHwiKojMBEEBi2dKTzhnFSclsB1K8NekF4DnNaMTB8tpI0BGM50Fm%2BB2ZP5Mq%2BP%2Ff9nYy1NKZqNHToj6Vzu5%2BIxXCf7HWzhABm%2BGCP6DTMx5WAzFU4npmPmcXDeX1tzgqW81%2BYpfqHczyliFvUUwyLYMqQNQJad8XIVItv6FE7RFx1hf14lt2xU%2BdsFXn9bz5lbfqVzgsOi%2BcjmfWoQ7YH7WbnriY%2F1IklXCLfoZbNp3HXYmxMlI3eljiWEWo%2B8LyMjGOXxcRKC4tbcF%2B3srqL45Ot9PO35kHTz6U2kE4Ah5KJFNU9HDq6CA6gsLtN8%2BePCj%2BSlyxTD9YySz%2BfxGguEbz9lKaEl0Bi%2FBLALGGAG4AxOMBUiof3oldBj9fhUUBoqt4qfuaTB3iDAPAC47QrdTC27OJYyNR1qrPOGbEIMPblohqDkSU894uFIFei%2B9Ve1M8iBp%2BsVZ8HEMPL%2F%2BssGOqUB0Vkfj4IwRtz692xVrpUSHL7X3BZbqcDmHtZbGO%2FuivaD%2B9yMEkgYDSF3RYRC2FYqMxULfmopUJDGn%2FasTEFQ9EhmyLtXqQ1EGyXGUyVizk5ajwUPtHAHOclYmpRvvuIdjFv0UOeVqUs6OgKCbzhgNCyrmP6oI%2BaJ0Z%2FaJXGDxyoblpH8nl%2FV%2BGzOhrE6asjH2%2Flh7A2u%2BWVh1HZ0B9cIR3beU4Ph&X-Amz-Signature=29cafe8f74641eb4aab4592ffd93a166eff9bc161c68a5c99215591f5485c523&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


### 为什么要系统调用


例：当多个进程同时使用一种设备资源（如摄像头）需要内核决定使用顺序，否则会出现争抢摄像头的情况


### 什么功能要系统调用


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/5c6a2eff-5468-4340-8c3e-2646dc3700e6/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB466SLOZTL6R%2F20260201%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260201T051403Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEPv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCsNb0W3slMiJEdgnhNOTGp1OvhkYmynefU2%2F%2Fq8ERofwIgJJcUmwzFZsc9RbiFidtqWZiYaZ69caPUTNXgqGR%2BICsqiAQIxP%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAAGgw2Mzc0MjMxODM4MDUiDISMNGbihOr2V0bOMCrcAznasice%2BrvNj6cU3B4i9fC5lZNui53s28I%2FyCiyOhxP66HWFZXFnCF%2BgFkxHP3h7Qic7mZPIxNpaqduU6ZjVoT6FNJ8osdzCfZVoG3hTs3Sj7Uf3eEHDk4VVoE1X5kln1PTTd1H04oT9K8ElBd37tv2wDvm0MxhaRwhhyK%2BERmdfnHwiKojMBEEBi2dKTzhnFSclsB1K8NekF4DnNaMTB8tpI0BGM50Fm%2BB2ZP5Mq%2BP%2Ff9nYy1NKZqNHToj6Vzu5%2BIxXCf7HWzhABm%2BGCP6DTMx5WAzFU4npmPmcXDeX1tzgqW81%2BYpfqHczyliFvUUwyLYMqQNQJad8XIVItv6FE7RFx1hf14lt2xU%2BdsFXn9bz5lbfqVzgsOi%2BcjmfWoQ7YH7WbnriY%2F1IklXCLfoZbNp3HXYmxMlI3eljiWEWo%2B8LyMjGOXxcRKC4tbcF%2B3srqL45Ot9PO35kHTz6U2kE4Ah5KJFNU9HDq6CA6gsLtN8%2BePCj%2BSlyxTD9YySz%2BfxGguEbz9lKaEl0Bi%2FBLALGGAG4AxOMBUiof3oldBj9fhUUBoqt4qfuaTB3iDAPAC47QrdTC27OJYyNR1qrPOGbEIMPblohqDkSU894uFIFei%2B9Ve1M8iBp%2BsVZ8HEMPL%2F%2BssGOqUB0Vkfj4IwRtz692xVrpUSHL7X3BZbqcDmHtZbGO%2FuivaD%2B9yMEkgYDSF3RYRC2FYqMxULfmopUJDGn%2FasTEFQ9EhmyLtXqQ1EGyXGUyVizk5ajwUPtHAHOclYmpRvvuIdjFv0UOeVqUs6OgKCbzhgNCyrmP6oI%2BaJ0Z%2FaJXGDxyoblpH8nl%2FV%2BGzOhrE6asjH2%2Flh7A2u%2BWVh1HZ0B9cIR3beU4Ph&X-Amz-Signature=8fe8ca1d3b89af4be73e3fb2eb4e7469d0917deb98a404c0c44fb5d315a6f29e&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


### 系统调用过程


传参指令……（用户态）→陷入指令（用户态）[引发中断]→中断处理程序（内核态）[选择相应的系统调用处理程序]→相应系统调用处理程序（由传入的参数决定）


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/81119b28-7bd7-4ca6-85ed-8a132fcab89d/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB466SLOZTL6R%2F20260201%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260201T051403Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEPv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCsNb0W3slMiJEdgnhNOTGp1OvhkYmynefU2%2F%2Fq8ERofwIgJJcUmwzFZsc9RbiFidtqWZiYaZ69caPUTNXgqGR%2BICsqiAQIxP%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAAGgw2Mzc0MjMxODM4MDUiDISMNGbihOr2V0bOMCrcAznasice%2BrvNj6cU3B4i9fC5lZNui53s28I%2FyCiyOhxP66HWFZXFnCF%2BgFkxHP3h7Qic7mZPIxNpaqduU6ZjVoT6FNJ8osdzCfZVoG3hTs3Sj7Uf3eEHDk4VVoE1X5kln1PTTd1H04oT9K8ElBd37tv2wDvm0MxhaRwhhyK%2BERmdfnHwiKojMBEEBi2dKTzhnFSclsB1K8NekF4DnNaMTB8tpI0BGM50Fm%2BB2ZP5Mq%2BP%2Ff9nYy1NKZqNHToj6Vzu5%2BIxXCf7HWzhABm%2BGCP6DTMx5WAzFU4npmPmcXDeX1tzgqW81%2BYpfqHczyliFvUUwyLYMqQNQJad8XIVItv6FE7RFx1hf14lt2xU%2BdsFXn9bz5lbfqVzgsOi%2BcjmfWoQ7YH7WbnriY%2F1IklXCLfoZbNp3HXYmxMlI3eljiWEWo%2B8LyMjGOXxcRKC4tbcF%2B3srqL45Ot9PO35kHTz6U2kE4Ah5KJFNU9HDq6CA6gsLtN8%2BePCj%2BSlyxTD9YySz%2BfxGguEbz9lKaEl0Bi%2FBLALGGAG4AxOMBUiof3oldBj9fhUUBoqt4qfuaTB3iDAPAC47QrdTC27OJYyNR1qrPOGbEIMPblohqDkSU894uFIFei%2B9Ve1M8iBp%2BsVZ8HEMPL%2F%2BssGOqUB0Vkfj4IwRtz692xVrpUSHL7X3BZbqcDmHtZbGO%2FuivaD%2B9yMEkgYDSF3RYRC2FYqMxULfmopUJDGn%2FasTEFQ9EhmyLtXqQ1EGyXGUyVizk5ajwUPtHAHOclYmpRvvuIdjFv0UOeVqUs6OgKCbzhgNCyrmP6oI%2BaJ0Z%2FaJXGDxyoblpH8nl%2FV%2BGzOhrE6asjH2%2Flh7A2u%2BWVh1HZ0B9cIR3beU4Ph&X-Amz-Signature=e30c82e7d17f08293f076cdb4575417e70df39239d90e079e54cd74cc100b224&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


ps：陷入指令=访管指令=trap指令


### 总结


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/d00274b7-ffbf-42d2-9255-534022d080b6/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB466SLOZTL6R%2F20260201%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260201T051403Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEPv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCsNb0W3slMiJEdgnhNOTGp1OvhkYmynefU2%2F%2Fq8ERofwIgJJcUmwzFZsc9RbiFidtqWZiYaZ69caPUTNXgqGR%2BICsqiAQIxP%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAAGgw2Mzc0MjMxODM4MDUiDISMNGbihOr2V0bOMCrcAznasice%2BrvNj6cU3B4i9fC5lZNui53s28I%2FyCiyOhxP66HWFZXFnCF%2BgFkxHP3h7Qic7mZPIxNpaqduU6ZjVoT6FNJ8osdzCfZVoG3hTs3Sj7Uf3eEHDk4VVoE1X5kln1PTTd1H04oT9K8ElBd37tv2wDvm0MxhaRwhhyK%2BERmdfnHwiKojMBEEBi2dKTzhnFSclsB1K8NekF4DnNaMTB8tpI0BGM50Fm%2BB2ZP5Mq%2BP%2Ff9nYy1NKZqNHToj6Vzu5%2BIxXCf7HWzhABm%2BGCP6DTMx5WAzFU4npmPmcXDeX1tzgqW81%2BYpfqHczyliFvUUwyLYMqQNQJad8XIVItv6FE7RFx1hf14lt2xU%2BdsFXn9bz5lbfqVzgsOi%2BcjmfWoQ7YH7WbnriY%2F1IklXCLfoZbNp3HXYmxMlI3eljiWEWo%2B8LyMjGOXxcRKC4tbcF%2B3srqL45Ot9PO35kHTz6U2kE4Ah5KJFNU9HDq6CA6gsLtN8%2BePCj%2BSlyxTD9YySz%2BfxGguEbz9lKaEl0Bi%2FBLALGGAG4AxOMBUiof3oldBj9fhUUBoqt4qfuaTB3iDAPAC47QrdTC27OJYyNR1qrPOGbEIMPblohqDkSU894uFIFei%2B9Ve1M8iBp%2BsVZ8HEMPL%2F%2BssGOqUB0Vkfj4IwRtz692xVrpUSHL7X3BZbqcDmHtZbGO%2FuivaD%2B9yMEkgYDSF3RYRC2FYqMxULfmopUJDGn%2FasTEFQ9EhmyLtXqQ1EGyXGUyVizk5ajwUPtHAHOclYmpRvvuIdjFv0UOeVqUs6OgKCbzhgNCyrmP6oI%2BaJ0Z%2FaJXGDxyoblpH8nl%2FV%2BGzOhrE6asjH2%2Flh7A2u%2BWVh1HZ0B9cIR3beU4Ph&X-Amz-Signature=c4c317ea344868d54180d61a2aaf503bc5daed7c93e278ec7b15990e910b7128&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)

