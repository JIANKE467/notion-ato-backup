
系统调用是提供内核服务的接口


（要想执行特权指令需要使用系统调用，而非使用越权的指令）


### 系统调用与库函数的区别


一个程序可以用汇编直接使用系统调用


也可以使用库函数间接使用系统调用（库函数直接使用系统调用）


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/a0f71c13-988a-4aca-bbc8-7fe8a14f2dfa/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB46663GTYYJX%2F20251215%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20251215T041353Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHwaCXVzLXdlc3QtMiJHMEUCIBFIK3l0%2BPZMqhiy5wJenq5DjZRc%2B8kTnFUkBkBvfDhXAiEArIiYKNQXYrvX6Zvhj0r25GlHWt%2FgRuDjhUkVyxFw7bwq%2FwMIRRAAGgw2Mzc0MjMxODM4MDUiDNzunwpBzzayhft8DSrcAwDNjgF%2BERQMkt%2FhvkoTGsC%2BKKjlv7Y5y%2F5smRyo6F7g46Q3KP7d28Rb6DXkSzwF%2FKj7H40%2FnH3UB6XVIQhfk71XPcEJtkwjLJisB14hRk9ngSVihE1mOlUN%2FevwhkNV0qI3Va%2Ba0KzAzxfIFgMvOc14xexQKWsQBR%2BrLf4Iwl5kLeHnT0vIpmN0iA8HF3VqGiRkFVG9ItG8d7l3S8jFkmuBWcK5dtinHDYWKxSJzZl3X%2Be8dYTxoiZbPxfrUegxyQ1v9d%2FKJnYN3%2Be5qOxwghAx%2BsIhZrOuvMHVnketwUamHf%2FjFzypxS0%2FcJiRU%2Bc78RHrEq%2Bobp3WENqqPhlfHY9wmL79YHADWbRTR9Y4Bk0fQZ%2FSnMUEgPFS3mwZGNtOjvXs1I3YEFHF2QJgTq592z5mxZcQ2iJORxsYMexCrVbCI18wL%2FcX8GFER%2B1226C%2ByvgsoLu5VpUV6vIH4zpb6GXdZcRqGavDQG%2Bkc1Tqkqjb%2Bd27eeaSnlnqAl%2B8xMzkMe5Remd9USBc4bINyMbTMmDMbji91jfGc9RHYkxOui1z2LV%2F5JM5Dezpw9cYEiYchoDRzR5wCsd7PGMtxAI1EosviR6T17%2Ba9TKGv%2B7VgVu4YnImc0SGw%2F8j%2FYQNMNWL%2FskGOqUB7AB9JxudyT7m42snM97tGCBJme2iqp9FR%2Fdn38TP7Upo7%2F9t%2FYgma%2FdMIbYn02eacMN735OlPTkWlp7pNaxmTNnJVCo%2BK8xAJwABepubt2spSkiFkbNiYJNm%2Fl3g6l4KMovdDqyIOovWr6PULI0jKRRyWohS%2BznUyaOaedxY%2F%2FV%2FOqgfPwArrQQRHHvd%2Fge4eNg4AvGTqX5wlKBIIIyWJM02wps8&X-Amz-Signature=6087560f6ca0687068f9ad3a85c48c15f6ff1e740230a7c8534735afbd8c801e&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


### 为什么要系统调用


例：当多个进程同时使用一种设备资源（如摄像头）需要内核决定使用顺序，否则会出现争抢摄像头的情况


### 什么功能要系统调用


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/5c6a2eff-5468-4340-8c3e-2646dc3700e6/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB46663GTYYJX%2F20251215%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20251215T041353Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHwaCXVzLXdlc3QtMiJHMEUCIBFIK3l0%2BPZMqhiy5wJenq5DjZRc%2B8kTnFUkBkBvfDhXAiEArIiYKNQXYrvX6Zvhj0r25GlHWt%2FgRuDjhUkVyxFw7bwq%2FwMIRRAAGgw2Mzc0MjMxODM4MDUiDNzunwpBzzayhft8DSrcAwDNjgF%2BERQMkt%2FhvkoTGsC%2BKKjlv7Y5y%2F5smRyo6F7g46Q3KP7d28Rb6DXkSzwF%2FKj7H40%2FnH3UB6XVIQhfk71XPcEJtkwjLJisB14hRk9ngSVihE1mOlUN%2FevwhkNV0qI3Va%2Ba0KzAzxfIFgMvOc14xexQKWsQBR%2BrLf4Iwl5kLeHnT0vIpmN0iA8HF3VqGiRkFVG9ItG8d7l3S8jFkmuBWcK5dtinHDYWKxSJzZl3X%2Be8dYTxoiZbPxfrUegxyQ1v9d%2FKJnYN3%2Be5qOxwghAx%2BsIhZrOuvMHVnketwUamHf%2FjFzypxS0%2FcJiRU%2Bc78RHrEq%2Bobp3WENqqPhlfHY9wmL79YHADWbRTR9Y4Bk0fQZ%2FSnMUEgPFS3mwZGNtOjvXs1I3YEFHF2QJgTq592z5mxZcQ2iJORxsYMexCrVbCI18wL%2FcX8GFER%2B1226C%2ByvgsoLu5VpUV6vIH4zpb6GXdZcRqGavDQG%2Bkc1Tqkqjb%2Bd27eeaSnlnqAl%2B8xMzkMe5Remd9USBc4bINyMbTMmDMbji91jfGc9RHYkxOui1z2LV%2F5JM5Dezpw9cYEiYchoDRzR5wCsd7PGMtxAI1EosviR6T17%2Ba9TKGv%2B7VgVu4YnImc0SGw%2F8j%2FYQNMNWL%2FskGOqUB7AB9JxudyT7m42snM97tGCBJme2iqp9FR%2Fdn38TP7Upo7%2F9t%2FYgma%2FdMIbYn02eacMN735OlPTkWlp7pNaxmTNnJVCo%2BK8xAJwABepubt2spSkiFkbNiYJNm%2Fl3g6l4KMovdDqyIOovWr6PULI0jKRRyWohS%2BznUyaOaedxY%2F%2FV%2FOqgfPwArrQQRHHvd%2Fge4eNg4AvGTqX5wlKBIIIyWJM02wps8&X-Amz-Signature=c5a1e3121b911a068b48275572926bb0dda122b5166e3d37aa543b948dd968d1&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


### 系统调用过程


传参指令……（用户态）→陷入指令（用户态）[引发中断]→中断处理程序（内核态）[选择相应的系统调用处理程序]→相应系统调用处理程序（由传入的参数决定）


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/81119b28-7bd7-4ca6-85ed-8a132fcab89d/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB46663GTYYJX%2F20251215%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20251215T041353Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHwaCXVzLXdlc3QtMiJHMEUCIBFIK3l0%2BPZMqhiy5wJenq5DjZRc%2B8kTnFUkBkBvfDhXAiEArIiYKNQXYrvX6Zvhj0r25GlHWt%2FgRuDjhUkVyxFw7bwq%2FwMIRRAAGgw2Mzc0MjMxODM4MDUiDNzunwpBzzayhft8DSrcAwDNjgF%2BERQMkt%2FhvkoTGsC%2BKKjlv7Y5y%2F5smRyo6F7g46Q3KP7d28Rb6DXkSzwF%2FKj7H40%2FnH3UB6XVIQhfk71XPcEJtkwjLJisB14hRk9ngSVihE1mOlUN%2FevwhkNV0qI3Va%2Ba0KzAzxfIFgMvOc14xexQKWsQBR%2BrLf4Iwl5kLeHnT0vIpmN0iA8HF3VqGiRkFVG9ItG8d7l3S8jFkmuBWcK5dtinHDYWKxSJzZl3X%2Be8dYTxoiZbPxfrUegxyQ1v9d%2FKJnYN3%2Be5qOxwghAx%2BsIhZrOuvMHVnketwUamHf%2FjFzypxS0%2FcJiRU%2Bc78RHrEq%2Bobp3WENqqPhlfHY9wmL79YHADWbRTR9Y4Bk0fQZ%2FSnMUEgPFS3mwZGNtOjvXs1I3YEFHF2QJgTq592z5mxZcQ2iJORxsYMexCrVbCI18wL%2FcX8GFER%2B1226C%2ByvgsoLu5VpUV6vIH4zpb6GXdZcRqGavDQG%2Bkc1Tqkqjb%2Bd27eeaSnlnqAl%2B8xMzkMe5Remd9USBc4bINyMbTMmDMbji91jfGc9RHYkxOui1z2LV%2F5JM5Dezpw9cYEiYchoDRzR5wCsd7PGMtxAI1EosviR6T17%2Ba9TKGv%2B7VgVu4YnImc0SGw%2F8j%2FYQNMNWL%2FskGOqUB7AB9JxudyT7m42snM97tGCBJme2iqp9FR%2Fdn38TP7Upo7%2F9t%2FYgma%2FdMIbYn02eacMN735OlPTkWlp7pNaxmTNnJVCo%2BK8xAJwABepubt2spSkiFkbNiYJNm%2Fl3g6l4KMovdDqyIOovWr6PULI0jKRRyWohS%2BznUyaOaedxY%2F%2FV%2FOqgfPwArrQQRHHvd%2Fge4eNg4AvGTqX5wlKBIIIyWJM02wps8&X-Amz-Signature=9920ad8e4eda4583e5ee2a41ce53f82b1b6b33e74b9c83483cbfccad53715b51&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


ps：陷入指令=访管指令=trap指令


### 总结


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/d00274b7-ffbf-42d2-9255-534022d080b6/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB46663GTYYJX%2F20251215%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20251215T041353Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHwaCXVzLXdlc3QtMiJHMEUCIBFIK3l0%2BPZMqhiy5wJenq5DjZRc%2B8kTnFUkBkBvfDhXAiEArIiYKNQXYrvX6Zvhj0r25GlHWt%2FgRuDjhUkVyxFw7bwq%2FwMIRRAAGgw2Mzc0MjMxODM4MDUiDNzunwpBzzayhft8DSrcAwDNjgF%2BERQMkt%2FhvkoTGsC%2BKKjlv7Y5y%2F5smRyo6F7g46Q3KP7d28Rb6DXkSzwF%2FKj7H40%2FnH3UB6XVIQhfk71XPcEJtkwjLJisB14hRk9ngSVihE1mOlUN%2FevwhkNV0qI3Va%2Ba0KzAzxfIFgMvOc14xexQKWsQBR%2BrLf4Iwl5kLeHnT0vIpmN0iA8HF3VqGiRkFVG9ItG8d7l3S8jFkmuBWcK5dtinHDYWKxSJzZl3X%2Be8dYTxoiZbPxfrUegxyQ1v9d%2FKJnYN3%2Be5qOxwghAx%2BsIhZrOuvMHVnketwUamHf%2FjFzypxS0%2FcJiRU%2Bc78RHrEq%2Bobp3WENqqPhlfHY9wmL79YHADWbRTR9Y4Bk0fQZ%2FSnMUEgPFS3mwZGNtOjvXs1I3YEFHF2QJgTq592z5mxZcQ2iJORxsYMexCrVbCI18wL%2FcX8GFER%2B1226C%2ByvgsoLu5VpUV6vIH4zpb6GXdZcRqGavDQG%2Bkc1Tqkqjb%2Bd27eeaSnlnqAl%2B8xMzkMe5Remd9USBc4bINyMbTMmDMbji91jfGc9RHYkxOui1z2LV%2F5JM5Dezpw9cYEiYchoDRzR5wCsd7PGMtxAI1EosviR6T17%2Ba9TKGv%2B7VgVu4YnImc0SGw%2F8j%2FYQNMNWL%2FskGOqUB7AB9JxudyT7m42snM97tGCBJme2iqp9FR%2Fdn38TP7Upo7%2F9t%2FYgma%2FdMIbYn02eacMN735OlPTkWlp7pNaxmTNnJVCo%2BK8xAJwABepubt2spSkiFkbNiYJNm%2Fl3g6l4KMovdDqyIOovWr6PULI0jKRRyWohS%2BznUyaOaedxY%2F%2FV%2FOqgfPwArrQQRHHvd%2Fge4eNg4AvGTqX5wlKBIIIyWJM02wps8&X-Amz-Signature=2bbfccdf9732816dbbf243111bebb774c36ef72ef2176bef5137fdb9cb91ca67&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)

