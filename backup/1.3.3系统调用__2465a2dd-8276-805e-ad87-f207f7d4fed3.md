
系统调用是提供内核服务的接口


（要想执行特权指令需要使用系统调用，而非使用越权的指令）


### 系统调用与库函数的区别


一个程序可以用汇编直接使用系统调用


也可以使用库函数间接使用系统调用（库函数直接使用系统调用）


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/a0f71c13-988a-4aca-bbc8-7fe8a14f2dfa/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB46656XZEEVV%2F20260109%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260109T041151Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjENT%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIExhoxXqcC%2FKaYWIi4aG7LRGHyYDYG8n40Kkv4pO19rEAiEA2%2BpJW3lg7yzH93%2BcC9XkwJFVMl4OJEamyhl%2BrMcEgtoqiAQInf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAAGgw2Mzc0MjMxODM4MDUiDAC1lmPDS7QnDSbxsyrcA1CDJ%2FV3WocsJCC1iua8lcrIv%2BPNUDSxY7eACH6V8je842aalBOamTR1rA3ANfFohPrC%2BC3KfvyJTGhLS%2BIDGcMybiJaqhSjFgBzY7kuWbDe%2BR89d49Ra9dNws2ri2uw3QIltGzzxqHoB7QYvkMOuvoluAgY5ZAwlbOmy37Dnlrrvs%2B%2BcLjEuMW9ZzBG5BiOMP0oUmPUOixjEPElp2c99cqgZr8vu4k8VSyIaomN%2BsfqhncY3nJAj%2FFHWa50yIXMtykL24d5A%2Bq%2FTyfWMo9z0FgdUWBuwsZFGgWCTmUQbUySPR4Ypg3v67y1VLerkKI0bFtOoWUBSecgGVUS5XS1yVKw6nHByqzyGeAW66JEQGb5C6ti7SclH46ZNShAq4IHDE3LIOKPKFPzxhV6HAemZaztmZt8iHHiBCLWK9uvQOQrCKeittBAswiqO2mpUCcJb3fGkuwjG8cIUmm7s7TT%2BHjzjq1mKNW8E7aOz25JLnfCX3%2Btko7kiD4mU653lBtHe3DlWcReMX3FaMBmAXVIPU4wUQAkf1KYiyJV3kaSxEjMkO2Ues1geIDo2R2u%2BdRY3R41m4saVrejOVkQPgyL%2FDtENE6idvcN1DqR8BXAWrkIyLVaOop2Gv6ndDuKMOPtgcsGOqUBZQCtTcexPafIHDel82utz1xT5iWtgk8n5dX1PK%2FHAKLB1OiBM5ywdV%2BYqM5O7K%2FVEmJou1Uz0kpJ9HrFJ4DGTBhn5SKQQO4%2B%2FfKXD1PFZ9JfwrKSDOB8VswCr3f0dlv7AgmY%2Fvfd41dbZYcnLdLSbWEBB96C6yzXQgdWxMEelTmeU9einoYBg1JEh2x5AmbrYVODSfEIFc65Nd6tZmkXO20n0ZZP&X-Amz-Signature=4fa50dde6d966f408f65c70de2d42d216dcdf6d0d4c1130c3042d53412a038cc&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


### 为什么要系统调用


例：当多个进程同时使用一种设备资源（如摄像头）需要内核决定使用顺序，否则会出现争抢摄像头的情况


### 什么功能要系统调用


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/5c6a2eff-5468-4340-8c3e-2646dc3700e6/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB46656XZEEVV%2F20260109%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260109T041151Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjENT%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIExhoxXqcC%2FKaYWIi4aG7LRGHyYDYG8n40Kkv4pO19rEAiEA2%2BpJW3lg7yzH93%2BcC9XkwJFVMl4OJEamyhl%2BrMcEgtoqiAQInf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAAGgw2Mzc0MjMxODM4MDUiDAC1lmPDS7QnDSbxsyrcA1CDJ%2FV3WocsJCC1iua8lcrIv%2BPNUDSxY7eACH6V8je842aalBOamTR1rA3ANfFohPrC%2BC3KfvyJTGhLS%2BIDGcMybiJaqhSjFgBzY7kuWbDe%2BR89d49Ra9dNws2ri2uw3QIltGzzxqHoB7QYvkMOuvoluAgY5ZAwlbOmy37Dnlrrvs%2B%2BcLjEuMW9ZzBG5BiOMP0oUmPUOixjEPElp2c99cqgZr8vu4k8VSyIaomN%2BsfqhncY3nJAj%2FFHWa50yIXMtykL24d5A%2Bq%2FTyfWMo9z0FgdUWBuwsZFGgWCTmUQbUySPR4Ypg3v67y1VLerkKI0bFtOoWUBSecgGVUS5XS1yVKw6nHByqzyGeAW66JEQGb5C6ti7SclH46ZNShAq4IHDE3LIOKPKFPzxhV6HAemZaztmZt8iHHiBCLWK9uvQOQrCKeittBAswiqO2mpUCcJb3fGkuwjG8cIUmm7s7TT%2BHjzjq1mKNW8E7aOz25JLnfCX3%2Btko7kiD4mU653lBtHe3DlWcReMX3FaMBmAXVIPU4wUQAkf1KYiyJV3kaSxEjMkO2Ues1geIDo2R2u%2BdRY3R41m4saVrejOVkQPgyL%2FDtENE6idvcN1DqR8BXAWrkIyLVaOop2Gv6ndDuKMOPtgcsGOqUBZQCtTcexPafIHDel82utz1xT5iWtgk8n5dX1PK%2FHAKLB1OiBM5ywdV%2BYqM5O7K%2FVEmJou1Uz0kpJ9HrFJ4DGTBhn5SKQQO4%2B%2FfKXD1PFZ9JfwrKSDOB8VswCr3f0dlv7AgmY%2Fvfd41dbZYcnLdLSbWEBB96C6yzXQgdWxMEelTmeU9einoYBg1JEh2x5AmbrYVODSfEIFc65Nd6tZmkXO20n0ZZP&X-Amz-Signature=48a88534bdcf52211106b9225bccf1d4ab61dc248bb6abf4f9ded89732edf294&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


### 系统调用过程


传参指令……（用户态）→陷入指令（用户态）[引发中断]→中断处理程序（内核态）[选择相应的系统调用处理程序]→相应系统调用处理程序（由传入的参数决定）


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/81119b28-7bd7-4ca6-85ed-8a132fcab89d/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB46656XZEEVV%2F20260109%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260109T041151Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjENT%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIExhoxXqcC%2FKaYWIi4aG7LRGHyYDYG8n40Kkv4pO19rEAiEA2%2BpJW3lg7yzH93%2BcC9XkwJFVMl4OJEamyhl%2BrMcEgtoqiAQInf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAAGgw2Mzc0MjMxODM4MDUiDAC1lmPDS7QnDSbxsyrcA1CDJ%2FV3WocsJCC1iua8lcrIv%2BPNUDSxY7eACH6V8je842aalBOamTR1rA3ANfFohPrC%2BC3KfvyJTGhLS%2BIDGcMybiJaqhSjFgBzY7kuWbDe%2BR89d49Ra9dNws2ri2uw3QIltGzzxqHoB7QYvkMOuvoluAgY5ZAwlbOmy37Dnlrrvs%2B%2BcLjEuMW9ZzBG5BiOMP0oUmPUOixjEPElp2c99cqgZr8vu4k8VSyIaomN%2BsfqhncY3nJAj%2FFHWa50yIXMtykL24d5A%2Bq%2FTyfWMo9z0FgdUWBuwsZFGgWCTmUQbUySPR4Ypg3v67y1VLerkKI0bFtOoWUBSecgGVUS5XS1yVKw6nHByqzyGeAW66JEQGb5C6ti7SclH46ZNShAq4IHDE3LIOKPKFPzxhV6HAemZaztmZt8iHHiBCLWK9uvQOQrCKeittBAswiqO2mpUCcJb3fGkuwjG8cIUmm7s7TT%2BHjzjq1mKNW8E7aOz25JLnfCX3%2Btko7kiD4mU653lBtHe3DlWcReMX3FaMBmAXVIPU4wUQAkf1KYiyJV3kaSxEjMkO2Ues1geIDo2R2u%2BdRY3R41m4saVrejOVkQPgyL%2FDtENE6idvcN1DqR8BXAWrkIyLVaOop2Gv6ndDuKMOPtgcsGOqUBZQCtTcexPafIHDel82utz1xT5iWtgk8n5dX1PK%2FHAKLB1OiBM5ywdV%2BYqM5O7K%2FVEmJou1Uz0kpJ9HrFJ4DGTBhn5SKQQO4%2B%2FfKXD1PFZ9JfwrKSDOB8VswCr3f0dlv7AgmY%2Fvfd41dbZYcnLdLSbWEBB96C6yzXQgdWxMEelTmeU9einoYBg1JEh2x5AmbrYVODSfEIFc65Nd6tZmkXO20n0ZZP&X-Amz-Signature=3dc66a26030d37c22018b33a623edc80a9479abeb9321235ac2cce5943cf9cbc&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


ps：陷入指令=访管指令=trap指令


### 总结


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/d00274b7-ffbf-42d2-9255-534022d080b6/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB46656XZEEVV%2F20260109%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260109T041151Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjENT%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIExhoxXqcC%2FKaYWIi4aG7LRGHyYDYG8n40Kkv4pO19rEAiEA2%2BpJW3lg7yzH93%2BcC9XkwJFVMl4OJEamyhl%2BrMcEgtoqiAQInf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAAGgw2Mzc0MjMxODM4MDUiDAC1lmPDS7QnDSbxsyrcA1CDJ%2FV3WocsJCC1iua8lcrIv%2BPNUDSxY7eACH6V8je842aalBOamTR1rA3ANfFohPrC%2BC3KfvyJTGhLS%2BIDGcMybiJaqhSjFgBzY7kuWbDe%2BR89d49Ra9dNws2ri2uw3QIltGzzxqHoB7QYvkMOuvoluAgY5ZAwlbOmy37Dnlrrvs%2B%2BcLjEuMW9ZzBG5BiOMP0oUmPUOixjEPElp2c99cqgZr8vu4k8VSyIaomN%2BsfqhncY3nJAj%2FFHWa50yIXMtykL24d5A%2Bq%2FTyfWMo9z0FgdUWBuwsZFGgWCTmUQbUySPR4Ypg3v67y1VLerkKI0bFtOoWUBSecgGVUS5XS1yVKw6nHByqzyGeAW66JEQGb5C6ti7SclH46ZNShAq4IHDE3LIOKPKFPzxhV6HAemZaztmZt8iHHiBCLWK9uvQOQrCKeittBAswiqO2mpUCcJb3fGkuwjG8cIUmm7s7TT%2BHjzjq1mKNW8E7aOz25JLnfCX3%2Btko7kiD4mU653lBtHe3DlWcReMX3FaMBmAXVIPU4wUQAkf1KYiyJV3kaSxEjMkO2Ues1geIDo2R2u%2BdRY3R41m4saVrejOVkQPgyL%2FDtENE6idvcN1DqR8BXAWrkIyLVaOop2Gv6ndDuKMOPtgcsGOqUBZQCtTcexPafIHDel82utz1xT5iWtgk8n5dX1PK%2FHAKLB1OiBM5ywdV%2BYqM5O7K%2FVEmJou1Uz0kpJ9HrFJ4DGTBhn5SKQQO4%2B%2FfKXD1PFZ9JfwrKSDOB8VswCr3f0dlv7AgmY%2Fvfd41dbZYcnLdLSbWEBB96C6yzXQgdWxMEelTmeU9einoYBg1JEh2x5AmbrYVODSfEIFc65Nd6tZmkXO20n0ZZP&X-Amz-Signature=c4587acd50e78026168afbe94eeb192f95b18393190b1a1a89a455a45c07371c&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)

