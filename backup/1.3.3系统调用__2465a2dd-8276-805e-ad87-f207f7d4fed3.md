
系统调用是提供内核服务的接口


（要想执行特权指令需要使用系统调用，而非使用越权的指令）


### 系统调用与库函数的区别


一个程序可以用汇编直接使用系统调用


也可以使用库函数间接使用系统调用（库函数直接使用系统调用）


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/a0f71c13-988a-4aca-bbc8-7fe8a14f2dfa/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB4666NTRUPI2%2F20260110%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260110T040703Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEOz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDR6yUWR1CyYeeWrbfxHv5H3AUZ%2Fun3ntUZjL5izZFw5gIgHNdwgfLf9ZI%2BLQk7Vu1p6UQag4pZggfkAx1CF%2BIf%2FBwqiAQItf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAAGgw2Mzc0MjMxODM4MDUiDDdlh5LR%2FIz2c3hmhyrcA%2BLY9pj47VbLWuytmzTRxcZGb4QMygUkC7iGdeNKNLkrhJkiLUNVfXP9dAN1CwJWKVb%2FUzeDby1GChoCpnZJ3%2FFGvlcAmt3MlDu3onKBRA7i1koUnohG1UYD89VeqcC2O58FPmJuu%2BIGbCu096ayua7KW22M12qe1zZEi6RTXctGMA7SFM7ikSSDpVZ28El7f24rfRnB2AGGqPkMr27nckye1gaxiQjsydW4l10pVXLmDNqUQmE9h8wvtPihWyZpJZJf52hntMP9a1EDVsDwPoqynEaKm3kT9c%2F7%2B5PA%2FLqLO50XGSNcNtsX573dyt8SNwyVPIPnO2rzdLM6bk94nGgGb3swCjOPo4fS9v5D0hKegeCpdBH4omgiJNbMu%2FpF3ns3obZMb2AhKm%2B4rrprdljYGFWcjRltL5swnZgy5Z%2F%2B%2FzOaewvpRqv2QUHbnywtMTRuKnkY6X8UeMQm%2FrNW4y4g8Cpu17si1JQp%2F6Na1sXT74RzxJyxJeU3HvRDox%2BT5qWKqJqgEdPz4Vm5E6yvij95m%2BsHF%2FKLAEzrNjVD%2Felcwk45ZcmLGInCgKi2bv68XJdj7LiWMMHd346RHZNaW6Lftlwev8aCkgqLbOPgJ7ZZo%2BKqO0ul8JjLrGzKMMidh8sGOqUB3FrnPvR2b3GXyc%2BVMd4pajR1UOi6EUzkkbNg0eu1XYy%2FiWhQKONJSUVVtg954cnN0PkpTQQDHtYHVL8DFbrhOPoOVpcq%2FUH0HHSHu0bbxlTY5bAAsxY7N56O1QVBA%2F3vtEyS67U8EmClxocPf%2Bte37MlXmsPYe8hFxt8Cw91jXkI19xOB0teINpmSc1iKlIwpXyU9EZGZtgiy83NWXiLedaEgrOY&X-Amz-Signature=1859085421132aeaf55e83bfa2d95f5207ccf21fa439afeac170c457b428b62c&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


### 为什么要系统调用


例：当多个进程同时使用一种设备资源（如摄像头）需要内核决定使用顺序，否则会出现争抢摄像头的情况


### 什么功能要系统调用


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/5c6a2eff-5468-4340-8c3e-2646dc3700e6/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB4666NTRUPI2%2F20260110%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260110T040703Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEOz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDR6yUWR1CyYeeWrbfxHv5H3AUZ%2Fun3ntUZjL5izZFw5gIgHNdwgfLf9ZI%2BLQk7Vu1p6UQag4pZggfkAx1CF%2BIf%2FBwqiAQItf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAAGgw2Mzc0MjMxODM4MDUiDDdlh5LR%2FIz2c3hmhyrcA%2BLY9pj47VbLWuytmzTRxcZGb4QMygUkC7iGdeNKNLkrhJkiLUNVfXP9dAN1CwJWKVb%2FUzeDby1GChoCpnZJ3%2FFGvlcAmt3MlDu3onKBRA7i1koUnohG1UYD89VeqcC2O58FPmJuu%2BIGbCu096ayua7KW22M12qe1zZEi6RTXctGMA7SFM7ikSSDpVZ28El7f24rfRnB2AGGqPkMr27nckye1gaxiQjsydW4l10pVXLmDNqUQmE9h8wvtPihWyZpJZJf52hntMP9a1EDVsDwPoqynEaKm3kT9c%2F7%2B5PA%2FLqLO50XGSNcNtsX573dyt8SNwyVPIPnO2rzdLM6bk94nGgGb3swCjOPo4fS9v5D0hKegeCpdBH4omgiJNbMu%2FpF3ns3obZMb2AhKm%2B4rrprdljYGFWcjRltL5swnZgy5Z%2F%2B%2FzOaewvpRqv2QUHbnywtMTRuKnkY6X8UeMQm%2FrNW4y4g8Cpu17si1JQp%2F6Na1sXT74RzxJyxJeU3HvRDox%2BT5qWKqJqgEdPz4Vm5E6yvij95m%2BsHF%2FKLAEzrNjVD%2Felcwk45ZcmLGInCgKi2bv68XJdj7LiWMMHd346RHZNaW6Lftlwev8aCkgqLbOPgJ7ZZo%2BKqO0ul8JjLrGzKMMidh8sGOqUB3FrnPvR2b3GXyc%2BVMd4pajR1UOi6EUzkkbNg0eu1XYy%2FiWhQKONJSUVVtg954cnN0PkpTQQDHtYHVL8DFbrhOPoOVpcq%2FUH0HHSHu0bbxlTY5bAAsxY7N56O1QVBA%2F3vtEyS67U8EmClxocPf%2Bte37MlXmsPYe8hFxt8Cw91jXkI19xOB0teINpmSc1iKlIwpXyU9EZGZtgiy83NWXiLedaEgrOY&X-Amz-Signature=a35677d81583534a55b65f4956fd8d0efdb53b6f1cbacb9d9307e730866e4107&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


### 系统调用过程


传参指令……（用户态）→陷入指令（用户态）[引发中断]→中断处理程序（内核态）[选择相应的系统调用处理程序]→相应系统调用处理程序（由传入的参数决定）


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/81119b28-7bd7-4ca6-85ed-8a132fcab89d/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB4666NTRUPI2%2F20260110%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260110T040703Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEOz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDR6yUWR1CyYeeWrbfxHv5H3AUZ%2Fun3ntUZjL5izZFw5gIgHNdwgfLf9ZI%2BLQk7Vu1p6UQag4pZggfkAx1CF%2BIf%2FBwqiAQItf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAAGgw2Mzc0MjMxODM4MDUiDDdlh5LR%2FIz2c3hmhyrcA%2BLY9pj47VbLWuytmzTRxcZGb4QMygUkC7iGdeNKNLkrhJkiLUNVfXP9dAN1CwJWKVb%2FUzeDby1GChoCpnZJ3%2FFGvlcAmt3MlDu3onKBRA7i1koUnohG1UYD89VeqcC2O58FPmJuu%2BIGbCu096ayua7KW22M12qe1zZEi6RTXctGMA7SFM7ikSSDpVZ28El7f24rfRnB2AGGqPkMr27nckye1gaxiQjsydW4l10pVXLmDNqUQmE9h8wvtPihWyZpJZJf52hntMP9a1EDVsDwPoqynEaKm3kT9c%2F7%2B5PA%2FLqLO50XGSNcNtsX573dyt8SNwyVPIPnO2rzdLM6bk94nGgGb3swCjOPo4fS9v5D0hKegeCpdBH4omgiJNbMu%2FpF3ns3obZMb2AhKm%2B4rrprdljYGFWcjRltL5swnZgy5Z%2F%2B%2FzOaewvpRqv2QUHbnywtMTRuKnkY6X8UeMQm%2FrNW4y4g8Cpu17si1JQp%2F6Na1sXT74RzxJyxJeU3HvRDox%2BT5qWKqJqgEdPz4Vm5E6yvij95m%2BsHF%2FKLAEzrNjVD%2Felcwk45ZcmLGInCgKi2bv68XJdj7LiWMMHd346RHZNaW6Lftlwev8aCkgqLbOPgJ7ZZo%2BKqO0ul8JjLrGzKMMidh8sGOqUB3FrnPvR2b3GXyc%2BVMd4pajR1UOi6EUzkkbNg0eu1XYy%2FiWhQKONJSUVVtg954cnN0PkpTQQDHtYHVL8DFbrhOPoOVpcq%2FUH0HHSHu0bbxlTY5bAAsxY7N56O1QVBA%2F3vtEyS67U8EmClxocPf%2Bte37MlXmsPYe8hFxt8Cw91jXkI19xOB0teINpmSc1iKlIwpXyU9EZGZtgiy83NWXiLedaEgrOY&X-Amz-Signature=15d4cd4f5bf957152a785485f38df59cb76950e9a51fe85ed74018f004b18899&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


ps：陷入指令=访管指令=trap指令


### 总结


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/d00274b7-ffbf-42d2-9255-534022d080b6/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB4666NTRUPI2%2F20260110%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260110T040703Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEOz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDR6yUWR1CyYeeWrbfxHv5H3AUZ%2Fun3ntUZjL5izZFw5gIgHNdwgfLf9ZI%2BLQk7Vu1p6UQag4pZggfkAx1CF%2BIf%2FBwqiAQItf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAAGgw2Mzc0MjMxODM4MDUiDDdlh5LR%2FIz2c3hmhyrcA%2BLY9pj47VbLWuytmzTRxcZGb4QMygUkC7iGdeNKNLkrhJkiLUNVfXP9dAN1CwJWKVb%2FUzeDby1GChoCpnZJ3%2FFGvlcAmt3MlDu3onKBRA7i1koUnohG1UYD89VeqcC2O58FPmJuu%2BIGbCu096ayua7KW22M12qe1zZEi6RTXctGMA7SFM7ikSSDpVZ28El7f24rfRnB2AGGqPkMr27nckye1gaxiQjsydW4l10pVXLmDNqUQmE9h8wvtPihWyZpJZJf52hntMP9a1EDVsDwPoqynEaKm3kT9c%2F7%2B5PA%2FLqLO50XGSNcNtsX573dyt8SNwyVPIPnO2rzdLM6bk94nGgGb3swCjOPo4fS9v5D0hKegeCpdBH4omgiJNbMu%2FpF3ns3obZMb2AhKm%2B4rrprdljYGFWcjRltL5swnZgy5Z%2F%2B%2FzOaewvpRqv2QUHbnywtMTRuKnkY6X8UeMQm%2FrNW4y4g8Cpu17si1JQp%2F6Na1sXT74RzxJyxJeU3HvRDox%2BT5qWKqJqgEdPz4Vm5E6yvij95m%2BsHF%2FKLAEzrNjVD%2Felcwk45ZcmLGInCgKi2bv68XJdj7LiWMMHd346RHZNaW6Lftlwev8aCkgqLbOPgJ7ZZo%2BKqO0ul8JjLrGzKMMidh8sGOqUB3FrnPvR2b3GXyc%2BVMd4pajR1UOi6EUzkkbNg0eu1XYy%2FiWhQKONJSUVVtg954cnN0PkpTQQDHtYHVL8DFbrhOPoOVpcq%2FUH0HHSHu0bbxlTY5bAAsxY7N56O1QVBA%2F3vtEyS67U8EmClxocPf%2Bte37MlXmsPYe8hFxt8Cw91jXkI19xOB0teINpmSc1iKlIwpXyU9EZGZtgiy83NWXiLedaEgrOY&X-Amz-Signature=60f9c592934153c7a5f8b972bcc3bdc691b17f617d3c55b85cfa6fabef6f9b25&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)

