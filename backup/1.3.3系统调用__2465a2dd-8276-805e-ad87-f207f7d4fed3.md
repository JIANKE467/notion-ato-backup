
系统调用是提供内核服务的接口


（要想执行特权指令需要使用系统调用，而非使用越权的指令）


### 系统调用与库函数的区别


一个程序可以用汇编直接使用系统调用


也可以使用库函数间接使用系统调用（库函数直接使用系统调用）


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/a0f71c13-988a-4aca-bbc8-7fe8a14f2dfa/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB466RT4D6V26%2F20251224%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20251224T040839Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEFQaCXVzLXdlc3QtMiJHMEUCIAo2Y5FoPoKf7Ihk9pABO0ldXAiZIC%2BDyiVfZiobOvILAiEAm6nuhzh5VaTVw9sySIWgBQ%2FyZvO0ZR6YafKCgqD0XZ4q%2FwMIHRAAGgw2Mzc0MjMxODM4MDUiDFT9HAdjKUV800G4HCrcA5Ay56SlmDFNByTbXkAF6QRN9PpaGiryRVL80flO8N4tmP%2BBGN%2B%2FdA7Lv4PiEB%2FJnchN3mFKuKPv%2BOHpTGoUl2KmBVKCcxJEem7hh64zWm7s7rDFNC4u44PyoItsdQyi5lpn80964Quk%2FQtft%2FAAO9%2FV2lVCb1Aga4BJQmszdq5q63X8oNI2%2BCZ3quKB9K3VLFOcTM5gL4cTuHtTB%2BZO8iiIOKb7bq%2BXfyncPX7r2btozUpV4nlEb9txLqA%2F0%2B690CmSg0xwiJ0COn4luOiXtUPtaPT8YWJlaMgtEzGcPnW7v7x%2BLFyVmyo9bGHK6eLS%2B7BEDnnZf7k1suv0o2UDsN%2BnqlK8uTYIlg%2Fx7TVrYrn7jlrspzGEOYnkiScJBKYFblIV%2BS7LaTm0ALv0ktxVq81V8jW2NAVvTXaarK%2F797p6zYx5HakZ%2FRB0tWwIIt5SXhUO9DJHoxe%2FVhmyTxbSAJBiMdF8gJi5XynSLx5oaBTiWZy6S%2FckVMjefITNr%2FCnlXiEnY7UY7%2FS%2BwxZVadfkLWLpWEAu48dNhfar3ejZSA8SON1Rt4IPi26fDKj3qtprIDD8nekA9zdtugpbX0jdfH8Htyp%2BQ0CK64qLjFpQ33gR5fEeaq2rtxAFkmCMP3LrcoGOqUB1B%2FKaZftqjfoyRsdoq8%2FD6423rmt%2Be4M6OaL1WOlrOI90c8KWy3rFAHXR850c2jSEDpu%2BAxLavSIUErqOrI%2FZ8AylBbAiakfrCU%2FGPQjPYljujdHWXrN1EXEox%2FdvE6f0T1nShJ548XkdHJ8ds404W22JLy0hkIZsqzDnagWE0e9RaVZC%2BeIt%2BZ2l9wXMd05NeajIS%2FnL0xKDhcS58qeExI5nc76&X-Amz-Signature=df851d6041ea49e85c599b393f962526b6c28dd4d0442e0f0503adc0810d0cbc&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


### 为什么要系统调用


例：当多个进程同时使用一种设备资源（如摄像头）需要内核决定使用顺序，否则会出现争抢摄像头的情况


### 什么功能要系统调用


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/5c6a2eff-5468-4340-8c3e-2646dc3700e6/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB466RT4D6V26%2F20251224%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20251224T040839Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEFQaCXVzLXdlc3QtMiJHMEUCIAo2Y5FoPoKf7Ihk9pABO0ldXAiZIC%2BDyiVfZiobOvILAiEAm6nuhzh5VaTVw9sySIWgBQ%2FyZvO0ZR6YafKCgqD0XZ4q%2FwMIHRAAGgw2Mzc0MjMxODM4MDUiDFT9HAdjKUV800G4HCrcA5Ay56SlmDFNByTbXkAF6QRN9PpaGiryRVL80flO8N4tmP%2BBGN%2B%2FdA7Lv4PiEB%2FJnchN3mFKuKPv%2BOHpTGoUl2KmBVKCcxJEem7hh64zWm7s7rDFNC4u44PyoItsdQyi5lpn80964Quk%2FQtft%2FAAO9%2FV2lVCb1Aga4BJQmszdq5q63X8oNI2%2BCZ3quKB9K3VLFOcTM5gL4cTuHtTB%2BZO8iiIOKb7bq%2BXfyncPX7r2btozUpV4nlEb9txLqA%2F0%2B690CmSg0xwiJ0COn4luOiXtUPtaPT8YWJlaMgtEzGcPnW7v7x%2BLFyVmyo9bGHK6eLS%2B7BEDnnZf7k1suv0o2UDsN%2BnqlK8uTYIlg%2Fx7TVrYrn7jlrspzGEOYnkiScJBKYFblIV%2BS7LaTm0ALv0ktxVq81V8jW2NAVvTXaarK%2F797p6zYx5HakZ%2FRB0tWwIIt5SXhUO9DJHoxe%2FVhmyTxbSAJBiMdF8gJi5XynSLx5oaBTiWZy6S%2FckVMjefITNr%2FCnlXiEnY7UY7%2FS%2BwxZVadfkLWLpWEAu48dNhfar3ejZSA8SON1Rt4IPi26fDKj3qtprIDD8nekA9zdtugpbX0jdfH8Htyp%2BQ0CK64qLjFpQ33gR5fEeaq2rtxAFkmCMP3LrcoGOqUB1B%2FKaZftqjfoyRsdoq8%2FD6423rmt%2Be4M6OaL1WOlrOI90c8KWy3rFAHXR850c2jSEDpu%2BAxLavSIUErqOrI%2FZ8AylBbAiakfrCU%2FGPQjPYljujdHWXrN1EXEox%2FdvE6f0T1nShJ548XkdHJ8ds404W22JLy0hkIZsqzDnagWE0e9RaVZC%2BeIt%2BZ2l9wXMd05NeajIS%2FnL0xKDhcS58qeExI5nc76&X-Amz-Signature=63d8115b02f4919dae6b8d058ad56f390976378cc49d0dd4f8c1166e31c3cedc&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


### 系统调用过程


传参指令……（用户态）→陷入指令（用户态）[引发中断]→中断处理程序（内核态）[选择相应的系统调用处理程序]→相应系统调用处理程序（由传入的参数决定）


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/81119b28-7bd7-4ca6-85ed-8a132fcab89d/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB466RT4D6V26%2F20251224%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20251224T040839Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEFQaCXVzLXdlc3QtMiJHMEUCIAo2Y5FoPoKf7Ihk9pABO0ldXAiZIC%2BDyiVfZiobOvILAiEAm6nuhzh5VaTVw9sySIWgBQ%2FyZvO0ZR6YafKCgqD0XZ4q%2FwMIHRAAGgw2Mzc0MjMxODM4MDUiDFT9HAdjKUV800G4HCrcA5Ay56SlmDFNByTbXkAF6QRN9PpaGiryRVL80flO8N4tmP%2BBGN%2B%2FdA7Lv4PiEB%2FJnchN3mFKuKPv%2BOHpTGoUl2KmBVKCcxJEem7hh64zWm7s7rDFNC4u44PyoItsdQyi5lpn80964Quk%2FQtft%2FAAO9%2FV2lVCb1Aga4BJQmszdq5q63X8oNI2%2BCZ3quKB9K3VLFOcTM5gL4cTuHtTB%2BZO8iiIOKb7bq%2BXfyncPX7r2btozUpV4nlEb9txLqA%2F0%2B690CmSg0xwiJ0COn4luOiXtUPtaPT8YWJlaMgtEzGcPnW7v7x%2BLFyVmyo9bGHK6eLS%2B7BEDnnZf7k1suv0o2UDsN%2BnqlK8uTYIlg%2Fx7TVrYrn7jlrspzGEOYnkiScJBKYFblIV%2BS7LaTm0ALv0ktxVq81V8jW2NAVvTXaarK%2F797p6zYx5HakZ%2FRB0tWwIIt5SXhUO9DJHoxe%2FVhmyTxbSAJBiMdF8gJi5XynSLx5oaBTiWZy6S%2FckVMjefITNr%2FCnlXiEnY7UY7%2FS%2BwxZVadfkLWLpWEAu48dNhfar3ejZSA8SON1Rt4IPi26fDKj3qtprIDD8nekA9zdtugpbX0jdfH8Htyp%2BQ0CK64qLjFpQ33gR5fEeaq2rtxAFkmCMP3LrcoGOqUB1B%2FKaZftqjfoyRsdoq8%2FD6423rmt%2Be4M6OaL1WOlrOI90c8KWy3rFAHXR850c2jSEDpu%2BAxLavSIUErqOrI%2FZ8AylBbAiakfrCU%2FGPQjPYljujdHWXrN1EXEox%2FdvE6f0T1nShJ548XkdHJ8ds404W22JLy0hkIZsqzDnagWE0e9RaVZC%2BeIt%2BZ2l9wXMd05NeajIS%2FnL0xKDhcS58qeExI5nc76&X-Amz-Signature=a77926c173ef457c4c59889e2e3fa39052045bbda2a8cb86f8e1403b8c2f3363&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


ps：陷入指令=访管指令=trap指令


### 总结


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/d00274b7-ffbf-42d2-9255-534022d080b6/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB466RT4D6V26%2F20251224%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20251224T040839Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEFQaCXVzLXdlc3QtMiJHMEUCIAo2Y5FoPoKf7Ihk9pABO0ldXAiZIC%2BDyiVfZiobOvILAiEAm6nuhzh5VaTVw9sySIWgBQ%2FyZvO0ZR6YafKCgqD0XZ4q%2FwMIHRAAGgw2Mzc0MjMxODM4MDUiDFT9HAdjKUV800G4HCrcA5Ay56SlmDFNByTbXkAF6QRN9PpaGiryRVL80flO8N4tmP%2BBGN%2B%2FdA7Lv4PiEB%2FJnchN3mFKuKPv%2BOHpTGoUl2KmBVKCcxJEem7hh64zWm7s7rDFNC4u44PyoItsdQyi5lpn80964Quk%2FQtft%2FAAO9%2FV2lVCb1Aga4BJQmszdq5q63X8oNI2%2BCZ3quKB9K3VLFOcTM5gL4cTuHtTB%2BZO8iiIOKb7bq%2BXfyncPX7r2btozUpV4nlEb9txLqA%2F0%2B690CmSg0xwiJ0COn4luOiXtUPtaPT8YWJlaMgtEzGcPnW7v7x%2BLFyVmyo9bGHK6eLS%2B7BEDnnZf7k1suv0o2UDsN%2BnqlK8uTYIlg%2Fx7TVrYrn7jlrspzGEOYnkiScJBKYFblIV%2BS7LaTm0ALv0ktxVq81V8jW2NAVvTXaarK%2F797p6zYx5HakZ%2FRB0tWwIIt5SXhUO9DJHoxe%2FVhmyTxbSAJBiMdF8gJi5XynSLx5oaBTiWZy6S%2FckVMjefITNr%2FCnlXiEnY7UY7%2FS%2BwxZVadfkLWLpWEAu48dNhfar3ejZSA8SON1Rt4IPi26fDKj3qtprIDD8nekA9zdtugpbX0jdfH8Htyp%2BQ0CK64qLjFpQ33gR5fEeaq2rtxAFkmCMP3LrcoGOqUB1B%2FKaZftqjfoyRsdoq8%2FD6423rmt%2Be4M6OaL1WOlrOI90c8KWy3rFAHXR850c2jSEDpu%2BAxLavSIUErqOrI%2FZ8AylBbAiakfrCU%2FGPQjPYljujdHWXrN1EXEox%2FdvE6f0T1nShJ548XkdHJ8ds404W22JLy0hkIZsqzDnagWE0e9RaVZC%2BeIt%2BZ2l9wXMd05NeajIS%2FnL0xKDhcS58qeExI5nc76&X-Amz-Signature=e2f26519e70d8bbd7a6d67d1bc16d3f3daa27f56e2c87cf9ba99379b526ddabd&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)

