
系统调用是提供内核服务的接口


（要想执行特权指令需要使用系统调用，而非使用越权的指令）


### 系统调用与库函数的区别


一个程序可以用汇编直接使用系统调用


也可以使用库函数间接使用系统调用（库函数直接使用系统调用）


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/a0f71c13-988a-4aca-bbc8-7fe8a14f2dfa/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB4663Z7ZTLUV%2F20251208%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20251208T040415Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjENP%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCqRRdemRDT%2FrlbqnYJ%2FTybSBunCqUtI21qANHBjyzbpAIhAMmCW02fnpof3%2BYZF4epZzsflgNfaFvQg19OvXKZTDJHKogECJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQABoMNjM3NDIzMTgzODA1IgxGxbf%2Fj%2FUIRk8IV5Iq3AP5GSgLS%2FZSMM7BcQUmFeDNbYa4tumsw2vl5CkaR0HqGJpNE824Wp1PCE4EdhUa2C1fg7hyu3o%2FnBRQu1fMBYtZ3vSyZBfzfkrE0XLLRwc24dMRxiG%2BdgX%2Fp2mFvUt3JtLAj5tsQ%2BidzivmAyqAauK5wrVKwJGbBsWhdr%2FNJ%2FV1iLvukrXeU5PPzF2gOUP0c2wvgltpRUuP1cLDrUB65HU9DXvTg08tgAhvOtXrgKjRnl0CN2lLs%2B70dILft9cIz7KBepTikIPC%2Bi2EBX%2FOz4%2FO9%2FD5bwTSUmiLlmA274i%2FRksTWVF7pDtVCTCKRVyWXkN0tdWaP%2BNZ9x6kLzXrwJtSZQgc5%2FFp6%2BdLUHIAVgEFcWTzl0h4yCgTCc8Yp7d7tFA%2F%2FA8apgma%2BZx%2FguoNLoke7o5PCrwV1yz6QJbHaLhwO1cDg28nyYAVNvz2HmjNdCnl%2BJc9NKePr%2FHWVaxJ24uXA7iqCLxRyHe0P8gdaPML6AQUfltVr1fd60HjW%2F6wGRrGm0wMi%2FT2jZl%2FKLLAcP2q8kg4fA7eTIMaAzlvC2t4p1eWRrZkGv4gh%2B1BWEQDJJTZ8nzNT8KIGtDwAxKbPyD1e3MplMkXSIw%2FMNL5TO2PaR1XJsJUvPhV1SCn%2BDCTg9nJBjqkASA3RK7G2CfFoD%2FgQ45gCfsst%2FpsSd64KGm2Dcc%2B4PooHJ8QVywHX2Yavvn%2BgYxAykz1%2B1fxhOrkY9n5LlO8NLCTcflGoJdkAARXMqidttutBmWGDH8p%2FHL1gjZ71iYN90lz%2BMGktFsO3VdsReyllssbYAQRdx8SyUhhsTqncCoFZm9N0bkXurc1ayBBWT30DEHjSoql5wtG%2FuY%2FcrReeYgPC9uN&X-Amz-Signature=ea9a1e32697efd9f5338ac6743b85aef27ff1c02523e6a300fee33a6412e8f58&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


### 为什么要系统调用


例：当多个进程同时使用一种设备资源（如摄像头）需要内核决定使用顺序，否则会出现争抢摄像头的情况


### 什么功能要系统调用


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/5c6a2eff-5468-4340-8c3e-2646dc3700e6/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB4663Z7ZTLUV%2F20251208%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20251208T040415Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjENP%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCqRRdemRDT%2FrlbqnYJ%2FTybSBunCqUtI21qANHBjyzbpAIhAMmCW02fnpof3%2BYZF4epZzsflgNfaFvQg19OvXKZTDJHKogECJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQABoMNjM3NDIzMTgzODA1IgxGxbf%2Fj%2FUIRk8IV5Iq3AP5GSgLS%2FZSMM7BcQUmFeDNbYa4tumsw2vl5CkaR0HqGJpNE824Wp1PCE4EdhUa2C1fg7hyu3o%2FnBRQu1fMBYtZ3vSyZBfzfkrE0XLLRwc24dMRxiG%2BdgX%2Fp2mFvUt3JtLAj5tsQ%2BidzivmAyqAauK5wrVKwJGbBsWhdr%2FNJ%2FV1iLvukrXeU5PPzF2gOUP0c2wvgltpRUuP1cLDrUB65HU9DXvTg08tgAhvOtXrgKjRnl0CN2lLs%2B70dILft9cIz7KBepTikIPC%2Bi2EBX%2FOz4%2FO9%2FD5bwTSUmiLlmA274i%2FRksTWVF7pDtVCTCKRVyWXkN0tdWaP%2BNZ9x6kLzXrwJtSZQgc5%2FFp6%2BdLUHIAVgEFcWTzl0h4yCgTCc8Yp7d7tFA%2F%2FA8apgma%2BZx%2FguoNLoke7o5PCrwV1yz6QJbHaLhwO1cDg28nyYAVNvz2HmjNdCnl%2BJc9NKePr%2FHWVaxJ24uXA7iqCLxRyHe0P8gdaPML6AQUfltVr1fd60HjW%2F6wGRrGm0wMi%2FT2jZl%2FKLLAcP2q8kg4fA7eTIMaAzlvC2t4p1eWRrZkGv4gh%2B1BWEQDJJTZ8nzNT8KIGtDwAxKbPyD1e3MplMkXSIw%2FMNL5TO2PaR1XJsJUvPhV1SCn%2BDCTg9nJBjqkASA3RK7G2CfFoD%2FgQ45gCfsst%2FpsSd64KGm2Dcc%2B4PooHJ8QVywHX2Yavvn%2BgYxAykz1%2B1fxhOrkY9n5LlO8NLCTcflGoJdkAARXMqidttutBmWGDH8p%2FHL1gjZ71iYN90lz%2BMGktFsO3VdsReyllssbYAQRdx8SyUhhsTqncCoFZm9N0bkXurc1ayBBWT30DEHjSoql5wtG%2FuY%2FcrReeYgPC9uN&X-Amz-Signature=23d010ed2566cc1614621ab27184ecae2547d7c74039111d32fd97c0716b530d&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


### 系统调用过程


传参指令……（用户态）→陷入指令（用户态）[引发中断]→中断处理程序（内核态）[选择相应的系统调用处理程序]→相应系统调用处理程序（由传入的参数决定）


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/81119b28-7bd7-4ca6-85ed-8a132fcab89d/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB4663Z7ZTLUV%2F20251208%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20251208T040415Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjENP%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCqRRdemRDT%2FrlbqnYJ%2FTybSBunCqUtI21qANHBjyzbpAIhAMmCW02fnpof3%2BYZF4epZzsflgNfaFvQg19OvXKZTDJHKogECJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQABoMNjM3NDIzMTgzODA1IgxGxbf%2Fj%2FUIRk8IV5Iq3AP5GSgLS%2FZSMM7BcQUmFeDNbYa4tumsw2vl5CkaR0HqGJpNE824Wp1PCE4EdhUa2C1fg7hyu3o%2FnBRQu1fMBYtZ3vSyZBfzfkrE0XLLRwc24dMRxiG%2BdgX%2Fp2mFvUt3JtLAj5tsQ%2BidzivmAyqAauK5wrVKwJGbBsWhdr%2FNJ%2FV1iLvukrXeU5PPzF2gOUP0c2wvgltpRUuP1cLDrUB65HU9DXvTg08tgAhvOtXrgKjRnl0CN2lLs%2B70dILft9cIz7KBepTikIPC%2Bi2EBX%2FOz4%2FO9%2FD5bwTSUmiLlmA274i%2FRksTWVF7pDtVCTCKRVyWXkN0tdWaP%2BNZ9x6kLzXrwJtSZQgc5%2FFp6%2BdLUHIAVgEFcWTzl0h4yCgTCc8Yp7d7tFA%2F%2FA8apgma%2BZx%2FguoNLoke7o5PCrwV1yz6QJbHaLhwO1cDg28nyYAVNvz2HmjNdCnl%2BJc9NKePr%2FHWVaxJ24uXA7iqCLxRyHe0P8gdaPML6AQUfltVr1fd60HjW%2F6wGRrGm0wMi%2FT2jZl%2FKLLAcP2q8kg4fA7eTIMaAzlvC2t4p1eWRrZkGv4gh%2B1BWEQDJJTZ8nzNT8KIGtDwAxKbPyD1e3MplMkXSIw%2FMNL5TO2PaR1XJsJUvPhV1SCn%2BDCTg9nJBjqkASA3RK7G2CfFoD%2FgQ45gCfsst%2FpsSd64KGm2Dcc%2B4PooHJ8QVywHX2Yavvn%2BgYxAykz1%2B1fxhOrkY9n5LlO8NLCTcflGoJdkAARXMqidttutBmWGDH8p%2FHL1gjZ71iYN90lz%2BMGktFsO3VdsReyllssbYAQRdx8SyUhhsTqncCoFZm9N0bkXurc1ayBBWT30DEHjSoql5wtG%2FuY%2FcrReeYgPC9uN&X-Amz-Signature=13bb7f130cf58e990c7d8123d1a389ee81b2b3f847909554eeac34978a5623e1&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


ps：陷入指令=访管指令=trap指令


### 总结


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/d00274b7-ffbf-42d2-9255-534022d080b6/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB4663Z7ZTLUV%2F20251208%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20251208T040415Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjENP%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCqRRdemRDT%2FrlbqnYJ%2FTybSBunCqUtI21qANHBjyzbpAIhAMmCW02fnpof3%2BYZF4epZzsflgNfaFvQg19OvXKZTDJHKogECJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQABoMNjM3NDIzMTgzODA1IgxGxbf%2Fj%2FUIRk8IV5Iq3AP5GSgLS%2FZSMM7BcQUmFeDNbYa4tumsw2vl5CkaR0HqGJpNE824Wp1PCE4EdhUa2C1fg7hyu3o%2FnBRQu1fMBYtZ3vSyZBfzfkrE0XLLRwc24dMRxiG%2BdgX%2Fp2mFvUt3JtLAj5tsQ%2BidzivmAyqAauK5wrVKwJGbBsWhdr%2FNJ%2FV1iLvukrXeU5PPzF2gOUP0c2wvgltpRUuP1cLDrUB65HU9DXvTg08tgAhvOtXrgKjRnl0CN2lLs%2B70dILft9cIz7KBepTikIPC%2Bi2EBX%2FOz4%2FO9%2FD5bwTSUmiLlmA274i%2FRksTWVF7pDtVCTCKRVyWXkN0tdWaP%2BNZ9x6kLzXrwJtSZQgc5%2FFp6%2BdLUHIAVgEFcWTzl0h4yCgTCc8Yp7d7tFA%2F%2FA8apgma%2BZx%2FguoNLoke7o5PCrwV1yz6QJbHaLhwO1cDg28nyYAVNvz2HmjNdCnl%2BJc9NKePr%2FHWVaxJ24uXA7iqCLxRyHe0P8gdaPML6AQUfltVr1fd60HjW%2F6wGRrGm0wMi%2FT2jZl%2FKLLAcP2q8kg4fA7eTIMaAzlvC2t4p1eWRrZkGv4gh%2B1BWEQDJJTZ8nzNT8KIGtDwAxKbPyD1e3MplMkXSIw%2FMNL5TO2PaR1XJsJUvPhV1SCn%2BDCTg9nJBjqkASA3RK7G2CfFoD%2FgQ45gCfsst%2FpsSd64KGm2Dcc%2B4PooHJ8QVywHX2Yavvn%2BgYxAykz1%2B1fxhOrkY9n5LlO8NLCTcflGoJdkAARXMqidttutBmWGDH8p%2FHL1gjZ71iYN90lz%2BMGktFsO3VdsReyllssbYAQRdx8SyUhhsTqncCoFZm9N0bkXurc1ayBBWT30DEHjSoql5wtG%2FuY%2FcrReeYgPC9uN&X-Amz-Signature=78002e02eb0030c3bca8a430b1b90d120f30d57923f7af6330a5387ba5dd6925&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)

