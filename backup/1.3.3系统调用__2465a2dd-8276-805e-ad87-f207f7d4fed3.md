
系统调用是提供内核服务的接口


（要想执行特权指令需要使用系统调用，而非使用越权的指令）


### 系统调用与库函数的区别


一个程序可以用汇编直接使用系统调用


也可以使用库函数间接使用系统调用（库函数直接使用系统调用）


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/a0f71c13-988a-4aca-bbc8-7fe8a14f2dfa/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB4662OYUWS2W%2F20251225%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20251225T041006Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEGwaCXVzLXdlc3QtMiJGMEQCIFlH44ZuWOdNDjiKvwLwDOGx2Snek0LQeADj2OflUIifAiAXvPJE1pyXzY0Gz88B9WN3BQvbZ7gIJ1SlQD4U0I1u8ir%2FAwg1EAAaDDYzNzQyMzE4MzgwNSIMbt1GqczMSFg%2F0dj3KtwDxcgEJRT3R6%2FXgNYBGW8OUZJSq%2F8h73K%2Bfrq8MWn2Rn77xvNsq9kIWh3HGROLyhU7fh%2FLQ46SPWjJApzGxp0dBSHQfiOaceSTB%2BOhyQvrqQfCRYpXZxbiC2WE%2ByZAn92%2BYCTbsU1v9A7fE2SOKIfZi%2BafIOe4BfqmaUwegLBGeZMhUpJJvwsVJ4jvJRlma0s0sHgJEEOwwXeOZFnl2XNOCYqFyOrwAZ6HQYSx7AFJzYQrCCACxpQKiL0mdIg%2B5J2iyxjQUi9unZeUkSAMRb1yzNwSJOxWDl9c8YYR0STLJmwp00zdPkRR5ms2N52xtAJUFdoDOHQfiT0EB8QV0J4ugk27ytYfOUF6xBdeDYYZuCPxKeFac0kI6FeoJXb2%2B7qJUpw2mVna5AyxcLCt8Bm2mPC3cv0LVItKz99DvvuTIFvmsknHLi%2BQMi7wsZ6lIrI1ckdNQhqLQqHmZhcCS%2FIpKikrhTfrhZuQSprRuqB%2B%2B0hyrEcns8K63LbRgkHGpsPly%2B43kbFkLaxdzf451zSG5Kx5s%2FPedCAazWr%2FjSHq0h1qgdhgEiZcdBvk107WDvxuzqxTNNWhGrSlfOO0Ra45cAKwjOEqE4NDYmcFCkcOkJnJGVt2kaUO4K4Rvv8wvu%2ByygY6pgGNFlk8xz1lXqr5tiwuBwDfIlN77fWZbvoE8Rss1htxsW68GMIKUJEO1nwfrk7ufMIEj1Mwiu0f4KBrHdlS%2BulpehgJL6iDzwkUpkIa48MZepfUyiw8xNBJ9DsDbfQ2glBlnRdNEgBDYybJFNLO7VOWp2bUIKDxKv4ib9YrOtfEMonaYu9F8G6SGYazE%2B4Isi6igo4e8j6Lfqxtu0NjPZ2L5rPmzy5d&X-Amz-Signature=523bcd0bf6f20ee06c357a8ec59d6977df9d530db6a92f71aab49a6d18a3d17a&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


### 为什么要系统调用


例：当多个进程同时使用一种设备资源（如摄像头）需要内核决定使用顺序，否则会出现争抢摄像头的情况


### 什么功能要系统调用


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/5c6a2eff-5468-4340-8c3e-2646dc3700e6/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB4662OYUWS2W%2F20251225%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20251225T041006Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEGwaCXVzLXdlc3QtMiJGMEQCIFlH44ZuWOdNDjiKvwLwDOGx2Snek0LQeADj2OflUIifAiAXvPJE1pyXzY0Gz88B9WN3BQvbZ7gIJ1SlQD4U0I1u8ir%2FAwg1EAAaDDYzNzQyMzE4MzgwNSIMbt1GqczMSFg%2F0dj3KtwDxcgEJRT3R6%2FXgNYBGW8OUZJSq%2F8h73K%2Bfrq8MWn2Rn77xvNsq9kIWh3HGROLyhU7fh%2FLQ46SPWjJApzGxp0dBSHQfiOaceSTB%2BOhyQvrqQfCRYpXZxbiC2WE%2ByZAn92%2BYCTbsU1v9A7fE2SOKIfZi%2BafIOe4BfqmaUwegLBGeZMhUpJJvwsVJ4jvJRlma0s0sHgJEEOwwXeOZFnl2XNOCYqFyOrwAZ6HQYSx7AFJzYQrCCACxpQKiL0mdIg%2B5J2iyxjQUi9unZeUkSAMRb1yzNwSJOxWDl9c8YYR0STLJmwp00zdPkRR5ms2N52xtAJUFdoDOHQfiT0EB8QV0J4ugk27ytYfOUF6xBdeDYYZuCPxKeFac0kI6FeoJXb2%2B7qJUpw2mVna5AyxcLCt8Bm2mPC3cv0LVItKz99DvvuTIFvmsknHLi%2BQMi7wsZ6lIrI1ckdNQhqLQqHmZhcCS%2FIpKikrhTfrhZuQSprRuqB%2B%2B0hyrEcns8K63LbRgkHGpsPly%2B43kbFkLaxdzf451zSG5Kx5s%2FPedCAazWr%2FjSHq0h1qgdhgEiZcdBvk107WDvxuzqxTNNWhGrSlfOO0Ra45cAKwjOEqE4NDYmcFCkcOkJnJGVt2kaUO4K4Rvv8wvu%2ByygY6pgGNFlk8xz1lXqr5tiwuBwDfIlN77fWZbvoE8Rss1htxsW68GMIKUJEO1nwfrk7ufMIEj1Mwiu0f4KBrHdlS%2BulpehgJL6iDzwkUpkIa48MZepfUyiw8xNBJ9DsDbfQ2glBlnRdNEgBDYybJFNLO7VOWp2bUIKDxKv4ib9YrOtfEMonaYu9F8G6SGYazE%2B4Isi6igo4e8j6Lfqxtu0NjPZ2L5rPmzy5d&X-Amz-Signature=e9172c437ae657f33ce6e5c7ea1d87f4fc9ddde5e6b54c05e57cf13324b7011d&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


### 系统调用过程


传参指令……（用户态）→陷入指令（用户态）[引发中断]→中断处理程序（内核态）[选择相应的系统调用处理程序]→相应系统调用处理程序（由传入的参数决定）


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/81119b28-7bd7-4ca6-85ed-8a132fcab89d/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB4662OYUWS2W%2F20251225%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20251225T041006Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEGwaCXVzLXdlc3QtMiJGMEQCIFlH44ZuWOdNDjiKvwLwDOGx2Snek0LQeADj2OflUIifAiAXvPJE1pyXzY0Gz88B9WN3BQvbZ7gIJ1SlQD4U0I1u8ir%2FAwg1EAAaDDYzNzQyMzE4MzgwNSIMbt1GqczMSFg%2F0dj3KtwDxcgEJRT3R6%2FXgNYBGW8OUZJSq%2F8h73K%2Bfrq8MWn2Rn77xvNsq9kIWh3HGROLyhU7fh%2FLQ46SPWjJApzGxp0dBSHQfiOaceSTB%2BOhyQvrqQfCRYpXZxbiC2WE%2ByZAn92%2BYCTbsU1v9A7fE2SOKIfZi%2BafIOe4BfqmaUwegLBGeZMhUpJJvwsVJ4jvJRlma0s0sHgJEEOwwXeOZFnl2XNOCYqFyOrwAZ6HQYSx7AFJzYQrCCACxpQKiL0mdIg%2B5J2iyxjQUi9unZeUkSAMRb1yzNwSJOxWDl9c8YYR0STLJmwp00zdPkRR5ms2N52xtAJUFdoDOHQfiT0EB8QV0J4ugk27ytYfOUF6xBdeDYYZuCPxKeFac0kI6FeoJXb2%2B7qJUpw2mVna5AyxcLCt8Bm2mPC3cv0LVItKz99DvvuTIFvmsknHLi%2BQMi7wsZ6lIrI1ckdNQhqLQqHmZhcCS%2FIpKikrhTfrhZuQSprRuqB%2B%2B0hyrEcns8K63LbRgkHGpsPly%2B43kbFkLaxdzf451zSG5Kx5s%2FPedCAazWr%2FjSHq0h1qgdhgEiZcdBvk107WDvxuzqxTNNWhGrSlfOO0Ra45cAKwjOEqE4NDYmcFCkcOkJnJGVt2kaUO4K4Rvv8wvu%2ByygY6pgGNFlk8xz1lXqr5tiwuBwDfIlN77fWZbvoE8Rss1htxsW68GMIKUJEO1nwfrk7ufMIEj1Mwiu0f4KBrHdlS%2BulpehgJL6iDzwkUpkIa48MZepfUyiw8xNBJ9DsDbfQ2glBlnRdNEgBDYybJFNLO7VOWp2bUIKDxKv4ib9YrOtfEMonaYu9F8G6SGYazE%2B4Isi6igo4e8j6Lfqxtu0NjPZ2L5rPmzy5d&X-Amz-Signature=06a8c3cb120cdc02577571a3d6a6a685866fdc07d4c648832d4d171730127290&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


ps：陷入指令=访管指令=trap指令


### 总结


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/d00274b7-ffbf-42d2-9255-534022d080b6/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB4662OYUWS2W%2F20251225%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20251225T041006Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEGwaCXVzLXdlc3QtMiJGMEQCIFlH44ZuWOdNDjiKvwLwDOGx2Snek0LQeADj2OflUIifAiAXvPJE1pyXzY0Gz88B9WN3BQvbZ7gIJ1SlQD4U0I1u8ir%2FAwg1EAAaDDYzNzQyMzE4MzgwNSIMbt1GqczMSFg%2F0dj3KtwDxcgEJRT3R6%2FXgNYBGW8OUZJSq%2F8h73K%2Bfrq8MWn2Rn77xvNsq9kIWh3HGROLyhU7fh%2FLQ46SPWjJApzGxp0dBSHQfiOaceSTB%2BOhyQvrqQfCRYpXZxbiC2WE%2ByZAn92%2BYCTbsU1v9A7fE2SOKIfZi%2BafIOe4BfqmaUwegLBGeZMhUpJJvwsVJ4jvJRlma0s0sHgJEEOwwXeOZFnl2XNOCYqFyOrwAZ6HQYSx7AFJzYQrCCACxpQKiL0mdIg%2B5J2iyxjQUi9unZeUkSAMRb1yzNwSJOxWDl9c8YYR0STLJmwp00zdPkRR5ms2N52xtAJUFdoDOHQfiT0EB8QV0J4ugk27ytYfOUF6xBdeDYYZuCPxKeFac0kI6FeoJXb2%2B7qJUpw2mVna5AyxcLCt8Bm2mPC3cv0LVItKz99DvvuTIFvmsknHLi%2BQMi7wsZ6lIrI1ckdNQhqLQqHmZhcCS%2FIpKikrhTfrhZuQSprRuqB%2B%2B0hyrEcns8K63LbRgkHGpsPly%2B43kbFkLaxdzf451zSG5Kx5s%2FPedCAazWr%2FjSHq0h1qgdhgEiZcdBvk107WDvxuzqxTNNWhGrSlfOO0Ra45cAKwjOEqE4NDYmcFCkcOkJnJGVt2kaUO4K4Rvv8wvu%2ByygY6pgGNFlk8xz1lXqr5tiwuBwDfIlN77fWZbvoE8Rss1htxsW68GMIKUJEO1nwfrk7ufMIEj1Mwiu0f4KBrHdlS%2BulpehgJL6iDzwkUpkIa48MZepfUyiw8xNBJ9DsDbfQ2glBlnRdNEgBDYybJFNLO7VOWp2bUIKDxKv4ib9YrOtfEMonaYu9F8G6SGYazE%2B4Isi6igo4e8j6Lfqxtu0NjPZ2L5rPmzy5d&X-Amz-Signature=a2c1a124e14e9914221919fe0da95ae8604b5b86184961e5ce27b2502dc2e8a5&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)

