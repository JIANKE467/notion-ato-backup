
系统调用是提供内核服务的接口


（要想执行特权指令需要使用系统调用，而非使用越权的指令）


### 系统调用与库函数的区别


一个程序可以用汇编直接使用系统调用


也可以使用库函数间接使用系统调用（库函数直接使用系统调用）


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/a0f71c13-988a-4aca-bbc8-7fe8a14f2dfa/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB4663ZKHK3ZN%2F20260119%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260119T042327Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEMT%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQD8y%2FkeVXkzf%2B2Bp1kAk1oxM%2FURNROLsAFgzp%2FwFfry%2FQIhAKz68TDOw10be3JxGLecxVGJ6djAuM%2FltzZrkuBASE%2BVKogECI3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQABoMNjM3NDIzMTgzODA1Igxer3J1v%2BOexDRNDBEq3AM8aUJbjmJZTqyPL2mJhY2%2Bx0Sx%2BkEcVwnXTU27i9gguo3am1ywCGJK2lJceEUipcEEC5SG01pD6yUeFNFldUSHSjZDsbEou%2BNvVBHikKdeENBk7NTfpXCMtyoNT%2FNZqgqXFds0wqHl6KIqs5lGGY1WAxYJr7%2FjoHEZeDq3IVWqkl1cg2ugbwQGxEg4WKBcfaE5ywG1s2krAZZCKKaV%2FeyyXxUqvexzPevx%2F%2FDcerJnUW6QEsamhDO8nmzcgwLygPnprLKCkViTvBd6f%2BaoZ07l22s7d0cCfwUP5UXXwbKgWuYr%2BL8fwKkMjQaXY1lOahr%2FAOBewxKj2lNZYSJ%2BdaLQ7AKa%2F9dcAM8W6Y0jr99mk%2F7b9JuL2qqt%2FbK1dtC4vHAOGcnplWjU4ywFGNvSxDcISOzY4E9Habf9jwS1i4PwwPgS2ttpFyMmOc%2Fy3%2Bha09FpSYm7WY0tAxMT0D9R8P5qmcqrby6Ce0wksJMfYYefOtXJUOKjWs8acakFeCKZTSQPlIt90hd08F0AIH9pdEc0ES6Z8v06FUXYmREYs%2FJ7tmtbRGZNWZxZ4XsAvozvvSkXSTuS0omGUYWpPMy2z6pMZ87o%2FhyOt2RvA27Cdr%2FBf3LmPU%2BtscIKjdYBAjC037bLBjqkAcr%2B%2FNRecfbDNIhIdA0A6g9AF%2BvL09a0Gd0V%2FGtOU4V12Bn%2Bg909aBjb93rjZYJ1zrIbUaZKGDu3lCenjMLXBQY2oyR2zVK2KCpJ5YwJasj%2F%2BhdXprdFBeYOTcmZbTeQWX5jFEvZFE6deGddcjgE%2Buu70LiSggf%2BGt0P%2FPnfapEO5vnQ5xjLSvuVRtI3V50JOP1nQR6CDzwzSUbPcGArNRdb54JR&X-Amz-Signature=6df875e34ea46580723da01fca213a7d3b9bf55640728780ede258e047187ccf&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


### 为什么要系统调用


例：当多个进程同时使用一种设备资源（如摄像头）需要内核决定使用顺序，否则会出现争抢摄像头的情况


### 什么功能要系统调用


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/5c6a2eff-5468-4340-8c3e-2646dc3700e6/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB4663ZKHK3ZN%2F20260119%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260119T042327Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEMT%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQD8y%2FkeVXkzf%2B2Bp1kAk1oxM%2FURNROLsAFgzp%2FwFfry%2FQIhAKz68TDOw10be3JxGLecxVGJ6djAuM%2FltzZrkuBASE%2BVKogECI3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQABoMNjM3NDIzMTgzODA1Igxer3J1v%2BOexDRNDBEq3AM8aUJbjmJZTqyPL2mJhY2%2Bx0Sx%2BkEcVwnXTU27i9gguo3am1ywCGJK2lJceEUipcEEC5SG01pD6yUeFNFldUSHSjZDsbEou%2BNvVBHikKdeENBk7NTfpXCMtyoNT%2FNZqgqXFds0wqHl6KIqs5lGGY1WAxYJr7%2FjoHEZeDq3IVWqkl1cg2ugbwQGxEg4WKBcfaE5ywG1s2krAZZCKKaV%2FeyyXxUqvexzPevx%2F%2FDcerJnUW6QEsamhDO8nmzcgwLygPnprLKCkViTvBd6f%2BaoZ07l22s7d0cCfwUP5UXXwbKgWuYr%2BL8fwKkMjQaXY1lOahr%2FAOBewxKj2lNZYSJ%2BdaLQ7AKa%2F9dcAM8W6Y0jr99mk%2F7b9JuL2qqt%2FbK1dtC4vHAOGcnplWjU4ywFGNvSxDcISOzY4E9Habf9jwS1i4PwwPgS2ttpFyMmOc%2Fy3%2Bha09FpSYm7WY0tAxMT0D9R8P5qmcqrby6Ce0wksJMfYYefOtXJUOKjWs8acakFeCKZTSQPlIt90hd08F0AIH9pdEc0ES6Z8v06FUXYmREYs%2FJ7tmtbRGZNWZxZ4XsAvozvvSkXSTuS0omGUYWpPMy2z6pMZ87o%2FhyOt2RvA27Cdr%2FBf3LmPU%2BtscIKjdYBAjC037bLBjqkAcr%2B%2FNRecfbDNIhIdA0A6g9AF%2BvL09a0Gd0V%2FGtOU4V12Bn%2Bg909aBjb93rjZYJ1zrIbUaZKGDu3lCenjMLXBQY2oyR2zVK2KCpJ5YwJasj%2F%2BhdXprdFBeYOTcmZbTeQWX5jFEvZFE6deGddcjgE%2Buu70LiSggf%2BGt0P%2FPnfapEO5vnQ5xjLSvuVRtI3V50JOP1nQR6CDzwzSUbPcGArNRdb54JR&X-Amz-Signature=ec96f6a6000697e78e86e61a86266b7d070f1b1e033e08d8b98f321ba303ec2f&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


### 系统调用过程


传参指令……（用户态）→陷入指令（用户态）[引发中断]→中断处理程序（内核态）[选择相应的系统调用处理程序]→相应系统调用处理程序（由传入的参数决定）


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/81119b28-7bd7-4ca6-85ed-8a132fcab89d/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB4663ZKHK3ZN%2F20260119%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260119T042327Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEMT%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQD8y%2FkeVXkzf%2B2Bp1kAk1oxM%2FURNROLsAFgzp%2FwFfry%2FQIhAKz68TDOw10be3JxGLecxVGJ6djAuM%2FltzZrkuBASE%2BVKogECI3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQABoMNjM3NDIzMTgzODA1Igxer3J1v%2BOexDRNDBEq3AM8aUJbjmJZTqyPL2mJhY2%2Bx0Sx%2BkEcVwnXTU27i9gguo3am1ywCGJK2lJceEUipcEEC5SG01pD6yUeFNFldUSHSjZDsbEou%2BNvVBHikKdeENBk7NTfpXCMtyoNT%2FNZqgqXFds0wqHl6KIqs5lGGY1WAxYJr7%2FjoHEZeDq3IVWqkl1cg2ugbwQGxEg4WKBcfaE5ywG1s2krAZZCKKaV%2FeyyXxUqvexzPevx%2F%2FDcerJnUW6QEsamhDO8nmzcgwLygPnprLKCkViTvBd6f%2BaoZ07l22s7d0cCfwUP5UXXwbKgWuYr%2BL8fwKkMjQaXY1lOahr%2FAOBewxKj2lNZYSJ%2BdaLQ7AKa%2F9dcAM8W6Y0jr99mk%2F7b9JuL2qqt%2FbK1dtC4vHAOGcnplWjU4ywFGNvSxDcISOzY4E9Habf9jwS1i4PwwPgS2ttpFyMmOc%2Fy3%2Bha09FpSYm7WY0tAxMT0D9R8P5qmcqrby6Ce0wksJMfYYefOtXJUOKjWs8acakFeCKZTSQPlIt90hd08F0AIH9pdEc0ES6Z8v06FUXYmREYs%2FJ7tmtbRGZNWZxZ4XsAvozvvSkXSTuS0omGUYWpPMy2z6pMZ87o%2FhyOt2RvA27Cdr%2FBf3LmPU%2BtscIKjdYBAjC037bLBjqkAcr%2B%2FNRecfbDNIhIdA0A6g9AF%2BvL09a0Gd0V%2FGtOU4V12Bn%2Bg909aBjb93rjZYJ1zrIbUaZKGDu3lCenjMLXBQY2oyR2zVK2KCpJ5YwJasj%2F%2BhdXprdFBeYOTcmZbTeQWX5jFEvZFE6deGddcjgE%2Buu70LiSggf%2BGt0P%2FPnfapEO5vnQ5xjLSvuVRtI3V50JOP1nQR6CDzwzSUbPcGArNRdb54JR&X-Amz-Signature=a21dde80945ea50271513231760c9ef0e035bc234e524f2f514dc20523309791&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


ps：陷入指令=访管指令=trap指令


### 总结


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/d00274b7-ffbf-42d2-9255-534022d080b6/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB4663ZKHK3ZN%2F20260119%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260119T042327Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEMT%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQD8y%2FkeVXkzf%2B2Bp1kAk1oxM%2FURNROLsAFgzp%2FwFfry%2FQIhAKz68TDOw10be3JxGLecxVGJ6djAuM%2FltzZrkuBASE%2BVKogECI3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQABoMNjM3NDIzMTgzODA1Igxer3J1v%2BOexDRNDBEq3AM8aUJbjmJZTqyPL2mJhY2%2Bx0Sx%2BkEcVwnXTU27i9gguo3am1ywCGJK2lJceEUipcEEC5SG01pD6yUeFNFldUSHSjZDsbEou%2BNvVBHikKdeENBk7NTfpXCMtyoNT%2FNZqgqXFds0wqHl6KIqs5lGGY1WAxYJr7%2FjoHEZeDq3IVWqkl1cg2ugbwQGxEg4WKBcfaE5ywG1s2krAZZCKKaV%2FeyyXxUqvexzPevx%2F%2FDcerJnUW6QEsamhDO8nmzcgwLygPnprLKCkViTvBd6f%2BaoZ07l22s7d0cCfwUP5UXXwbKgWuYr%2BL8fwKkMjQaXY1lOahr%2FAOBewxKj2lNZYSJ%2BdaLQ7AKa%2F9dcAM8W6Y0jr99mk%2F7b9JuL2qqt%2FbK1dtC4vHAOGcnplWjU4ywFGNvSxDcISOzY4E9Habf9jwS1i4PwwPgS2ttpFyMmOc%2Fy3%2Bha09FpSYm7WY0tAxMT0D9R8P5qmcqrby6Ce0wksJMfYYefOtXJUOKjWs8acakFeCKZTSQPlIt90hd08F0AIH9pdEc0ES6Z8v06FUXYmREYs%2FJ7tmtbRGZNWZxZ4XsAvozvvSkXSTuS0omGUYWpPMy2z6pMZ87o%2FhyOt2RvA27Cdr%2FBf3LmPU%2BtscIKjdYBAjC037bLBjqkAcr%2B%2FNRecfbDNIhIdA0A6g9AF%2BvL09a0Gd0V%2FGtOU4V12Bn%2Bg909aBjb93rjZYJ1zrIbUaZKGDu3lCenjMLXBQY2oyR2zVK2KCpJ5YwJasj%2F%2BhdXprdFBeYOTcmZbTeQWX5jFEvZFE6deGddcjgE%2Buu70LiSggf%2BGt0P%2FPnfapEO5vnQ5xjLSvuVRtI3V50JOP1nQR6CDzwzSUbPcGArNRdb54JR&X-Amz-Signature=e69942888c979f8c1a14140d315dea9dde168798411978c532b00dbbf2dcaf23&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)

