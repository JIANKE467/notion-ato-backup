
系统调用是提供内核服务的接口


（要想执行特权指令需要使用系统调用，而非使用越权的指令）


### 系统调用与库函数的区别


一个程序可以用汇编直接使用系统调用


也可以使用库函数间接使用系统调用（库函数直接使用系统调用）


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/a0f71c13-988a-4aca-bbc8-7fe8a14f2dfa/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB466R7PHVKVY%2F20260117%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260117T040552Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJP%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDzRrSuIYMDxT9H3LfhSAyvE3x3NhTDpKSt3Xg%2F6EbVNQIhALKTsQQnt6UoGGfcHWQv7wmDrjCgBVdgQKGnuKFnbnGdKv8DCFwQABoMNjM3NDIzMTgzODA1IgwAItBznrEeg1ZRMSUq3AOzkUVjukyn2NuDIbv9BJ8lqyrpQjOCKjclZniJTaidHAVfoR5pexeJAifq0OLht7CrGQJ%2BPKWaYbmieVPkvx80%2BpStWtdyKt4S3%2B2DP3TQOhSeQivSyzszUNU9FC1%2Brj%2BnpEpuC0E4A6O4VS6dfVCVrPsRJQOc9kRaCuhRpeXV6%2FBELGpC9mjB9VxBpM%2BLDVwzaUW0yVYIKa26yBTrnmkCtyAdZ5r5pLYGekoBLZ7PjPdDvmzkX%2FthCzbI5UXoVTbmDzPCob7H1Q4TGzkNRCi2KEC3TjNsfJ%2Bsa91z%2B5fgSCBfHb2bkQu0YuwSAebhSFVxdTyFezcobSJ%2FotdyUurlqSTPlE5ovi2lsuKCLmQTga7knYHCViZX1aBgn04Pk1UlpvIcqkp5mnSKctxCHnzlFxkPxybGzFW1IHyED%2FcjPILmK1zMU%2FZpGCWNp4xViehmrFu2nU5NWAQx6YkJq9Daqy%2Fux0qnIrL2b65HFfkppwptwaLhPVUEORTzinyEGvbOqlq90decnDPS%2BtAwQLX3AfxYJrat%2FC2BiECKsSWHAX96IjjspekjLx%2F6dIow4eBo%2Fs%2F0hshjvSEATK5TsvOq%2Bt%2FuCYrAVj6NVGxMCRM67U7Ciw2R%2FDaXlUVGgzDP%2FKvLBjqkAWcuNBfnGJwo5aSPvCNFxzFFUs93kIIq8PaHZawfExPTxfURAxT33Tn%2Ft0LY6Ii%2FuM6eN4p3kj%2F90%2Bwzvh4J%2B78ZKrB5xGO%2Bdlq23XbFy2FNKIoED721xRuen2a4sN94Q22MA0cSU1FmtRpDZaDxkHlnjsu2nuBc0NLY%2BLR9vq3wpGv7S42QDn0VbFZSv1%2B6sqQhUAGm%2FTCYXzqlvyQlwEdtDR4D&X-Amz-Signature=55e211331cb61aaaefb4956e29c1c9347e6bfc6c7c75f227b67456f05fa8fac0&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


### 为什么要系统调用


例：当多个进程同时使用一种设备资源（如摄像头）需要内核决定使用顺序，否则会出现争抢摄像头的情况


### 什么功能要系统调用


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/5c6a2eff-5468-4340-8c3e-2646dc3700e6/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB466R7PHVKVY%2F20260117%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260117T040552Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJP%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDzRrSuIYMDxT9H3LfhSAyvE3x3NhTDpKSt3Xg%2F6EbVNQIhALKTsQQnt6UoGGfcHWQv7wmDrjCgBVdgQKGnuKFnbnGdKv8DCFwQABoMNjM3NDIzMTgzODA1IgwAItBznrEeg1ZRMSUq3AOzkUVjukyn2NuDIbv9BJ8lqyrpQjOCKjclZniJTaidHAVfoR5pexeJAifq0OLht7CrGQJ%2BPKWaYbmieVPkvx80%2BpStWtdyKt4S3%2B2DP3TQOhSeQivSyzszUNU9FC1%2Brj%2BnpEpuC0E4A6O4VS6dfVCVrPsRJQOc9kRaCuhRpeXV6%2FBELGpC9mjB9VxBpM%2BLDVwzaUW0yVYIKa26yBTrnmkCtyAdZ5r5pLYGekoBLZ7PjPdDvmzkX%2FthCzbI5UXoVTbmDzPCob7H1Q4TGzkNRCi2KEC3TjNsfJ%2Bsa91z%2B5fgSCBfHb2bkQu0YuwSAebhSFVxdTyFezcobSJ%2FotdyUurlqSTPlE5ovi2lsuKCLmQTga7knYHCViZX1aBgn04Pk1UlpvIcqkp5mnSKctxCHnzlFxkPxybGzFW1IHyED%2FcjPILmK1zMU%2FZpGCWNp4xViehmrFu2nU5NWAQx6YkJq9Daqy%2Fux0qnIrL2b65HFfkppwptwaLhPVUEORTzinyEGvbOqlq90decnDPS%2BtAwQLX3AfxYJrat%2FC2BiECKsSWHAX96IjjspekjLx%2F6dIow4eBo%2Fs%2F0hshjvSEATK5TsvOq%2Bt%2FuCYrAVj6NVGxMCRM67U7Ciw2R%2FDaXlUVGgzDP%2FKvLBjqkAWcuNBfnGJwo5aSPvCNFxzFFUs93kIIq8PaHZawfExPTxfURAxT33Tn%2Ft0LY6Ii%2FuM6eN4p3kj%2F90%2Bwzvh4J%2B78ZKrB5xGO%2Bdlq23XbFy2FNKIoED721xRuen2a4sN94Q22MA0cSU1FmtRpDZaDxkHlnjsu2nuBc0NLY%2BLR9vq3wpGv7S42QDn0VbFZSv1%2B6sqQhUAGm%2FTCYXzqlvyQlwEdtDR4D&X-Amz-Signature=45a46169cbfbfce4bb435b1b38033b48d13491b372ed2a012690ddb373105804&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


### 系统调用过程


传参指令……（用户态）→陷入指令（用户态）[引发中断]→中断处理程序（内核态）[选择相应的系统调用处理程序]→相应系统调用处理程序（由传入的参数决定）


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/81119b28-7bd7-4ca6-85ed-8a132fcab89d/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB466R7PHVKVY%2F20260117%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260117T040552Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJP%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDzRrSuIYMDxT9H3LfhSAyvE3x3NhTDpKSt3Xg%2F6EbVNQIhALKTsQQnt6UoGGfcHWQv7wmDrjCgBVdgQKGnuKFnbnGdKv8DCFwQABoMNjM3NDIzMTgzODA1IgwAItBznrEeg1ZRMSUq3AOzkUVjukyn2NuDIbv9BJ8lqyrpQjOCKjclZniJTaidHAVfoR5pexeJAifq0OLht7CrGQJ%2BPKWaYbmieVPkvx80%2BpStWtdyKt4S3%2B2DP3TQOhSeQivSyzszUNU9FC1%2Brj%2BnpEpuC0E4A6O4VS6dfVCVrPsRJQOc9kRaCuhRpeXV6%2FBELGpC9mjB9VxBpM%2BLDVwzaUW0yVYIKa26yBTrnmkCtyAdZ5r5pLYGekoBLZ7PjPdDvmzkX%2FthCzbI5UXoVTbmDzPCob7H1Q4TGzkNRCi2KEC3TjNsfJ%2Bsa91z%2B5fgSCBfHb2bkQu0YuwSAebhSFVxdTyFezcobSJ%2FotdyUurlqSTPlE5ovi2lsuKCLmQTga7knYHCViZX1aBgn04Pk1UlpvIcqkp5mnSKctxCHnzlFxkPxybGzFW1IHyED%2FcjPILmK1zMU%2FZpGCWNp4xViehmrFu2nU5NWAQx6YkJq9Daqy%2Fux0qnIrL2b65HFfkppwptwaLhPVUEORTzinyEGvbOqlq90decnDPS%2BtAwQLX3AfxYJrat%2FC2BiECKsSWHAX96IjjspekjLx%2F6dIow4eBo%2Fs%2F0hshjvSEATK5TsvOq%2Bt%2FuCYrAVj6NVGxMCRM67U7Ciw2R%2FDaXlUVGgzDP%2FKvLBjqkAWcuNBfnGJwo5aSPvCNFxzFFUs93kIIq8PaHZawfExPTxfURAxT33Tn%2Ft0LY6Ii%2FuM6eN4p3kj%2F90%2Bwzvh4J%2B78ZKrB5xGO%2Bdlq23XbFy2FNKIoED721xRuen2a4sN94Q22MA0cSU1FmtRpDZaDxkHlnjsu2nuBc0NLY%2BLR9vq3wpGv7S42QDn0VbFZSv1%2B6sqQhUAGm%2FTCYXzqlvyQlwEdtDR4D&X-Amz-Signature=40f890254b48b910ca0fe2c0553ab06dd87bd7f6092fee82040177d1bd5ef71b&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


ps：陷入指令=访管指令=trap指令


### 总结


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/d00274b7-ffbf-42d2-9255-534022d080b6/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB466R7PHVKVY%2F20260117%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260117T040552Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJP%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDzRrSuIYMDxT9H3LfhSAyvE3x3NhTDpKSt3Xg%2F6EbVNQIhALKTsQQnt6UoGGfcHWQv7wmDrjCgBVdgQKGnuKFnbnGdKv8DCFwQABoMNjM3NDIzMTgzODA1IgwAItBznrEeg1ZRMSUq3AOzkUVjukyn2NuDIbv9BJ8lqyrpQjOCKjclZniJTaidHAVfoR5pexeJAifq0OLht7CrGQJ%2BPKWaYbmieVPkvx80%2BpStWtdyKt4S3%2B2DP3TQOhSeQivSyzszUNU9FC1%2Brj%2BnpEpuC0E4A6O4VS6dfVCVrPsRJQOc9kRaCuhRpeXV6%2FBELGpC9mjB9VxBpM%2BLDVwzaUW0yVYIKa26yBTrnmkCtyAdZ5r5pLYGekoBLZ7PjPdDvmzkX%2FthCzbI5UXoVTbmDzPCob7H1Q4TGzkNRCi2KEC3TjNsfJ%2Bsa91z%2B5fgSCBfHb2bkQu0YuwSAebhSFVxdTyFezcobSJ%2FotdyUurlqSTPlE5ovi2lsuKCLmQTga7knYHCViZX1aBgn04Pk1UlpvIcqkp5mnSKctxCHnzlFxkPxybGzFW1IHyED%2FcjPILmK1zMU%2FZpGCWNp4xViehmrFu2nU5NWAQx6YkJq9Daqy%2Fux0qnIrL2b65HFfkppwptwaLhPVUEORTzinyEGvbOqlq90decnDPS%2BtAwQLX3AfxYJrat%2FC2BiECKsSWHAX96IjjspekjLx%2F6dIow4eBo%2Fs%2F0hshjvSEATK5TsvOq%2Bt%2FuCYrAVj6NVGxMCRM67U7Ciw2R%2FDaXlUVGgzDP%2FKvLBjqkAWcuNBfnGJwo5aSPvCNFxzFFUs93kIIq8PaHZawfExPTxfURAxT33Tn%2Ft0LY6Ii%2FuM6eN4p3kj%2F90%2Bwzvh4J%2B78ZKrB5xGO%2Bdlq23XbFy2FNKIoED721xRuen2a4sN94Q22MA0cSU1FmtRpDZaDxkHlnjsu2nuBc0NLY%2BLR9vq3wpGv7S42QDn0VbFZSv1%2B6sqQhUAGm%2FTCYXzqlvyQlwEdtDR4D&X-Amz-Signature=21087a07dd7297ec01bfe5aa10ebb6e715ef99855695cee0f03311656df4eb7d&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)

