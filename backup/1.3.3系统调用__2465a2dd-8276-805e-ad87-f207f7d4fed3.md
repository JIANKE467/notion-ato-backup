
系统调用是提供内核服务的接口


（要想执行特权指令需要使用系统调用，而非使用越权的指令）


### 系统调用与库函数的区别


一个程序可以用汇编直接使用系统调用


也可以使用库函数间接使用系统调用（库函数直接使用系统调用）


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/a0f71c13-988a-4aca-bbc8-7fe8a14f2dfa/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB4665IWPTYOH%2F20260122%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260122T042041Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEAwaCXVzLXdlc3QtMiJGMEQCICa9RRixBC5SywF2dnyhvuGduzUsW6jp6Nbuyy4%2Fx%2BB%2FAiAcEPHNeZ%2BY0TYiOCPON%2B45ay7FeQfq%2FyfOHWy7Ju8fISqIBAjV%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAAaDDYzNzQyMzE4MzgwNSIMoImqqQ%2BEPhGh0YuyKtwDvxAlJNhPU2AqxnwWvuDnOnMP6ct7FBJFYm3%2FTON7wZSWpDsi7%2F%2F90g3tFCk33gZZJNS5c9vu5sYMUhkJo8w3YDZ%2FBXehpQDRbHvPpFAHsH7xBfZQEWI9fx7tfGMOxPIUIVG4QrNtn1qxgoYtjHmGdE6qJqnzBMr3HWP4OVtz%2FQxNKnxS23Y9Tb3yn1QHkIJn2fuEm8MCmR9aAyMsn0Zu4XymkLBTii%2BD6oadHyvwqrs9zIJeyNdret%2FYj4%2BoXgwIsuCrZ8Wdbq4dLA5191%2FJy7r2d46fXbMKtwN4ZApyFMrqPQYgC81KLoeZPOcG6GK%2FdJhhYhWrkO%2Fw8jvvQtrfEo1KtGxlQghTljhaD7l5v%2FyK3JocsNFDyBRfmMqaHHbpt0jqKMketAZZgeBDw3tBzxYlfQSYwBVlpMpVXlduyuITKASZSUC4W%2FUsq%2FawLts0hKMcmoo%2FeQmWbYnxP3C4GA42hpTWrRpCtGUbyRD%2FChud2g0ldy%2Bt5XAOUJL2hJ6EySu3hMpk1Ui%2F5WqdJC60LixOjfP0%2BmVvs%2Bv0pG3%2Ffu4yvaGt0I83w3zhqcObWFQ1M94iOnL6t8mKz%2BYF5XiwYES5HHOj4PmcbvwnjdwAR%2FHi5df3cMBBne5bh6Ewh8fGywY6pgHIChEwgpqdZNQ2J3CGnyMOuI0onqjaZ6DsNE09hBt%2B2qdOlSSC1Y9dE%2Bd1whkzjmyh7o%2F4%2FkrflGzjugbOabi3JYakXAndoN5Qx61W8%2FRsEtxQ9URtsXYGvQJLPCJ83%2BTjq46f%2BXbU3EU42P2wR%2FOh1fYtIi1VOPuBZs6fsBGXLxU4nIE4pfPwdYqLXUzbsv%2Bb1NbaNqlZyBmUGXE8sU%2B1KQYPl1T6&X-Amz-Signature=1ee2975443d3b7c7d16032352fe5b9982c7c2e60cecff736b874c834689defd3&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


### 为什么要系统调用


例：当多个进程同时使用一种设备资源（如摄像头）需要内核决定使用顺序，否则会出现争抢摄像头的情况


### 什么功能要系统调用


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/5c6a2eff-5468-4340-8c3e-2646dc3700e6/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB4665IWPTYOH%2F20260122%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260122T042041Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEAwaCXVzLXdlc3QtMiJGMEQCICa9RRixBC5SywF2dnyhvuGduzUsW6jp6Nbuyy4%2Fx%2BB%2FAiAcEPHNeZ%2BY0TYiOCPON%2B45ay7FeQfq%2FyfOHWy7Ju8fISqIBAjV%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAAaDDYzNzQyMzE4MzgwNSIMoImqqQ%2BEPhGh0YuyKtwDvxAlJNhPU2AqxnwWvuDnOnMP6ct7FBJFYm3%2FTON7wZSWpDsi7%2F%2F90g3tFCk33gZZJNS5c9vu5sYMUhkJo8w3YDZ%2FBXehpQDRbHvPpFAHsH7xBfZQEWI9fx7tfGMOxPIUIVG4QrNtn1qxgoYtjHmGdE6qJqnzBMr3HWP4OVtz%2FQxNKnxS23Y9Tb3yn1QHkIJn2fuEm8MCmR9aAyMsn0Zu4XymkLBTii%2BD6oadHyvwqrs9zIJeyNdret%2FYj4%2BoXgwIsuCrZ8Wdbq4dLA5191%2FJy7r2d46fXbMKtwN4ZApyFMrqPQYgC81KLoeZPOcG6GK%2FdJhhYhWrkO%2Fw8jvvQtrfEo1KtGxlQghTljhaD7l5v%2FyK3JocsNFDyBRfmMqaHHbpt0jqKMketAZZgeBDw3tBzxYlfQSYwBVlpMpVXlduyuITKASZSUC4W%2FUsq%2FawLts0hKMcmoo%2FeQmWbYnxP3C4GA42hpTWrRpCtGUbyRD%2FChud2g0ldy%2Bt5XAOUJL2hJ6EySu3hMpk1Ui%2F5WqdJC60LixOjfP0%2BmVvs%2Bv0pG3%2Ffu4yvaGt0I83w3zhqcObWFQ1M94iOnL6t8mKz%2BYF5XiwYES5HHOj4PmcbvwnjdwAR%2FHi5df3cMBBne5bh6Ewh8fGywY6pgHIChEwgpqdZNQ2J3CGnyMOuI0onqjaZ6DsNE09hBt%2B2qdOlSSC1Y9dE%2Bd1whkzjmyh7o%2F4%2FkrflGzjugbOabi3JYakXAndoN5Qx61W8%2FRsEtxQ9URtsXYGvQJLPCJ83%2BTjq46f%2BXbU3EU42P2wR%2FOh1fYtIi1VOPuBZs6fsBGXLxU4nIE4pfPwdYqLXUzbsv%2Bb1NbaNqlZyBmUGXE8sU%2B1KQYPl1T6&X-Amz-Signature=0eb39fee15b1d1f037378f14566c586c682976a777fdadb180d1e425aae3136a&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


### 系统调用过程


传参指令……（用户态）→陷入指令（用户态）[引发中断]→中断处理程序（内核态）[选择相应的系统调用处理程序]→相应系统调用处理程序（由传入的参数决定）


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/81119b28-7bd7-4ca6-85ed-8a132fcab89d/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB4665IWPTYOH%2F20260122%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260122T042041Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEAwaCXVzLXdlc3QtMiJGMEQCICa9RRixBC5SywF2dnyhvuGduzUsW6jp6Nbuyy4%2Fx%2BB%2FAiAcEPHNeZ%2BY0TYiOCPON%2B45ay7FeQfq%2FyfOHWy7Ju8fISqIBAjV%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAAaDDYzNzQyMzE4MzgwNSIMoImqqQ%2BEPhGh0YuyKtwDvxAlJNhPU2AqxnwWvuDnOnMP6ct7FBJFYm3%2FTON7wZSWpDsi7%2F%2F90g3tFCk33gZZJNS5c9vu5sYMUhkJo8w3YDZ%2FBXehpQDRbHvPpFAHsH7xBfZQEWI9fx7tfGMOxPIUIVG4QrNtn1qxgoYtjHmGdE6qJqnzBMr3HWP4OVtz%2FQxNKnxS23Y9Tb3yn1QHkIJn2fuEm8MCmR9aAyMsn0Zu4XymkLBTii%2BD6oadHyvwqrs9zIJeyNdret%2FYj4%2BoXgwIsuCrZ8Wdbq4dLA5191%2FJy7r2d46fXbMKtwN4ZApyFMrqPQYgC81KLoeZPOcG6GK%2FdJhhYhWrkO%2Fw8jvvQtrfEo1KtGxlQghTljhaD7l5v%2FyK3JocsNFDyBRfmMqaHHbpt0jqKMketAZZgeBDw3tBzxYlfQSYwBVlpMpVXlduyuITKASZSUC4W%2FUsq%2FawLts0hKMcmoo%2FeQmWbYnxP3C4GA42hpTWrRpCtGUbyRD%2FChud2g0ldy%2Bt5XAOUJL2hJ6EySu3hMpk1Ui%2F5WqdJC60LixOjfP0%2BmVvs%2Bv0pG3%2Ffu4yvaGt0I83w3zhqcObWFQ1M94iOnL6t8mKz%2BYF5XiwYES5HHOj4PmcbvwnjdwAR%2FHi5df3cMBBne5bh6Ewh8fGywY6pgHIChEwgpqdZNQ2J3CGnyMOuI0onqjaZ6DsNE09hBt%2B2qdOlSSC1Y9dE%2Bd1whkzjmyh7o%2F4%2FkrflGzjugbOabi3JYakXAndoN5Qx61W8%2FRsEtxQ9URtsXYGvQJLPCJ83%2BTjq46f%2BXbU3EU42P2wR%2FOh1fYtIi1VOPuBZs6fsBGXLxU4nIE4pfPwdYqLXUzbsv%2Bb1NbaNqlZyBmUGXE8sU%2B1KQYPl1T6&X-Amz-Signature=2082ec727033cb0b984fa91d2fa87fd4054b813920ef3457351361f7af40cfec&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


ps：陷入指令=访管指令=trap指令


### 总结


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/d00274b7-ffbf-42d2-9255-534022d080b6/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB4665IWPTYOH%2F20260122%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260122T042041Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEAwaCXVzLXdlc3QtMiJGMEQCICa9RRixBC5SywF2dnyhvuGduzUsW6jp6Nbuyy4%2Fx%2BB%2FAiAcEPHNeZ%2BY0TYiOCPON%2B45ay7FeQfq%2FyfOHWy7Ju8fISqIBAjV%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAAaDDYzNzQyMzE4MzgwNSIMoImqqQ%2BEPhGh0YuyKtwDvxAlJNhPU2AqxnwWvuDnOnMP6ct7FBJFYm3%2FTON7wZSWpDsi7%2F%2F90g3tFCk33gZZJNS5c9vu5sYMUhkJo8w3YDZ%2FBXehpQDRbHvPpFAHsH7xBfZQEWI9fx7tfGMOxPIUIVG4QrNtn1qxgoYtjHmGdE6qJqnzBMr3HWP4OVtz%2FQxNKnxS23Y9Tb3yn1QHkIJn2fuEm8MCmR9aAyMsn0Zu4XymkLBTii%2BD6oadHyvwqrs9zIJeyNdret%2FYj4%2BoXgwIsuCrZ8Wdbq4dLA5191%2FJy7r2d46fXbMKtwN4ZApyFMrqPQYgC81KLoeZPOcG6GK%2FdJhhYhWrkO%2Fw8jvvQtrfEo1KtGxlQghTljhaD7l5v%2FyK3JocsNFDyBRfmMqaHHbpt0jqKMketAZZgeBDw3tBzxYlfQSYwBVlpMpVXlduyuITKASZSUC4W%2FUsq%2FawLts0hKMcmoo%2FeQmWbYnxP3C4GA42hpTWrRpCtGUbyRD%2FChud2g0ldy%2Bt5XAOUJL2hJ6EySu3hMpk1Ui%2F5WqdJC60LixOjfP0%2BmVvs%2Bv0pG3%2Ffu4yvaGt0I83w3zhqcObWFQ1M94iOnL6t8mKz%2BYF5XiwYES5HHOj4PmcbvwnjdwAR%2FHi5df3cMBBne5bh6Ewh8fGywY6pgHIChEwgpqdZNQ2J3CGnyMOuI0onqjaZ6DsNE09hBt%2B2qdOlSSC1Y9dE%2Bd1whkzjmyh7o%2F4%2FkrflGzjugbOabi3JYakXAndoN5Qx61W8%2FRsEtxQ9URtsXYGvQJLPCJ83%2BTjq46f%2BXbU3EU42P2wR%2FOh1fYtIi1VOPuBZs6fsBGXLxU4nIE4pfPwdYqLXUzbsv%2Bb1NbaNqlZyBmUGXE8sU%2B1KQYPl1T6&X-Amz-Signature=35714566cca88eb0334d94359f92477aedf0f8738dc473ec752f2147ec42cba9&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)

