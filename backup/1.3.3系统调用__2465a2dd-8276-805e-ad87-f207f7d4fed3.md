
系统调用是提供内核服务的接口


（要想执行特权指令需要使用系统调用，而非使用越权的指令）


### 系统调用与库函数的区别


一个程序可以用汇编直接使用系统调用


也可以使用库函数间接使用系统调用（库函数直接使用系统调用）


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/a0f71c13-988a-4aca-bbc8-7fe8a14f2dfa/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB466TGF73OAP%2F20260114%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260114T042030Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEEwaCXVzLXdlc3QtMiJHMEUCIHztzZlu6ybJVB97ArDLqJk9ZrM3YvZGzm5b9064BFktAiEA32t5SMdG9%2FeSnIyhJ4W%2FRGutdc0HUqJtbNO3fEUZ6v8q%2FwMIFRAAGgw2Mzc0MjMxODM4MDUiDMKLpYNR5k4dPIa4TCrcA%2B0ytSBy5Q3Oy9SUKVczj6SQe8X%2FxxlInAnRgK0BdtYFk8zy%2B3GmQuZq7K0C%2BuNTwlAiCKAGRsMz1plP1r6aYwLgCHU1%2Bbl%2FwAl7h1uuB9tDFMf2Pfr08%2FNSDmuQBQ6QvCxV2mcXUgZ3LhMRvZCr8xGL4QuUaLXSkR%2BmdgytDw4FCvdO01seUtwS58qP5xd8DTlel49gUEmVkLnfTIRpOBJZ5cPMf4au1ZS%2BxKANcgd0zukbepqTUJyR1D%2FV5ak6YI5xqZeYvV1yOkV6QnwfGi%2Fk6c5AJTaNU8%2BCxK0dDD%2BgvQQKz9F5MacEVsSZrLnBy0LNDWkusDSTymalAr5OPMI5os9HOm%2FVIFc6RuH4a9ooIMzM%2B0RVnBLkktYOiAjmfhkb275wmdtoAq3Ask5QdREXx35sJpABIQP7xGUets71h90IQzxgP7Z9ajbGsMovUNRvPRFkC8gqXNuz1zq%2BX6TrnK3ZJMAvAsrQ%2F1YVuD%2BvV1vNybNwv5ESMIZEVDGTmxCQJoNb4gs7YFTuWwxYGRCNLjb%2F4dmktsHrYaWzx6mp8rn%2F9LHqQ%2BMdsmuziUjPWqmuWElqGy7VmG168hHNtXHm%2FEke%2FCh0Cj%2BPEKk%2BI69aq%2BL6ypUlMqthRmboMMWbnMsGOqUBRGaA7ui8YmYodtcDrek8scHMdvKSqRFw2q3UA2bDbVyLsPr0eTI9h24UDN%2BN7yeICY4DXZr%2FZFFO3phZ8WhTzdqCcOYX56ndSFs0jIk%2BIDb1MdLXbhUBLNSAitJrDKf52Axfc%2FgaAE9s%2FWh3RdGfA6ZPv%2Fr%2FUgAHFoOLSHaFK1dkShoYOQbd32mVM5t2nfXcBzc86Dm2d2nDMYHynrdsyjuQq2FX&X-Amz-Signature=1ec119cf0666858d4188423d38329961252b1038d004985a4e55f7290985a6d8&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


### 为什么要系统调用


例：当多个进程同时使用一种设备资源（如摄像头）需要内核决定使用顺序，否则会出现争抢摄像头的情况


### 什么功能要系统调用


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/5c6a2eff-5468-4340-8c3e-2646dc3700e6/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB466TGF73OAP%2F20260114%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260114T042030Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEEwaCXVzLXdlc3QtMiJHMEUCIHztzZlu6ybJVB97ArDLqJk9ZrM3YvZGzm5b9064BFktAiEA32t5SMdG9%2FeSnIyhJ4W%2FRGutdc0HUqJtbNO3fEUZ6v8q%2FwMIFRAAGgw2Mzc0MjMxODM4MDUiDMKLpYNR5k4dPIa4TCrcA%2B0ytSBy5Q3Oy9SUKVczj6SQe8X%2FxxlInAnRgK0BdtYFk8zy%2B3GmQuZq7K0C%2BuNTwlAiCKAGRsMz1plP1r6aYwLgCHU1%2Bbl%2FwAl7h1uuB9tDFMf2Pfr08%2FNSDmuQBQ6QvCxV2mcXUgZ3LhMRvZCr8xGL4QuUaLXSkR%2BmdgytDw4FCvdO01seUtwS58qP5xd8DTlel49gUEmVkLnfTIRpOBJZ5cPMf4au1ZS%2BxKANcgd0zukbepqTUJyR1D%2FV5ak6YI5xqZeYvV1yOkV6QnwfGi%2Fk6c5AJTaNU8%2BCxK0dDD%2BgvQQKz9F5MacEVsSZrLnBy0LNDWkusDSTymalAr5OPMI5os9HOm%2FVIFc6RuH4a9ooIMzM%2B0RVnBLkktYOiAjmfhkb275wmdtoAq3Ask5QdREXx35sJpABIQP7xGUets71h90IQzxgP7Z9ajbGsMovUNRvPRFkC8gqXNuz1zq%2BX6TrnK3ZJMAvAsrQ%2F1YVuD%2BvV1vNybNwv5ESMIZEVDGTmxCQJoNb4gs7YFTuWwxYGRCNLjb%2F4dmktsHrYaWzx6mp8rn%2F9LHqQ%2BMdsmuziUjPWqmuWElqGy7VmG168hHNtXHm%2FEke%2FCh0Cj%2BPEKk%2BI69aq%2BL6ypUlMqthRmboMMWbnMsGOqUBRGaA7ui8YmYodtcDrek8scHMdvKSqRFw2q3UA2bDbVyLsPr0eTI9h24UDN%2BN7yeICY4DXZr%2FZFFO3phZ8WhTzdqCcOYX56ndSFs0jIk%2BIDb1MdLXbhUBLNSAitJrDKf52Axfc%2FgaAE9s%2FWh3RdGfA6ZPv%2Fr%2FUgAHFoOLSHaFK1dkShoYOQbd32mVM5t2nfXcBzc86Dm2d2nDMYHynrdsyjuQq2FX&X-Amz-Signature=38d5925dc3473c6a39d118072d5730094026a1d7721738034c2430fabc956687&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


### 系统调用过程


传参指令……（用户态）→陷入指令（用户态）[引发中断]→中断处理程序（内核态）[选择相应的系统调用处理程序]→相应系统调用处理程序（由传入的参数决定）


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/81119b28-7bd7-4ca6-85ed-8a132fcab89d/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB466TGF73OAP%2F20260114%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260114T042030Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEEwaCXVzLXdlc3QtMiJHMEUCIHztzZlu6ybJVB97ArDLqJk9ZrM3YvZGzm5b9064BFktAiEA32t5SMdG9%2FeSnIyhJ4W%2FRGutdc0HUqJtbNO3fEUZ6v8q%2FwMIFRAAGgw2Mzc0MjMxODM4MDUiDMKLpYNR5k4dPIa4TCrcA%2B0ytSBy5Q3Oy9SUKVczj6SQe8X%2FxxlInAnRgK0BdtYFk8zy%2B3GmQuZq7K0C%2BuNTwlAiCKAGRsMz1plP1r6aYwLgCHU1%2Bbl%2FwAl7h1uuB9tDFMf2Pfr08%2FNSDmuQBQ6QvCxV2mcXUgZ3LhMRvZCr8xGL4QuUaLXSkR%2BmdgytDw4FCvdO01seUtwS58qP5xd8DTlel49gUEmVkLnfTIRpOBJZ5cPMf4au1ZS%2BxKANcgd0zukbepqTUJyR1D%2FV5ak6YI5xqZeYvV1yOkV6QnwfGi%2Fk6c5AJTaNU8%2BCxK0dDD%2BgvQQKz9F5MacEVsSZrLnBy0LNDWkusDSTymalAr5OPMI5os9HOm%2FVIFc6RuH4a9ooIMzM%2B0RVnBLkktYOiAjmfhkb275wmdtoAq3Ask5QdREXx35sJpABIQP7xGUets71h90IQzxgP7Z9ajbGsMovUNRvPRFkC8gqXNuz1zq%2BX6TrnK3ZJMAvAsrQ%2F1YVuD%2BvV1vNybNwv5ESMIZEVDGTmxCQJoNb4gs7YFTuWwxYGRCNLjb%2F4dmktsHrYaWzx6mp8rn%2F9LHqQ%2BMdsmuziUjPWqmuWElqGy7VmG168hHNtXHm%2FEke%2FCh0Cj%2BPEKk%2BI69aq%2BL6ypUlMqthRmboMMWbnMsGOqUBRGaA7ui8YmYodtcDrek8scHMdvKSqRFw2q3UA2bDbVyLsPr0eTI9h24UDN%2BN7yeICY4DXZr%2FZFFO3phZ8WhTzdqCcOYX56ndSFs0jIk%2BIDb1MdLXbhUBLNSAitJrDKf52Axfc%2FgaAE9s%2FWh3RdGfA6ZPv%2Fr%2FUgAHFoOLSHaFK1dkShoYOQbd32mVM5t2nfXcBzc86Dm2d2nDMYHynrdsyjuQq2FX&X-Amz-Signature=7f586e54d3a851fba4aab36e7f92a8796148b4208fb86b74f6d447cc207f6cae&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


ps：陷入指令=访管指令=trap指令


### 总结


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/d00274b7-ffbf-42d2-9255-534022d080b6/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB466TGF73OAP%2F20260114%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260114T042030Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEEwaCXVzLXdlc3QtMiJHMEUCIHztzZlu6ybJVB97ArDLqJk9ZrM3YvZGzm5b9064BFktAiEA32t5SMdG9%2FeSnIyhJ4W%2FRGutdc0HUqJtbNO3fEUZ6v8q%2FwMIFRAAGgw2Mzc0MjMxODM4MDUiDMKLpYNR5k4dPIa4TCrcA%2B0ytSBy5Q3Oy9SUKVczj6SQe8X%2FxxlInAnRgK0BdtYFk8zy%2B3GmQuZq7K0C%2BuNTwlAiCKAGRsMz1plP1r6aYwLgCHU1%2Bbl%2FwAl7h1uuB9tDFMf2Pfr08%2FNSDmuQBQ6QvCxV2mcXUgZ3LhMRvZCr8xGL4QuUaLXSkR%2BmdgytDw4FCvdO01seUtwS58qP5xd8DTlel49gUEmVkLnfTIRpOBJZ5cPMf4au1ZS%2BxKANcgd0zukbepqTUJyR1D%2FV5ak6YI5xqZeYvV1yOkV6QnwfGi%2Fk6c5AJTaNU8%2BCxK0dDD%2BgvQQKz9F5MacEVsSZrLnBy0LNDWkusDSTymalAr5OPMI5os9HOm%2FVIFc6RuH4a9ooIMzM%2B0RVnBLkktYOiAjmfhkb275wmdtoAq3Ask5QdREXx35sJpABIQP7xGUets71h90IQzxgP7Z9ajbGsMovUNRvPRFkC8gqXNuz1zq%2BX6TrnK3ZJMAvAsrQ%2F1YVuD%2BvV1vNybNwv5ESMIZEVDGTmxCQJoNb4gs7YFTuWwxYGRCNLjb%2F4dmktsHrYaWzx6mp8rn%2F9LHqQ%2BMdsmuziUjPWqmuWElqGy7VmG168hHNtXHm%2FEke%2FCh0Cj%2BPEKk%2BI69aq%2BL6ypUlMqthRmboMMWbnMsGOqUBRGaA7ui8YmYodtcDrek8scHMdvKSqRFw2q3UA2bDbVyLsPr0eTI9h24UDN%2BN7yeICY4DXZr%2FZFFO3phZ8WhTzdqCcOYX56ndSFs0jIk%2BIDb1MdLXbhUBLNSAitJrDKf52Axfc%2FgaAE9s%2FWh3RdGfA6ZPv%2Fr%2FUgAHFoOLSHaFK1dkShoYOQbd32mVM5t2nfXcBzc86Dm2d2nDMYHynrdsyjuQq2FX&X-Amz-Signature=cb007a48d70deb0181f1897eafaf930255883301325a01a727ff1f5ff65ad861&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)

