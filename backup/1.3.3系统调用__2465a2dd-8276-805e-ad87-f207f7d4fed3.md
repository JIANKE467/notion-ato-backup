
系统调用是提供内核服务的接口


（要想执行特权指令需要使用系统调用，而非使用越权的指令）


### 系统调用与库函数的区别


一个程序可以用汇编直接使用系统调用


也可以使用库函数间接使用系统调用（库函数直接使用系统调用）


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/a0f71c13-988a-4aca-bbc8-7fe8a14f2dfa/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB466VCVN7HZH%2F20260127%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260127T042152Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEIT%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDoJ59t8CWhNhJjExS2yXSgCLUXVfX20CXJ6apq%2BzJINAIgN8fbInSvfOSaeLTcUc9veJPkqD9tmPnnZm2IpvURIp8q%2FwMITRAAGgw2Mzc0MjMxODM4MDUiDFqnLe%2BxhVfilDpPjircA0IB38PkT4U%2FPqNptfb4DN71Mau4R4Vm9SuBgfmR1CxblsUd6N3juVFxy4LzXke%2FKRtL%2FrUbH3VqFTdoCCSkZ%2FPcCS4fd9CLh3FOMz5u5bbJG26T9XZ4ndrSrYKgcCuyvMmdJ30NdsXmL7YJ4fXmcNUS65Q8QAzgbge7OcqPBVAwjUJmYGksJ98OAPMjn1DPxyHY51PoyxoIAkXPF4Wb7kpg77QdEIXmZ3%2Fae20bKSkqm0nzQH9Y%2B2MynfDGmPxrFv3yRqvopn%2BvsOJ9YkxJGI7G0Vh1upTvTxm%2BDwH11iu3bMbGvSFHiIOyi0y2JLr2NdthFBIf7AuAJgjIk5DsFlmLmolA0D%2BWRYKCtdKGNCjPfn%2BZXuw8p94SBPPD4jkw6pd0NbaIAhkAomOusTndIDIsMyDXxeSvZctl3L9Yd0OOA%2F1JhNlMvsnb7sCFwXL%2BT8kLv11Xq%2F39jl5hZXTT%2F3vYoQfrO9pTjlMPKlZC8QL%2BmqLiNr0KSKirNZyWxNlm%2F6eK8GE0q47bIUl3MbPCxjjbqHP4R1alf3wbrQABoENQTZ8QxU9LckaCaUgNu9Vhm5fpDiRBFXQsaelXHQLShjlUkVMOpk0BoYizGktg9eCxn%2F%2FyBPtfKDT2UePcML3j4MsGOqUBYBHkyv7ZBjO2JlvmA2iri16EGBlXxlXsmpPBfhZrlisffpgbGZj8Qh8UpEocQ%2FgsG8qdSLPQpZkP3vuFitJpUUPmI%2Bn0LKU4qezQvRVGG1jAZ8fxvWg05hCAeC2uBCuBOmcvzfJKk8a6vY1IaKRABJsoaJwYd41FX4XOSc4IAgfInGbICOa9o9e6%2BR0%2FZ0srCWaCrW2ChwBCRUpWmpDpiuhmOs5t&X-Amz-Signature=75e6e9f596d25a712b6ca7806f2b782e901e534ae6fb5a24718dec596f8062b7&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


### 为什么要系统调用


例：当多个进程同时使用一种设备资源（如摄像头）需要内核决定使用顺序，否则会出现争抢摄像头的情况


### 什么功能要系统调用


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/5c6a2eff-5468-4340-8c3e-2646dc3700e6/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB466VCVN7HZH%2F20260127%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260127T042152Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEIT%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDoJ59t8CWhNhJjExS2yXSgCLUXVfX20CXJ6apq%2BzJINAIgN8fbInSvfOSaeLTcUc9veJPkqD9tmPnnZm2IpvURIp8q%2FwMITRAAGgw2Mzc0MjMxODM4MDUiDFqnLe%2BxhVfilDpPjircA0IB38PkT4U%2FPqNptfb4DN71Mau4R4Vm9SuBgfmR1CxblsUd6N3juVFxy4LzXke%2FKRtL%2FrUbH3VqFTdoCCSkZ%2FPcCS4fd9CLh3FOMz5u5bbJG26T9XZ4ndrSrYKgcCuyvMmdJ30NdsXmL7YJ4fXmcNUS65Q8QAzgbge7OcqPBVAwjUJmYGksJ98OAPMjn1DPxyHY51PoyxoIAkXPF4Wb7kpg77QdEIXmZ3%2Fae20bKSkqm0nzQH9Y%2B2MynfDGmPxrFv3yRqvopn%2BvsOJ9YkxJGI7G0Vh1upTvTxm%2BDwH11iu3bMbGvSFHiIOyi0y2JLr2NdthFBIf7AuAJgjIk5DsFlmLmolA0D%2BWRYKCtdKGNCjPfn%2BZXuw8p94SBPPD4jkw6pd0NbaIAhkAomOusTndIDIsMyDXxeSvZctl3L9Yd0OOA%2F1JhNlMvsnb7sCFwXL%2BT8kLv11Xq%2F39jl5hZXTT%2F3vYoQfrO9pTjlMPKlZC8QL%2BmqLiNr0KSKirNZyWxNlm%2F6eK8GE0q47bIUl3MbPCxjjbqHP4R1alf3wbrQABoENQTZ8QxU9LckaCaUgNu9Vhm5fpDiRBFXQsaelXHQLShjlUkVMOpk0BoYizGktg9eCxn%2F%2FyBPtfKDT2UePcML3j4MsGOqUBYBHkyv7ZBjO2JlvmA2iri16EGBlXxlXsmpPBfhZrlisffpgbGZj8Qh8UpEocQ%2FgsG8qdSLPQpZkP3vuFitJpUUPmI%2Bn0LKU4qezQvRVGG1jAZ8fxvWg05hCAeC2uBCuBOmcvzfJKk8a6vY1IaKRABJsoaJwYd41FX4XOSc4IAgfInGbICOa9o9e6%2BR0%2FZ0srCWaCrW2ChwBCRUpWmpDpiuhmOs5t&X-Amz-Signature=62866bd955b1913a6d4cc273893619fcf0157d50865e775512fb21c809462845&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


### 系统调用过程


传参指令……（用户态）→陷入指令（用户态）[引发中断]→中断处理程序（内核态）[选择相应的系统调用处理程序]→相应系统调用处理程序（由传入的参数决定）


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/81119b28-7bd7-4ca6-85ed-8a132fcab89d/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB466VCVN7HZH%2F20260127%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260127T042152Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEIT%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDoJ59t8CWhNhJjExS2yXSgCLUXVfX20CXJ6apq%2BzJINAIgN8fbInSvfOSaeLTcUc9veJPkqD9tmPnnZm2IpvURIp8q%2FwMITRAAGgw2Mzc0MjMxODM4MDUiDFqnLe%2BxhVfilDpPjircA0IB38PkT4U%2FPqNptfb4DN71Mau4R4Vm9SuBgfmR1CxblsUd6N3juVFxy4LzXke%2FKRtL%2FrUbH3VqFTdoCCSkZ%2FPcCS4fd9CLh3FOMz5u5bbJG26T9XZ4ndrSrYKgcCuyvMmdJ30NdsXmL7YJ4fXmcNUS65Q8QAzgbge7OcqPBVAwjUJmYGksJ98OAPMjn1DPxyHY51PoyxoIAkXPF4Wb7kpg77QdEIXmZ3%2Fae20bKSkqm0nzQH9Y%2B2MynfDGmPxrFv3yRqvopn%2BvsOJ9YkxJGI7G0Vh1upTvTxm%2BDwH11iu3bMbGvSFHiIOyi0y2JLr2NdthFBIf7AuAJgjIk5DsFlmLmolA0D%2BWRYKCtdKGNCjPfn%2BZXuw8p94SBPPD4jkw6pd0NbaIAhkAomOusTndIDIsMyDXxeSvZctl3L9Yd0OOA%2F1JhNlMvsnb7sCFwXL%2BT8kLv11Xq%2F39jl5hZXTT%2F3vYoQfrO9pTjlMPKlZC8QL%2BmqLiNr0KSKirNZyWxNlm%2F6eK8GE0q47bIUl3MbPCxjjbqHP4R1alf3wbrQABoENQTZ8QxU9LckaCaUgNu9Vhm5fpDiRBFXQsaelXHQLShjlUkVMOpk0BoYizGktg9eCxn%2F%2FyBPtfKDT2UePcML3j4MsGOqUBYBHkyv7ZBjO2JlvmA2iri16EGBlXxlXsmpPBfhZrlisffpgbGZj8Qh8UpEocQ%2FgsG8qdSLPQpZkP3vuFitJpUUPmI%2Bn0LKU4qezQvRVGG1jAZ8fxvWg05hCAeC2uBCuBOmcvzfJKk8a6vY1IaKRABJsoaJwYd41FX4XOSc4IAgfInGbICOa9o9e6%2BR0%2FZ0srCWaCrW2ChwBCRUpWmpDpiuhmOs5t&X-Amz-Signature=72ab386ef7656c93760698048c4b9de26fcdb8dcf3425e1840142cdd06802a80&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


ps：陷入指令=访管指令=trap指令


### 总结


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/d00274b7-ffbf-42d2-9255-534022d080b6/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB466VCVN7HZH%2F20260127%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260127T042152Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEIT%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDoJ59t8CWhNhJjExS2yXSgCLUXVfX20CXJ6apq%2BzJINAIgN8fbInSvfOSaeLTcUc9veJPkqD9tmPnnZm2IpvURIp8q%2FwMITRAAGgw2Mzc0MjMxODM4MDUiDFqnLe%2BxhVfilDpPjircA0IB38PkT4U%2FPqNptfb4DN71Mau4R4Vm9SuBgfmR1CxblsUd6N3juVFxy4LzXke%2FKRtL%2FrUbH3VqFTdoCCSkZ%2FPcCS4fd9CLh3FOMz5u5bbJG26T9XZ4ndrSrYKgcCuyvMmdJ30NdsXmL7YJ4fXmcNUS65Q8QAzgbge7OcqPBVAwjUJmYGksJ98OAPMjn1DPxyHY51PoyxoIAkXPF4Wb7kpg77QdEIXmZ3%2Fae20bKSkqm0nzQH9Y%2B2MynfDGmPxrFv3yRqvopn%2BvsOJ9YkxJGI7G0Vh1upTvTxm%2BDwH11iu3bMbGvSFHiIOyi0y2JLr2NdthFBIf7AuAJgjIk5DsFlmLmolA0D%2BWRYKCtdKGNCjPfn%2BZXuw8p94SBPPD4jkw6pd0NbaIAhkAomOusTndIDIsMyDXxeSvZctl3L9Yd0OOA%2F1JhNlMvsnb7sCFwXL%2BT8kLv11Xq%2F39jl5hZXTT%2F3vYoQfrO9pTjlMPKlZC8QL%2BmqLiNr0KSKirNZyWxNlm%2F6eK8GE0q47bIUl3MbPCxjjbqHP4R1alf3wbrQABoENQTZ8QxU9LckaCaUgNu9Vhm5fpDiRBFXQsaelXHQLShjlUkVMOpk0BoYizGktg9eCxn%2F%2FyBPtfKDT2UePcML3j4MsGOqUBYBHkyv7ZBjO2JlvmA2iri16EGBlXxlXsmpPBfhZrlisffpgbGZj8Qh8UpEocQ%2FgsG8qdSLPQpZkP3vuFitJpUUPmI%2Bn0LKU4qezQvRVGG1jAZ8fxvWg05hCAeC2uBCuBOmcvzfJKk8a6vY1IaKRABJsoaJwYd41FX4XOSc4IAgfInGbICOa9o9e6%2BR0%2FZ0srCWaCrW2ChwBCRUpWmpDpiuhmOs5t&X-Amz-Signature=37ec2ab1f975a692c6cfe6ba32e28d89db21b3611316680e34c102a97d4b3549&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)

