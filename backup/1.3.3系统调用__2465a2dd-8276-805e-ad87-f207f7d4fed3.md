
系统调用是提供内核服务的接口


（要想执行特权指令需要使用系统调用，而非使用越权的指令）


### 系统调用与库函数的区别


一个程序可以用汇编直接使用系统调用


也可以使用库函数间接使用系统调用（库函数直接使用系统调用）


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/a0f71c13-988a-4aca-bbc8-7fe8a14f2dfa/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB466QGT2TPMN%2F20260131%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260131T044720Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEOT%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIHEnPALygoe%2FMkZg5djTa4UB96QDOxX%2B%2B9U0HcsgMa9vAiAnr5cThlBQNOy%2FdjKk8GdaOUCVhKUiPGz733rk64QcCCqIBAit%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAAaDDYzNzQyMzE4MzgwNSIMIsnyRqmetZ%2F%2FU9lzKtwDH2fdpi9GpumnEiRy6kLFuByG1iw3YAVr4XZL%2BGg%2FOettxUat0oBPrurSGqtwf%2Bxdf7DcAJB%2BtKcA0AgGwNzIEz5D6rjGhpPO8PKXNJNJ3ZbdtbM7OYKvl%2BoHfCNAV82OeTcLnm4hLyBBTiFehRxj7ItboXSHgl6H%2Bh2GfjDZI6Rm5mHtUv9n%2BidJ2i0GrQI%2F1CYlqLSl5TTT0lPjHxAajNtzFOA6hLxqk5hG%2FN9WPhu1Mi7XCVLEfnEF3hIOgynQ4R8Z51ne69R9fyx1sgK%2FWTcl6iJahV1OS6LY5rESlhJ2FnhrVZu31Gapo1HW6BPCUl3PdF4B4HS4tSD0XWov5QTkn5nX%2F1vMCon5U1qEPmK6SBi%2FcPauNlairOSjIxNAjRtQ7HXFDlBsNbZBXqkMJIpFLMdoBwc28%2FhCdh8UKQ7qVuTevGHjxfxjr3JvzLoa1UX3a0nG%2BeER7zroK1Y4Aw0nw74DJqDP%2BvFnkj0USvDERPAExR1zJA13pM9TOD7qR3qHwd1H9ydTyIGj6Usy0%2Bd9ZmK3%2BsUSh%2B5J%2BDXcXmtmprIQFjkJtyZEk2d4P%2F1sVGziAVp3noA8r%2BnJNETc%2F1b4ds0pZ0PooevoHpGZCmFP0vx2geYEfpPvEMkwiIT2ywY6pgE4CqzCAxTaIOg2MlOjFTERAI5AlqzIQBUBIBriZ5DdfKbkmr2DBqhh7Pee4IaHimISw8NPqyLUQrIkZnE2ZcAQV1uK8rAu7%2FCJvLH4djbrvP8QJg0PNfpQbpZ87Aw29VHtYQAu7VlOLsxJTBKxxngItyoGS%2F1VXuRVOQEGFhELdWB2pbamf9YdgpTuO1%2B7PzM8ERLioUCzbhDHtrnWKLep%2F4ir7r%2BQ&X-Amz-Signature=daf482fbaa3e7a550ca82dd92c12f1efdfdc58f4b0cf080d0003e01262229d93&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


### 为什么要系统调用


例：当多个进程同时使用一种设备资源（如摄像头）需要内核决定使用顺序，否则会出现争抢摄像头的情况


### 什么功能要系统调用


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/5c6a2eff-5468-4340-8c3e-2646dc3700e6/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB466QGT2TPMN%2F20260131%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260131T044720Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEOT%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIHEnPALygoe%2FMkZg5djTa4UB96QDOxX%2B%2B9U0HcsgMa9vAiAnr5cThlBQNOy%2FdjKk8GdaOUCVhKUiPGz733rk64QcCCqIBAit%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAAaDDYzNzQyMzE4MzgwNSIMIsnyRqmetZ%2F%2FU9lzKtwDH2fdpi9GpumnEiRy6kLFuByG1iw3YAVr4XZL%2BGg%2FOettxUat0oBPrurSGqtwf%2Bxdf7DcAJB%2BtKcA0AgGwNzIEz5D6rjGhpPO8PKXNJNJ3ZbdtbM7OYKvl%2BoHfCNAV82OeTcLnm4hLyBBTiFehRxj7ItboXSHgl6H%2Bh2GfjDZI6Rm5mHtUv9n%2BidJ2i0GrQI%2F1CYlqLSl5TTT0lPjHxAajNtzFOA6hLxqk5hG%2FN9WPhu1Mi7XCVLEfnEF3hIOgynQ4R8Z51ne69R9fyx1sgK%2FWTcl6iJahV1OS6LY5rESlhJ2FnhrVZu31Gapo1HW6BPCUl3PdF4B4HS4tSD0XWov5QTkn5nX%2F1vMCon5U1qEPmK6SBi%2FcPauNlairOSjIxNAjRtQ7HXFDlBsNbZBXqkMJIpFLMdoBwc28%2FhCdh8UKQ7qVuTevGHjxfxjr3JvzLoa1UX3a0nG%2BeER7zroK1Y4Aw0nw74DJqDP%2BvFnkj0USvDERPAExR1zJA13pM9TOD7qR3qHwd1H9ydTyIGj6Usy0%2Bd9ZmK3%2BsUSh%2B5J%2BDXcXmtmprIQFjkJtyZEk2d4P%2F1sVGziAVp3noA8r%2BnJNETc%2F1b4ds0pZ0PooevoHpGZCmFP0vx2geYEfpPvEMkwiIT2ywY6pgE4CqzCAxTaIOg2MlOjFTERAI5AlqzIQBUBIBriZ5DdfKbkmr2DBqhh7Pee4IaHimISw8NPqyLUQrIkZnE2ZcAQV1uK8rAu7%2FCJvLH4djbrvP8QJg0PNfpQbpZ87Aw29VHtYQAu7VlOLsxJTBKxxngItyoGS%2F1VXuRVOQEGFhELdWB2pbamf9YdgpTuO1%2B7PzM8ERLioUCzbhDHtrnWKLep%2F4ir7r%2BQ&X-Amz-Signature=ace963ed8a46ca25660ae809677f7e1b9d74b07f183eeb6935739bae1be505cf&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


### 系统调用过程


传参指令……（用户态）→陷入指令（用户态）[引发中断]→中断处理程序（内核态）[选择相应的系统调用处理程序]→相应系统调用处理程序（由传入的参数决定）


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/81119b28-7bd7-4ca6-85ed-8a132fcab89d/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB466QGT2TPMN%2F20260131%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260131T044720Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEOT%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIHEnPALygoe%2FMkZg5djTa4UB96QDOxX%2B%2B9U0HcsgMa9vAiAnr5cThlBQNOy%2FdjKk8GdaOUCVhKUiPGz733rk64QcCCqIBAit%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAAaDDYzNzQyMzE4MzgwNSIMIsnyRqmetZ%2F%2FU9lzKtwDH2fdpi9GpumnEiRy6kLFuByG1iw3YAVr4XZL%2BGg%2FOettxUat0oBPrurSGqtwf%2Bxdf7DcAJB%2BtKcA0AgGwNzIEz5D6rjGhpPO8PKXNJNJ3ZbdtbM7OYKvl%2BoHfCNAV82OeTcLnm4hLyBBTiFehRxj7ItboXSHgl6H%2Bh2GfjDZI6Rm5mHtUv9n%2BidJ2i0GrQI%2F1CYlqLSl5TTT0lPjHxAajNtzFOA6hLxqk5hG%2FN9WPhu1Mi7XCVLEfnEF3hIOgynQ4R8Z51ne69R9fyx1sgK%2FWTcl6iJahV1OS6LY5rESlhJ2FnhrVZu31Gapo1HW6BPCUl3PdF4B4HS4tSD0XWov5QTkn5nX%2F1vMCon5U1qEPmK6SBi%2FcPauNlairOSjIxNAjRtQ7HXFDlBsNbZBXqkMJIpFLMdoBwc28%2FhCdh8UKQ7qVuTevGHjxfxjr3JvzLoa1UX3a0nG%2BeER7zroK1Y4Aw0nw74DJqDP%2BvFnkj0USvDERPAExR1zJA13pM9TOD7qR3qHwd1H9ydTyIGj6Usy0%2Bd9ZmK3%2BsUSh%2B5J%2BDXcXmtmprIQFjkJtyZEk2d4P%2F1sVGziAVp3noA8r%2BnJNETc%2F1b4ds0pZ0PooevoHpGZCmFP0vx2geYEfpPvEMkwiIT2ywY6pgE4CqzCAxTaIOg2MlOjFTERAI5AlqzIQBUBIBriZ5DdfKbkmr2DBqhh7Pee4IaHimISw8NPqyLUQrIkZnE2ZcAQV1uK8rAu7%2FCJvLH4djbrvP8QJg0PNfpQbpZ87Aw29VHtYQAu7VlOLsxJTBKxxngItyoGS%2F1VXuRVOQEGFhELdWB2pbamf9YdgpTuO1%2B7PzM8ERLioUCzbhDHtrnWKLep%2F4ir7r%2BQ&X-Amz-Signature=c541280ec394053059e81386d3357daadb72170934637ca93036c12ba5e03100&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


ps：陷入指令=访管指令=trap指令


### 总结


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/d00274b7-ffbf-42d2-9255-534022d080b6/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB466QGT2TPMN%2F20260131%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260131T044720Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEOT%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIHEnPALygoe%2FMkZg5djTa4UB96QDOxX%2B%2B9U0HcsgMa9vAiAnr5cThlBQNOy%2FdjKk8GdaOUCVhKUiPGz733rk64QcCCqIBAit%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAAaDDYzNzQyMzE4MzgwNSIMIsnyRqmetZ%2F%2FU9lzKtwDH2fdpi9GpumnEiRy6kLFuByG1iw3YAVr4XZL%2BGg%2FOettxUat0oBPrurSGqtwf%2Bxdf7DcAJB%2BtKcA0AgGwNzIEz5D6rjGhpPO8PKXNJNJ3ZbdtbM7OYKvl%2BoHfCNAV82OeTcLnm4hLyBBTiFehRxj7ItboXSHgl6H%2Bh2GfjDZI6Rm5mHtUv9n%2BidJ2i0GrQI%2F1CYlqLSl5TTT0lPjHxAajNtzFOA6hLxqk5hG%2FN9WPhu1Mi7XCVLEfnEF3hIOgynQ4R8Z51ne69R9fyx1sgK%2FWTcl6iJahV1OS6LY5rESlhJ2FnhrVZu31Gapo1HW6BPCUl3PdF4B4HS4tSD0XWov5QTkn5nX%2F1vMCon5U1qEPmK6SBi%2FcPauNlairOSjIxNAjRtQ7HXFDlBsNbZBXqkMJIpFLMdoBwc28%2FhCdh8UKQ7qVuTevGHjxfxjr3JvzLoa1UX3a0nG%2BeER7zroK1Y4Aw0nw74DJqDP%2BvFnkj0USvDERPAExR1zJA13pM9TOD7qR3qHwd1H9ydTyIGj6Usy0%2Bd9ZmK3%2BsUSh%2B5J%2BDXcXmtmprIQFjkJtyZEk2d4P%2F1sVGziAVp3noA8r%2BnJNETc%2F1b4ds0pZ0PooevoHpGZCmFP0vx2geYEfpPvEMkwiIT2ywY6pgE4CqzCAxTaIOg2MlOjFTERAI5AlqzIQBUBIBriZ5DdfKbkmr2DBqhh7Pee4IaHimISw8NPqyLUQrIkZnE2ZcAQV1uK8rAu7%2FCJvLH4djbrvP8QJg0PNfpQbpZ87Aw29VHtYQAu7VlOLsxJTBKxxngItyoGS%2F1VXuRVOQEGFhELdWB2pbamf9YdgpTuO1%2B7PzM8ERLioUCzbhDHtrnWKLep%2F4ir7r%2BQ&X-Amz-Signature=aa51c97bd81316def4ce19714d971275bd28b4171faec4ccd0385c4db6a37997&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)

