
系统调用是提供内核服务的接口


（要想执行特权指令需要使用系统调用，而非使用越权的指令）


### 系统调用与库函数的区别


一个程序可以用汇编直接使用系统调用


也可以使用库函数间接使用系统调用（库函数直接使用系统调用）


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/a0f71c13-988a-4aca-bbc8-7fe8a14f2dfa/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB466YBWLSV5K%2F20260112%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260112T042311Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEBwaCXVzLXdlc3QtMiJHMEUCICwIhqtWZmRbtHf1jUd4v%2B9QFPZqTdnagwstGa00THuhAiEAs8YtAFKTOsdCNbWT%2F1ZNQkO1AAd%2BiQBj1UA9t48DgLcqiAQI5f%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAAGgw2Mzc0MjMxODM4MDUiDNRvfbl2Apn8DMJyuyrcAzvcswkkoVQKMuymzlKxTG%2BfR8kyzHx4KzaaK%2FsJXbWPuFSJ%2BlQBt546z0Ca9%2Bm6W%2BeNZ9BmY9CMv9uuqT03ejbZAreSiaChLmapd4C1LQjW6iLjxzl64cLklyx2akjhoY0PiT6xm%2BQVQKtXgAO1bkgzn1YreuqAl8CmIMPFGmegaQhRfoffxq%2FxWIBswh9pAgHKkhczH01HQXUjG2TAOuicejaghoVp6Ps9bAK%2BhkFRA7R1votK8SU44Kb51DfnH1164pyAxTg9AOh8rpY82k7OfuoQZLTV1oXY%2F2j8sEhTjP1MoSuLl0tVuD9ute74Xa5MDCXDjyKAPZNspEIcjrWngcgWXHmdysV1h7twhx1siFqZSj%2BjSGD23lDKWwlS%2FNlNIXqRk45syzjfJZlw7HxjzgbCgtFtMVR96ubPBY%2FJDz4%2Bx2OZzc%2FCdWoD24Vzsyz3jdBBwBbS6fezCxGl3bW9o%2BCEc7LVSb9sATr%2B9vFVuf7CVOi%2B1HfrCvcpj%2BfwA57n0T6SLODni6hc5lwvslGCP0Z8WqrYzIbiwzgejZMhr7RU4Viaw4AdwVEqdYfEgdORQkn%2FtZsEXtAQIIPu0vdmAlaq8us3kJvNajpFgdJZvW0dATq8k70u%2BvW0MNbpkcsGOqUBaU6PEA1DblWHLnzUhObJyiqhvhnXi2OoPirXYNgfFHApdf293XFaFXQXiwvAx%2BDeHUtiuVqfJYegyu7Nwy7cUGZ5cPbJ8gyqKEMZko98hpHjYq7R6FOwcA8q9L3Jqv%2BbAlqVKUVkyvqOvSM4KtVqtVHYf15ZgIpgFShFEqB0Hjlp%2B6DLrCnupxDJi3EPqdKtlVCfTo1Ao6uDjtfVOUuAC7ugBONm&X-Amz-Signature=18b346fc14495acd8f2ab1e46126926c1b7a25b37d12d3ea4239900171ba5b55&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


### 为什么要系统调用


例：当多个进程同时使用一种设备资源（如摄像头）需要内核决定使用顺序，否则会出现争抢摄像头的情况


### 什么功能要系统调用


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/5c6a2eff-5468-4340-8c3e-2646dc3700e6/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB466YBWLSV5K%2F20260112%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260112T042311Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEBwaCXVzLXdlc3QtMiJHMEUCICwIhqtWZmRbtHf1jUd4v%2B9QFPZqTdnagwstGa00THuhAiEAs8YtAFKTOsdCNbWT%2F1ZNQkO1AAd%2BiQBj1UA9t48DgLcqiAQI5f%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAAGgw2Mzc0MjMxODM4MDUiDNRvfbl2Apn8DMJyuyrcAzvcswkkoVQKMuymzlKxTG%2BfR8kyzHx4KzaaK%2FsJXbWPuFSJ%2BlQBt546z0Ca9%2Bm6W%2BeNZ9BmY9CMv9uuqT03ejbZAreSiaChLmapd4C1LQjW6iLjxzl64cLklyx2akjhoY0PiT6xm%2BQVQKtXgAO1bkgzn1YreuqAl8CmIMPFGmegaQhRfoffxq%2FxWIBswh9pAgHKkhczH01HQXUjG2TAOuicejaghoVp6Ps9bAK%2BhkFRA7R1votK8SU44Kb51DfnH1164pyAxTg9AOh8rpY82k7OfuoQZLTV1oXY%2F2j8sEhTjP1MoSuLl0tVuD9ute74Xa5MDCXDjyKAPZNspEIcjrWngcgWXHmdysV1h7twhx1siFqZSj%2BjSGD23lDKWwlS%2FNlNIXqRk45syzjfJZlw7HxjzgbCgtFtMVR96ubPBY%2FJDz4%2Bx2OZzc%2FCdWoD24Vzsyz3jdBBwBbS6fezCxGl3bW9o%2BCEc7LVSb9sATr%2B9vFVuf7CVOi%2B1HfrCvcpj%2BfwA57n0T6SLODni6hc5lwvslGCP0Z8WqrYzIbiwzgejZMhr7RU4Viaw4AdwVEqdYfEgdORQkn%2FtZsEXtAQIIPu0vdmAlaq8us3kJvNajpFgdJZvW0dATq8k70u%2BvW0MNbpkcsGOqUBaU6PEA1DblWHLnzUhObJyiqhvhnXi2OoPirXYNgfFHApdf293XFaFXQXiwvAx%2BDeHUtiuVqfJYegyu7Nwy7cUGZ5cPbJ8gyqKEMZko98hpHjYq7R6FOwcA8q9L3Jqv%2BbAlqVKUVkyvqOvSM4KtVqtVHYf15ZgIpgFShFEqB0Hjlp%2B6DLrCnupxDJi3EPqdKtlVCfTo1Ao6uDjtfVOUuAC7ugBONm&X-Amz-Signature=ca2c9af8b31650af6c9b3d8c14ae39598dca480bd850df2f008820e0d9f13d72&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


### 系统调用过程


传参指令……（用户态）→陷入指令（用户态）[引发中断]→中断处理程序（内核态）[选择相应的系统调用处理程序]→相应系统调用处理程序（由传入的参数决定）


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/81119b28-7bd7-4ca6-85ed-8a132fcab89d/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB466YBWLSV5K%2F20260112%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260112T042311Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEBwaCXVzLXdlc3QtMiJHMEUCICwIhqtWZmRbtHf1jUd4v%2B9QFPZqTdnagwstGa00THuhAiEAs8YtAFKTOsdCNbWT%2F1ZNQkO1AAd%2BiQBj1UA9t48DgLcqiAQI5f%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAAGgw2Mzc0MjMxODM4MDUiDNRvfbl2Apn8DMJyuyrcAzvcswkkoVQKMuymzlKxTG%2BfR8kyzHx4KzaaK%2FsJXbWPuFSJ%2BlQBt546z0Ca9%2Bm6W%2BeNZ9BmY9CMv9uuqT03ejbZAreSiaChLmapd4C1LQjW6iLjxzl64cLklyx2akjhoY0PiT6xm%2BQVQKtXgAO1bkgzn1YreuqAl8CmIMPFGmegaQhRfoffxq%2FxWIBswh9pAgHKkhczH01HQXUjG2TAOuicejaghoVp6Ps9bAK%2BhkFRA7R1votK8SU44Kb51DfnH1164pyAxTg9AOh8rpY82k7OfuoQZLTV1oXY%2F2j8sEhTjP1MoSuLl0tVuD9ute74Xa5MDCXDjyKAPZNspEIcjrWngcgWXHmdysV1h7twhx1siFqZSj%2BjSGD23lDKWwlS%2FNlNIXqRk45syzjfJZlw7HxjzgbCgtFtMVR96ubPBY%2FJDz4%2Bx2OZzc%2FCdWoD24Vzsyz3jdBBwBbS6fezCxGl3bW9o%2BCEc7LVSb9sATr%2B9vFVuf7CVOi%2B1HfrCvcpj%2BfwA57n0T6SLODni6hc5lwvslGCP0Z8WqrYzIbiwzgejZMhr7RU4Viaw4AdwVEqdYfEgdORQkn%2FtZsEXtAQIIPu0vdmAlaq8us3kJvNajpFgdJZvW0dATq8k70u%2BvW0MNbpkcsGOqUBaU6PEA1DblWHLnzUhObJyiqhvhnXi2OoPirXYNgfFHApdf293XFaFXQXiwvAx%2BDeHUtiuVqfJYegyu7Nwy7cUGZ5cPbJ8gyqKEMZko98hpHjYq7R6FOwcA8q9L3Jqv%2BbAlqVKUVkyvqOvSM4KtVqtVHYf15ZgIpgFShFEqB0Hjlp%2B6DLrCnupxDJi3EPqdKtlVCfTo1Ao6uDjtfVOUuAC7ugBONm&X-Amz-Signature=349fec95986304c07e87d02303c557cee430e7a4ff4123ac8e09c85663011d1f&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)


ps：陷入指令=访管指令=trap指令


### 总结


![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/51145155-d0f0-4bb1-85cf-344e4c2400e0/d00274b7-ffbf-42d2-9255-534022d080b6/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB466YBWLSV5K%2F20260112%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20260112T042311Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEBwaCXVzLXdlc3QtMiJHMEUCICwIhqtWZmRbtHf1jUd4v%2B9QFPZqTdnagwstGa00THuhAiEAs8YtAFKTOsdCNbWT%2F1ZNQkO1AAd%2BiQBj1UA9t48DgLcqiAQI5f%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAAGgw2Mzc0MjMxODM4MDUiDNRvfbl2Apn8DMJyuyrcAzvcswkkoVQKMuymzlKxTG%2BfR8kyzHx4KzaaK%2FsJXbWPuFSJ%2BlQBt546z0Ca9%2Bm6W%2BeNZ9BmY9CMv9uuqT03ejbZAreSiaChLmapd4C1LQjW6iLjxzl64cLklyx2akjhoY0PiT6xm%2BQVQKtXgAO1bkgzn1YreuqAl8CmIMPFGmegaQhRfoffxq%2FxWIBswh9pAgHKkhczH01HQXUjG2TAOuicejaghoVp6Ps9bAK%2BhkFRA7R1votK8SU44Kb51DfnH1164pyAxTg9AOh8rpY82k7OfuoQZLTV1oXY%2F2j8sEhTjP1MoSuLl0tVuD9ute74Xa5MDCXDjyKAPZNspEIcjrWngcgWXHmdysV1h7twhx1siFqZSj%2BjSGD23lDKWwlS%2FNlNIXqRk45syzjfJZlw7HxjzgbCgtFtMVR96ubPBY%2FJDz4%2Bx2OZzc%2FCdWoD24Vzsyz3jdBBwBbS6fezCxGl3bW9o%2BCEc7LVSb9sATr%2B9vFVuf7CVOi%2B1HfrCvcpj%2BfwA57n0T6SLODni6hc5lwvslGCP0Z8WqrYzIbiwzgejZMhr7RU4Viaw4AdwVEqdYfEgdORQkn%2FtZsEXtAQIIPu0vdmAlaq8us3kJvNajpFgdJZvW0dATq8k70u%2BvW0MNbpkcsGOqUBaU6PEA1DblWHLnzUhObJyiqhvhnXi2OoPirXYNgfFHApdf293XFaFXQXiwvAx%2BDeHUtiuVqfJYegyu7Nwy7cUGZ5cPbJ8gyqKEMZko98hpHjYq7R6FOwcA8q9L3Jqv%2BbAlqVKUVkyvqOvSM4KtVqtVHYf15ZgIpgFShFEqB0Hjlp%2B6DLrCnupxDJi3EPqdKtlVCfTo1Ao6uDjtfVOUuAC7ugBONm&X-Amz-Signature=8d82250f8080a8afd3c9b9a935e5d1a13f94cca911e485059eb68a269ab07d1f&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject)

